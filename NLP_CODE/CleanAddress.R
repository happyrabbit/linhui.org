##------------clean location
## Manitoba
id<-grep("Manitoba",location)
location[id]<-"Manitoba"
## Ontario
id<-grep("ontario",location)
location[id]<-"ontario"
id<-grep("Ontario",location)
location[id]<-"ontario"
id<-grep("ONT",location)
location[id]<-"ontario"
id<-grep(" Ont",location)
location[id]<-"ontario"

## Quebec
id<-grep("Quebec",location)
location[id]<-"Quebec"
## Canada
id<-grep("Canada",location)
location[id]<-"Canada"

## Australia
id<-grep("Australia",location)
location[id]<-"Australia"
## London
id<-grep("London",location)
location[id]<-"London"

## Alabama
id<-grep("Alabama",location)
location[id]<-"AL"
id<-grep("alabama",location)
location[id]<-"AL"
id<-grep(" AL",location)
location[id]<-"AL"
## Alaska
## Arizona
id<-grep("Arizona",location)
location[id]<-"AZ"
id<-grep("AZ",location)
location[id]<-"AZ"
## Arkansas 
id<-grep("Arkansas",location)
location[id]<-"AR"
id<-grep("arkansas",location)
location[id]<-"AR"
id<-grep(" AR",location)
location[id]<-"AR"
id<-grep(" ar",location)
location[id]<-"AR"
## California
id<-grep("CA",location)
location[id]<-"CA"
id<-grep("California",location)
location[id]<-"CA"
## Michigan
id<-grep("MICHIGAN",location)
location[id]<-"MI"
id<-grep("Michigan",location)
location[id]<-"MI"
id<-grep("Gladwin Mi",location)
location[id]<-"MI"
## Colorado
id<-grep("Colorado",location)
location[id]<-"CO"
id<-grep("colorado",location)
location[id]<-"CO"
id<-grep(" CO",location)
location[id]<-"CO"
## Connecticut
## Ohio
id<-grep("Ohio",location)
location[id]<-"OH"
id<-grep(" ohio",location)
location[id]<-"OH"
id<-grep(" OH",location)
location[id]<-"OH"
id<-grep(" Oh",location)
location[id]<-"OH"
## Delaware
id<-grep("Delaware",location)
location[id]<-"DE"
## Delaware
id<-grep("Delaware",location)
location[id]<-"DE"
## Florida
id<-grep("Florida",location)
location[id]<-"FL"
id<-grep("FL",location)
location[id]<-"FL"
## North Carolina
id<-grep("garden nc",location)
location[id]<-"NC"
## Georgia
id<-grep("Georgia",location)
location[id]<-"GA"
id<-grep(" ga",location)
location[id]<-"GA"
id<-grep(" GA",location)
location[id]<-"GA"

## Hawaii
## Idaho
id<-grep("Idaho",location)
location[id]<-"ID"
id<-grep("idaho",location)
location[id]<-"ID"
id<-grep(" ID",location)
location[id]<-"ID"
## Illinois
id<-grep(" IL",location)
location[id]<-"IL"
id<-grep("Illinois",location)
location[id]<-"IL"
id<-grep("Il",location)
location[id]<-"IL"
id<-grep("ILL",location)
location[id]<-"IL"
id<-grep(" ill",location)
location[id]<-"IL"
id<-grep("ECIL",location)
location[id]<-"IL"
id<-grep("ne il",location)
location[id]<-"IL"
id<-grep("sullivan il.",location)
location[id]<-"IL"
## Indiana
id<-grep("Indiana",location)
location[id]<-"IN"
id<-grep("indiana",location)
location[id]<-"IN"
id<-grep(" IN",location)
location[id]<-"IN"
id<-grep("southwest  in",location)
location[id]<-"IN"
id<-grep("wc in",location)
location[id]<-"IN"
id<-grep("wc in",location)
location[id]<-"IN"
id<-grep("NCIN",location)
location[id]<-"IN"
id<-grep(" In",location)
location[id]<-"IN"
id<-grep("WCIN",location)
location[id]<-"IN"


## Iowa
id<-grep("iowa",location)
location[id]<-"IA"
id<-grep("Iowa",location)
location[id]<-"IA"
id<-grep(" IA",location)
location[id]<-"IA"
id<-grep("IA,",location)
location[id]<-"IA"
id<-grep("Cyclone",location)
location[id]<-"IA"
id<-grep("Ia",location)
location[id]<-"IA"
id<-grep(" ia",location)
location[id]<-"IA"
id<-grep("Des Moines",location)
location[id]<-"IA"
id<-grep("ncia",location)
location[id]<-"IA"
id<-grep("IOWA",location)
location[id]<-"IA"
id<-grep("SCIA",location)
location[id]<-"IA"

 
## Kansas
id<-grep("Kansas",location)
location[id]<-"KS"
id<-grep(" kansas",location)
location[id]<-"KS"
id<-grep(" KS",location)
location[id]<-"KS"
id<-grep(" ks",location)
location[id]<-"KS"
id<-grep(" Ks",location)
location[id]<-"KS"

## Kentucky
id<-grep("Kentucky",location)
location[id]<-"KY"
id<-grep("kentucky",location)
location[id]<-"KY"
id<-grep(" KY",location)
location[id]<-"KY"
id<-grep(" Ky",location)
location[id]<-"KY"
id<-grep(" ky",location)
location[id]<-"KY"
## Louisiana
id<-grep("Louisiana",location)
location[id]<-"LA"
id<-grep("louisiana",location)
location[id]<-"LA"
id<-grep(" LA",location)
location[id]<-"LA"
## Maine
id<-grep("Maine",location)
location[id]<-"ME"
id<-grep("maine",location)
location[id]<-"ME"
## Maryland
id<-grep("Maryland",location)
location[id]<-"MD"
id<-grep("maryland",location)
location[id]<-"MD"
id<-grep(" MD",location)
location[id]<-"MD"
## Massachusetts
id<-grep("Massachusetts",location)
location[id]<-"MA"
id<-grep(" MA",location)
location[id]<-"MA"
## Minnesota
id<-grep("Minnesota",location)
location[id]<-"MN"
id<-grep("MINNESOTA",location)
location[id]<-"MN"
id<-grep("minnesota",location)
location[id]<-"MN"
id<-grep(" MN",location)
location[id]<-"MN"
id<-grep(" mn",location)
location[id]<-"MN"
id<-grep("ecmn",location)
location[id]<-"MN"
id<-grep("SWMN",location)
location[id]<-"MN"
id<-grep("Minn",location)
location[id]<-"MN"
id<-grep(" Mn",location)
location[id]<-"MN"
id<-grep("swMN",location)
location[id]<-"MN"

## Michigan
id<-grep(" MI",location)
location[id]<-"MI"
## Mississippi
id<-grep("Mississippi",location)
location[id]<-"MS"
id<-grep("MISSISSIPPI",location)
location[id]<-"MS"
id<-grep(" MS",location)
location[id]<-"MS"
## Missouri
id<-grep("Mo ",location)
location[id]<-"MO"
id<-grep(" Mo",location)
location[id]<-"MO"
id<-grep("Missouri",location)
location[id]<-"MO"
id<-grep(" MO",location)
location[id]<-"MO"
id<-grep("SEMO",location)
location[id]<-"MO"
id<-grep("NEMO",location)
location[id]<-"MO"
id<-grep("powell mo",location)
location[id]<-"MO"

## Montana
id<-grep("Montana",location)
location[id]<-"MT"
id<-grep("montana",location)
location[id]<-"MT"
id<-grep(" MT",location)
location[id]<-"MT"
## Nebraska
id<-grep("Nebraska",location)
location[id]<-"NE"
id<-grep("nebraska",location)
location[id]<-"NE"
id<-grep(" NE",location)
location[id]<-"NE"
id<-grep(" Ne.",location)
location[id]<-"NE"
dawson ne
## Nevada
id<-grep("Nevada",location)
location[id]<-"NV"
id<-grep(" NV",location)
location[id]<-"NV"
## New Hampshire
id<-grep("New Hampshire",location)
location[id]<-"NH"
id<-grep(" NH",location)
location[id]<-"NH"
## New Jersey
id<-grep("New Jersey",location)
location[id]<-"NJ"
id<-grep(" Jersey",location)
location[id]<-"NJ"
id<-grep(" NJ",location)
location[id]<-"NJ"
## New Mexico
id<-grep("New Mexico",location)
location[id]<-"NM"
id<-grep(" NM",location)
location[id]<-"NM"
## New York
id<-grep("New York",location)
location[id]<-"NY"
id<-grep("new york",location)
location[id]<-"NY"
id<-grep(" NY",location)
location[id]<-"NY"
## North Carolina
id<-grep("North Carolina",location)
location[id]<-"NC"
id<-grep("north carolina",location)
location[id]<-"NC"
id<-grep(" NC",location)
location[id]<-"NC"
## South Carolina
id<-grep("South Carolina",location)
location[id]<-"SC"
id<-grep("south carolina",location)
location[id]<-"SC"
id<-grep(" SC",location)
location[id]<-"SC"
## North Dakota
id<-grep("North Dakota",location)
location[id]<-"ND"
id<-grep("north dakota",location)
location[id]<-"ND"
id<-grep(" ND",location)
location[id]<-"ND"
id<-grep("NCND",location)
location[id]<-"ND"
id<-grep("NWND",location)
location[id]<-"ND"
## South Dakota
id<-grep("South Dakota",location)
location[id]<-"SD"
id<-grep("south dakota",location)
location[id]<-"SD"
id<-grep(" SD",location)
location[id]<-"SD"
id<-grep("NCSD",location)
location[id]<-"SD"
id<-grep("NESD",location)
location[id]<-"SD"
 
## Oklahoma
id<-grep("Oklahoma",location)
location[id]<-"OK"
id<-grep("oklahoma",location)
location[id]<-"OK"
id<-grep(" OK",location)
location[id]<-"OK"
id<-grep(" Ok",location)
location[id]<-"OK"
id<-grep(" ok",location)
location[id]<-"OK"
## Oregon
id<-grep("Oregon",location)
location[id]<-"OR"
id<-grep("oregon",location)
location[id]<-"OR"
id<-grep(" OR",location)
location[id]<-"OR"
id<-grep(" or",location)
location[id]<-"OR"
## Wisconsin
id<-grep("Wisconsin",location)
location[id]<-"WI"
id<-grep("wisconsin",location)
location[id]<-"WI"
id<-grep(" Wi",location)
location[id]<-"WI"
id<-grep(" WI",location)
location[id]<-"WI"
## Texas
id<-grep("Texas",location)
location[id]<-"TX"
id<-grep("TX",location)
location[id]<-"TX"
id<-grep("texas",location)
location[id]<-"TX"
id<-grep("Tx",location)
location[id]<-"TX"
id<-grep(" tx",location)
location[id]<-"TX"
## Pennsylvania
id<-grep("Pennsylvania",location)
location[id]<-"PA"
id<-grep("pennsylvania",location)
location[id]<-"PA"
id<-grep(" PA",location)
location[id]<-"PA"
id<-grep(" pa",location)
location[id]<-"PA"
id<-grep(" Pa",location)
location[id]<-"PA"
id<-grep("nwpa",location)
location[id]<-"PA"
id<-grep("blairsville,pa",location)
location[id]<-"PA"

## Rhode Island
## Tennessee
id<-grep("Tennessee",location)
location[id]<-"TN"
id<-grep("tennessee",location)
location[id]<-"TN"
id<-grep(" TN",location)
location[id]<-"TN"
## Utah
id<-grep("Utah",location)
location[id]<-"UT"
## Vermont
id<-grep("Vermont",location)
location[id]<-"VT"
id<-grep(" VT",location)
location[id]<-"VT"
## Virginia
id<-grep("Virginia",location)
location[id]<-"VA"
id<-grep(" VA",location)
location[id]<-"VA"
## Washington
id<-grep("Washington",location)
location[id]<-"WA"
id<-grep("washington",location)
location[id]<-"WA"
id<-grep(" WA",location)
location[id]<-"WA"
id<-grep(" Wa",location)
location[id]<-"WA"
## West Virginia
id<-grep("WV",location)
location[id]<-"WV"
## Wyoming
id<-grep("Wyoming",location)
location[id]<-"WY"
id<-grep("WY",location)
location[id]<-"WY"
tp$location<-location
idx<-which(year%in%c("2014","2015"))
##---------------------2014 & 2015 
tp1<-tp[idx,]
sort(table(tp$location),decreasing = T)[1:100]

 