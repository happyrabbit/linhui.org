<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>SQL for Data Science</title>
  <meta name="description" content="This is my notes on Unix">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="SQL for Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is my notes on Unix" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="SQL for Data Science" />
  
  <meta name="twitter:description" content="This is my notes on Unix" />
  

<meta name="author" content="Hui Lin">


<meta name="date" content="2018-01-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="subqueries.html">
<link rel="next" href="modifying-and-analyzing-data-with-sql.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Statement</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-sql.html"><a href="what-is-sql.html"><i class="fa fa-check"></i><b>1.1</b> What is SQL?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-models-and-diagrams.html"><a href="data-models-and-diagrams.html"><i class="fa fa-check"></i><b>2</b> Data Models and Diagrams</a><ul>
<li class="chapter" data-level="2.1" data-path="think-before-code.html"><a href="think-before-code.html"><i class="fa fa-check"></i><b>2.1</b> Think Before Code</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-data-model.html"><a href="what-is-data-model.html"><i class="fa fa-check"></i><b>2.2</b> What is Data Model?</a></li>
<li class="chapter" data-level="2.3" data-path="retrive-data-with-select.html"><a href="retrive-data-with-select.html"><i class="fa fa-check"></i><b>2.3</b> Retrive Data with <code>SELECT</code></a></li>
<li class="chapter" data-level="2.4" data-path="create-table.html"><a href="create-table.html"><i class="fa fa-check"></i><b>2.4</b> Create Table</a></li>
<li class="chapter" data-level="2.5" data-path="sql-comments.html"><a href="sql-comments.html"><i class="fa fa-check"></i><b>2.5</b> SQL Comments</a></li>
<li class="chapter" data-level="2.6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="filtering-sorting-and-calculating-data-with-sql.html"><a href="filtering-sorting-and-calculating-data-with-sql.html"><i class="fa fa-check"></i><b>3</b> Filtering, Sorting, and Calculating Data with SQL</a><ul>
<li class="chapter" data-level="3.1" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>3.1</b> Filter</a><ul>
<li class="chapter" data-level="3.1.1" data-path="filter.html"><a href="filter.html#where"><i class="fa fa-check"></i><b>3.1.1</b> <code>WHERE</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="filter.html"><a href="filter.html#in-or-and-not"><i class="fa fa-check"></i><b>3.1.2</b> <code>IN</code>, <code>OR</code> and <code>NOT</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sort.html"><a href="sort.html"><i class="fa fa-check"></i><b>3.2</b> Sort</a></li>
<li class="chapter" data-level="3.3" data-path="math-operations.html"><a href="math-operations.html"><i class="fa fa-check"></i><b>3.3</b> Math Operations</a></li>
<li class="chapter" data-level="3.4" data-path="aggregrate-functions.html"><a href="aggregrate-functions.html"><i class="fa fa-check"></i><b>3.4</b> Aggregrate Functions</a></li>
<li class="chapter" data-level="3.5" data-path="group-data.html"><a href="group-data.html"><i class="fa fa-check"></i><b>3.5</b> Group Data</a></li>
<li class="chapter" data-level="3.6" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subqueries-and-joins.html"><a href="subqueries-and-joins.html"><i class="fa fa-check"></i><b>4</b> Subqueries and Joins</a><ul>
<li class="chapter" data-level="4.1" data-path="subqueries.html"><a href="subqueries.html"><i class="fa fa-check"></i><b>4.1</b> Subqueries</a></li>
<li class="chapter" data-level="4.2" data-path="joins.html"><a href="joins.html"><i class="fa fa-check"></i><b>4.2</b> Joins</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modifying-and-analyzing-data-with-sql.html"><a href="modifying-and-analyzing-data-with-sql.html"><i class="fa fa-check"></i><b>5</b> Modifying and Analyzing Data with SQL</a><ul>
<li class="chapter" data-level="5.1" data-path="text-strings.html"><a href="text-strings.html"><i class="fa fa-check"></i><b>5.1</b> Text Strings</a></li>
<li class="chapter" data-level="5.2" data-path="date-and-time-strings.html"><a href="date-and-time-strings.html"><i class="fa fa-check"></i><b>5.2</b> Date and Time Strings</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SQL for Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="joins" class="section level2">
<h2><span class="header-section-number">4.2</span> Joins</h2>
<p>Benefits of breaking data into tables:</p>
<ul>
<li>Efficient storage</li>
<li>Easier manipulation</li>
<li>Greater scalability</li>
<li>Logically models a process</li>
<li>Tables are linked by common values (keys)</li>
</ul>
<p>Joins associate corrects from each table and allow data retrieval from multiple tables in one query. Note that joins are not physical. They persist for the duration of the query execution.</p>
<ul>
<li>Cartesian (cross) joins: each row from the first table joins with all the rows of another table</li>
</ul>
<p>If table 1 has <span class="math inline">\(n_1\)</span> rows and table 2 has <span class="math inline">\(n_2\)</span> rows, then after cartesian join, the resulted table will have <span class="math inline">\(n_1 \times n_2\)</span> rows. It is not frequently used and is computationally taxing.</p>
<p>Example: - Table 1: vendor_name - Table 2: product_name, product_price</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> vender_name, product_name, product_price
<span class="kw">FROM</span> Vendors, Products
<span class="kw">WHERE</span> Vendors.vendor_id = Products.vendor_id;</code></pre></div>
<p>It does not match anything. Itâ€™s just multiplying what you had in the first table with those records in the second table.</p>
<ul>
<li><strong>INNER JOIN</strong> selects records that have matching values in both tables</li>
</ul>
<p>It is one of the most frequently used joins in SQL.</p>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> suppliers.CompanyName, ProductName, UnitPrice
<span class="kw">FROM</span> Suppliers <span class="kw">INNER</span> <span class="kw">JOIN</span> Products 
<span class="kw">ON</span> Suppliers.supplierid = Products.supplierid</code></pre></div>
<p>Inner join syntax:</p>
<ul>
<li>Join type is specified (INNER JOIN)</li>
<li>Join condition is in the FROM clause and uses the On clause</li>
<li>Joining more tables together affects overall database performance</li>
<li>You can join multiple tables, no limit</li>
<li>List all the tables, then define conditions</li>
</ul>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> o.OrderID, c.CompanyName, e.LastName
<span class="kw">FROM</span> ( (Orders o <span class="kw">INNER</span> <span class="kw">JOIN</span> Customer c <span class="kw">ON</span> o.CustomerID = c.CustomerID)
<span class="kw">INNER</span> <span class="kw">JOIN</span> Employees e <span class="kw">ON</span> o.EmployeeID = e.EmployeeID
);</code></pre></div>
<p>Be careful about the names and make sure you donâ€™t make unnecessary joins.</p>
<p>Aliases and self-joins</p>
<p>SQL aliases give a table or column a temporary name. It can make column names more readable. An alias only exists for the duration of the query.</p>
<ul>
<li>WITHOUT alias</li>
</ul>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> vendor_name, product_name, product_price
<span class="kw">FROM</span> Vendors, Products
<span class="kw">WHERE</span> Vendors.vendor_id = Products.vendor_id;</code></pre></div>
<ul>
<li>WITH alias</li>
</ul>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> vendor_name, product_name, product_price
<span class="kw">FROM</span> Vendors <span class="kw">AS</span> v, Products <span class="kw">AS</span> p
<span class="kw">WHERE</span> v.vendor_id = p.vendor_id;</code></pre></div>
<p>Self-join is to join table to itself. For example, assume you want to match customers from the same city. You can take the table and treat it like two separate tables. Join the original table to itself.</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> column_name(s)
<span class="kw">FROM</span> table1 T1, table2 T2 
<span class="kw">WHERE</span> condition;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> A.CustomerName <span class="kw">AS</span> CustomerName1, B.CustomerName <span class="kw">AS</span> CustomerName2, A.City
<span class="kw">FROM</span> Customers A, Customers B
<span class="kw">WHERE</span> A.CustomerID = B.CustomerID
<span class="kw">AND</span> A.City = B.City
<span class="kw">ORDER</span> <span class="kw">BY</span> A.City;</code></pre></div>
<ul>
<li>Left/Right/Full outer joins</li>
</ul>
<p><strong>LEFT JOIN</strong> returns all rows from the left table, even if there are no matches in the right table. <strong>RIGHT JOIN</strong> returns all rows from the right table. <strong>FULL JOIN</strong> returns rows in either table.</p>
<ul>
<li>Union</li>
</ul>
<p>The <strong>UNION</strong> operator is used to combine the result-set of two or more SELECT statements. Each SELECT statement within UNION must have the same number of columns. Columns must have similar data types. The columns in each SELECT statement must be in the same order.</p>
<p>Example:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> column_name(s) <span class="kw">FROM</span>
table1
<span class="kw">UNION</span>
<span class="kw">SELECT</span> column_name(s) <span class="kw">FROM</span>
table2;</code></pre></div>
<ul>
<li><strong>Best Practices</strong>
<ul>
<li>Check the number of records</li>
<li>Does it seem logical given the kind of join you are performing?</li>
<li>Check for duplicates</li>
<li>Check the number of records each time you make a new join</li>
<li>Are you getting the expected results?</li>
<li>Start small: one table at a time</li>
<li>Think about what you are trying to do and map how you are joining data tables first</li>
<li>Use a join condition</li>
</ul></li>
<li>Summary Diagram</li>
</ul>
<div class="figure">
<img src="images/joindiagram.png" style="width:80.0%" />

</div>
<ul>
<li>Further Reading
<ul>
<li><a href="https://blog.modeanalytics.com/learning-python-sql/">Thinking in SQL vs Thinking in Python</a></li>
<li><a href="https://blog.sqlauthority.com/2009/03/11/sql-server-difference-between-union-vs-union-all-optimal-performance-comparison/">Difference Between Union and Union All - Optimal Performance Comparison</a></li>
</ul></li>
</ul>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="subqueries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modifying-and-analyzing-data-with-sql.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": ["SQL.pdf", "SQL.epub", "SQL.mobi"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
