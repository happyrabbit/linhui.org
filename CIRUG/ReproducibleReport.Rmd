---
title: "Dynamic/Reproducible Report"
subtitle: "R Markdown and HTML5"
author: "Hui Lin"
date: "`r Sys.Date()`"
output: slidy_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## R Markdown

- Example: [EX1_Markdown.Rmd](https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/EX1_Markdown.Rmd)([output](http://scientistcafe.com/CE_JSM2017/Examples/EX1_Markdown.html))

- Markdown: lightweight markup language designed to make authoring content easy for everyone

- R + Markdown = R Markdown

- How It Works? 

![](http://scientistcafe.com/CE_JSM2017/images/RMarkdownFlow.png)

## Get Started

- Create a sample `.Rmd` file in R Studio:

<center>
![](http://scientistcafe.com/CE_JSM2017/images/newmd1.PNG)
</center>

## Get Started

- Input your document title and author name and click "OK":

<center>
![](http://scientistcafe.com/CE_JSM2017/images/newmd2.PNG)
</center>

## Markdown Basic - Paragraphs, Headers

```pre
# H1
## H2
### H3
#### H4
##### H5
###### H6

Alternatively, for H1 and H2, an underline-ish style:

A First Level Header
=====================

A Second Level Header
---------------------
```

## Markdown Basic - Paragraphs, Headers

<center>
![](http://scientistcafe.com/CE_JSM2017/images/headermd.PNG){
width=50%}
</center>

## Markdown Basic - Blockquotes

```pre
A statistician gave birth to twins, but only had one of them baptised. 
She kept the other as a control.

> All you need in this life is ignorance and confidence, 
and then success is sure. [Mark Twain]
```

A statistician gave birth to twins, but only had one of them baptised. 
She kept the other as a control.

> All you need in this life is ignorance and confidence, 
and then success is sure. [Mark Twain]

## Markdown Basic - Phrase Emphasis

```pre
Some of these words *are italic*.
Some of these words _are italic also_.

Use two asterisks for **bold**.
Or, if you prefer, __use two underscores instead__.

Strikethrough uses two tildes. ~~Scratch this.~~
```

Some of these words *are italic*.
Some of these words _are italic also_.

Use two asterisks for **bold**.
Or, if you prefer, __use two underscores instead__.

Strikethrough uses two tildes. ~~Scratch this.~~

## Markdown Basic - Lists

```pre
* If it’s green and wiggles, it’s biology.
* If it stinks, it’s chemistry.
* If it doesn’t work, it’s Physics.
```

* If it’s green and wiggles, it’s biology.
* If it stinks, it’s chemistry.
* If it doesn’t work, it’s Physics.

## Markdown Basic - Lists

```pre
+ Engineers think that equations approximate the real world.
+ Scientists think that the real world approximates equations.
+ Mathematicians don’t care.
```

+ Engineers think that equations approximate the real world.
+ Scientists think that the real world approximates equations.
+ Mathematicians don’t care.


## Markdown Basic - Lists

```pre
- Engineers think that equations approximate the real world.
- Scientists think that the real world approximates equations.
- Mathematicians don’t care.
```

- Engineers think that equations approximate the real world.
- Scientists think that the real world approximates equations.
- Mathematicians don’t care.


## HTML

- Create

```pre
---
title: "Tidy and Reshape Data"
author: Hui Lin
date: May 11, 2017
output: html_document
---
```

## Table of Contents (TOC)

- Top

```pre
---
title: "Tidy and Reshape Data"
author: Hui Lin
date: May 11, 2017
output:
  html_document:
    toc: true
    toc_depth: 3
---
```

- Floating

```pre
---
title: "Tidy and Reshape Data"
author: Hui Lin
date: May 11, 2017
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---
```

- `collapsed` (defaults to `TRUE`)
- `smooth_scroll` (defaults to `TRUE`)

## Code Chunks

- start with ` ```{r} ` and end with ` ``` `
- keyboard shortcut Ctrl + Alt + I (OS X: Cmd + Option + I)
- Add Chunk command in the editor toolbar

<center>
![](http://scientistcafe.com/CE_JSM2017/images/codechunk.PNG)
</center>

## Customize Chunks

- `include = FALSE` prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks.
- `echo = FALSE` prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.
- `message = FALSE` prevents messages that are generated by code from appearing in the finished file.
- `warning = FALSE` prevents warnings that are generated by code from appearing in the finished.
- `fig.height`, `fig.width` The width and height to use in R for plots created by the chunk (in inches).

## Inline Code

<center>
![](http://scientistcafe.com/CE_JSM2017/images/inlinecode.PNG)
</center>

- Output:

<pre>
The current time is `r Sys.time()`
</pre>

## Global Options

<center>
![](http://scientistcafe.com/CE_JSM2017/images/globalsetting.PNG)
</center>

- Treat each option that you pass to `knitr::opts_chunk$set` as a global default
- Prevent code for all chunks unless you overwrite in individual chunk header

## Example

- [EX1_Markdown.Rmd](https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/EX1_Markdown.Rmd)([output](http://scientistcafe.com/CE_JSM2017/Examples/EX1_Markdown.html))

## HTML5 Slides

- `ioslides_presentation` - HTML presentations with ioslides
- `slidy_presentation` - HTML presentations with slidy
- `revealjs::revealjs_presentation` - HTML presentations with reveal.js

## `ioslides` presentation

- specify the `ioslides_presentation` output format
- [Ex_ioslide.Rmd](https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/Ex_ioslide.Rmd)([output](http://scientistcafe.com/CE_JSM2017/Examples/Ex_ioslide.html))
- add a subtitle to a slide or section by including text after the pipe (|)

```{r  fig.retina=NULL, out.width=500, echo=FALSE, fig.align='center'}
knitr::include_graphics("http://scientistcafe.com/CE_JSM2017/images/Ex_ioslide2.png")
```

## Display modes

- 'f': fullscreen mode
- 'w': toggle widescreen mode
- 'o': overview mode
- 'h': code highlight mode
    <center>
    ![](http://scientistcafe.com/CE_JSM2017/images/Ex_ioslide3.png)
    </center>
- 'p': show presenter notes

## `slidy` presentation

- specify the `slidy_presentation` output format
- [Ex_slidy.Rmd](https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/Ex_slidy.Rmd)([output](http://scientistcafe.com/CE_JSM2017/Examples/Ex_slidy.html))

## Display modes

- `C` Show table of contents
- `F` Toggles the display of the footer
- `A` Toggles display of current vs. all slides (useful for printing handouts)
- `S` Make fonts smaller
- `B` Make fonts larger

##  Dashboards

- Reproducible, flexible 
- Nice display: browser and mobile devices
- Support a wide variety of components 
- Extensive support for text annotations
- Storyboard layouts for presenting sequences of visualizations and related commentary
- Deployed on any web server or attached to an email message
- Can be combined with Shiny

## Create a dashboard

```{r  fig.retina=NULL, out.width=400, echo=FALSE, fig.align='center'}
knitr::include_graphics("http://scientistcafe.com/CE_JSM2017/Examples/createdashboard.PNG")
```

## Layout by Column

<center>
![](http://scientistcafe.com/CE_JSM2017/images/layoutputcode.PNG){
width=60% }
</center>

## Layout by Column Output

<center>
![](http://scientistcafe.com/CE_JSM2017/images/layoutput.PNG){
width=80% }
</center>

## Your Turn

- Create a dashboard with layout by column

## Layout by Row

- Set `orientation: rows`

<center>
![](http://scientistcafe.com/CE_JSM2017/images/layoutputcode2.PNG){
width=60% }
</center>

## Layout by Row Output

<center>
![](http://scientistcafe.com/CE_JSM2017/images/layoutput2.PNG){
width=80% }
</center>

## Your Turn

- Create a dashboard with layout by row

##  Multiple pages

```pre
Page 1
=====================================  
    
Column 1 {data-width=600}
-------------------------------------
    
### Chart 1

Column 2 {data-width=400}
-------------------------------------
   
### Chart 2

Page 2 {data-orientation=rows}
=====================================     
   
Row 1 {data-height=600}
-------------------------------------

### Chart 1

Row 1 {data-height=600}
-------------------------------------
```

## Your Turn

- [Dashboard](http://scientistcafe.com/CE_JSM2017/Examples/dashboard_multi-page.html) and [Source Code](https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/dashboard_multi-page.Rmd)

## Storyboard

- Present a sequence of charts and related commentary

<center>
![](http://scientistcafe.com/CE_JSM2017/images/layoutputcode8.PNG){
width=80%}
</center>

## Storyboard Output

- [See an example here](http://scientistcafe.com/CE_JSM2017/Examples/storyboard.html)

<center>
![](http://scientistcafe.com/CE_JSM2017/images/layoutput8.PNG){
width=80% }
</center>

## Your Turn

- [Repeat the example here](http://scientistcafe.com/CE_JSM2017/Examples/storyboard.html)

## Components

- HTML Widgets: [Widgets List](http://scientistcafe.com/CE_JSM2017/dynamicreproducible-report.html#html-widgets-1)
- Standard R graphics: [source code](http://scientistcafe.com/CE_JSM2017/Examples/basicgraphic.Rmd), [output](http://scientistcafe.com/CE_JSM2017/Examples/basicgraphic.html)
- Tabular Data: [source code](http://scientistcafe.com/CE_JSM2017/Examples/tabularcom.Rmd), [output](http://scientistcafe.com/CE_JSM2017/Examples/tabularcom.html)
- Value Boxes: [source code](http://scientistcafe.com/CE_JSM2017/Examples/valuebox.Rmd) , [output](http://scientistcafe.com/CE_JSM2017/Examples/valuebox.html)
- Gauges: [source code](http://scientistcafe.com/CE_JSM2017/Examples/gauge.Rmd),  [output](http://scientistcafe.com/CE_JSM2017/Examples/gauge.html)

## Shiny - Example 1

```r
library(shiny)
source("https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/shiny1.R")
shinyApp(ui = ui, server = server)
```

<font size="4"><strong>Example 1: Customer Segment Plot </strong></font>

![](http://scientistcafe.com/CE_JSM2017/images/shiny1.PNG){
width=80% }

## Shiny: render calls

- `renderDataTable`
- `renderImage`
- `renderPlot`
- `renderPrint`
- `renderTable`
- `renderText`
- `renderUI`

## Shiny - Example 2

```r
library(shiny)
source("https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/shiny2.R")
shinyApp(ui = ui, server = server)
```

<font size="4"><strong> Example 2: Customer Segment Plot and Summary Table</strong></font>

<center>
![](http://scientistcafe.com/CE_JSM2017/images/shiny2.PNG){
width=60%}
</center>

## `reactive()`

- A `reactive` expression to return the subset of data according to user's choice

   1. user provide input
   1. backend R code will run using the input
   1. report an output back to user

- see the [Reactivity Overview](http://shiny.rstudio.com/articles/reactivity-overview.html)
- Excellent Shiny tutorial from beginning to deep level: http://shiny.rstudio.com/tutorial/

## Using `shiny` with `flexdashboard`

- Click [here](https://raw.githubusercontent.com/happyrabbit/linhui.org/gh-pages/CE_JSM2017/Examples/segmentdb.Rmd) to download the complete source code. Here is the [app](https://scientistcafe.shinyapps.io/shinysample/)

<pre>---
title: "Customer Segmentation Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    source_code: embed
    social: menu
    theme: flatly
runtime: shiny
---</pre>

