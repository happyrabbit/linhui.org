<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11.4 Regression and Decision Tree Basic | Introduction to Data Science</title>
  <meta name="description" content="11.4 Regression and Decision Tree Basic | Introduction to Data Science" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="11.4 Regression and Decision Tree Basic | Introduction to Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://scientistcafe.com/IDS/" />
  
  <meta property="og:description" content="11.4 Regression and Decision Tree Basic | Introduction to Data Science" />
  <meta name="github-repo" content="happyrabbit/IntroDataScience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11.4 Regression and Decision Tree Basic | Introduction to Data Science" />
  
  <meta name="twitter:description" content="11.4 Regression and Decision Tree Basic | Introduction to Data Science" />
  

<meta name="author" content="Hui Lin and Ming Li" />


<meta name="date" content="2022-09-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tree-pruning.html"/>
<link rel="next" href="bagging-tree-1.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://scientistcafe.com">Homepage</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a>
<ul>
<li><a href="goal-of-the-book.html#goal-of-the-book">Goal of the Book<span></span></a></li>
<li><a href="what-this-book-covers.html#what-this-book-covers">What This Book Covers<span></span></a></li>
<li><a href="who-this-book-is-for.html#who-this-book-is-for">Who This Book Is For<span></span></a></li>
<li><a href="how-to-use-this-book.html#how-to-use-this-book">How to Use This Book<span></span></a>
<ul>
<li><a href="how-to-use-this-book.html#what-the-book-assumes">What the book assumes<span></span></a></li>
<li><a href="how-to-use-this-book.html#how-to-run-r-and-python-code">How to run R and Python code<span></span></a></li>
</ul></li>
<li><a href="complementary-reading.html#complementary-reading">Complementary Reading<span></span></a></li>
<li><a href="acknowledgements.html#acknowledgements">Acknowledgements<span></span></a></li>
</ul></li>
<li><a href="about-the-authors.html#about-the-authors">About the Authors<span></span></a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-brief-history-of-data-science.html"><a href="a-brief-history-of-data-science.html"><i class="fa fa-check"></i><b>1.1</b> A brief history of data science<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="data-science-role-and-skill-tracks.html"><a href="data-science-role-and-skill-tracks.html"><i class="fa fa-check"></i><b>1.2</b> Data science role and skill tracks<span></span></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-science-role-and-skill-tracks.html"><a href="data-science-role-and-skill-tracks.html#engineering"><i class="fa fa-check"></i><b>1.2.1</b> Engineering<span></span></a></li>
<li class="chapter" data-level="1.2.2" data-path="data-science-role-and-skill-tracks.html"><a href="data-science-role-and-skill-tracks.html#analysis"><i class="fa fa-check"></i><b>1.2.2</b> Analysis<span></span></a></li>
<li class="chapter" data-level="1.2.3" data-path="data-science-role-and-skill-tracks.html"><a href="data-science-role-and-skill-tracks.html#modeling"><i class="fa fa-check"></i><b>1.2.3</b> Modeling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="what-kind-of-questions-can-data-science-solve.html"><a href="what-kind-of-questions-can-data-science-solve.html"><i class="fa fa-check"></i><b>1.3</b> What kind of questions can data science solve?<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="what-kind-of-questions-can-data-science-solve.html"><a href="what-kind-of-questions-can-data-science-solve.html#prerequisites"><i class="fa fa-check"></i><b>1.3.1</b> Prerequisites<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="what-kind-of-questions-can-data-science-solve.html"><a href="what-kind-of-questions-can-data-science-solve.html#problem-type"><i class="fa fa-check"></i><b>1.3.2</b> Problem type<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="structure-data-science-team.html"><a href="structure-data-science-team.html"><i class="fa fa-check"></i><b>1.4</b> Structure data science team<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="list-of-potential-data-science-careers.html"><a href="list-of-potential-data-science-careers.html"><i class="fa fa-check"></i><b>1.5</b> List of potential data science careers<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html"><i class="fa fa-check"></i><b>2</b> Soft Skills for Data Scientists<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="comparison-between-statistician-and-data-scientist.html"><a href="comparison-between-statistician-and-data-scientist.html"><i class="fa fa-check"></i><b>2.1</b> Comparison between Statistician and Data Scientist<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="beyond-data-and-analytics.html"><a href="beyond-data-and-analytics.html"><i class="fa fa-check"></i><b>2.2</b> Beyond Data and Analytics<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="three-pillars-of-knowledge.html"><a href="three-pillars-of-knowledge.html"><i class="fa fa-check"></i><b>2.3</b> Three Pillars of Knowledge<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="data-science-project-cycle.html"><a href="data-science-project-cycle.html"><i class="fa fa-check"></i><b>2.4</b> Data Science Project Cycle<span></span></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-science-project-cycle.html"><a href="data-science-project-cycle.html#types-of-data-science-projects"><i class="fa fa-check"></i><b>2.4.1</b> Types of Data Science Projects<span></span></a></li>
<li class="chapter" data-level="2.4.2" data-path="data-science-project-cycle.html"><a href="data-science-project-cycle.html#problem-formulation-and-project-planning-stage"><i class="fa fa-check"></i><b>2.4.2</b> Problem Formulation and Project Planning Stage<span></span></a></li>
<li class="chapter" data-level="2.4.3" data-path="data-science-project-cycle.html"><a href="data-science-project-cycle.html#project-modeling-stage"><i class="fa fa-check"></i><b>2.4.3</b> Project Modeling Stage<span></span></a></li>
<li class="chapter" data-level="2.4.4" data-path="data-science-project-cycle.html"><a href="data-science-project-cycle.html#model-implementation-and-post-production-stage"><i class="fa fa-check"></i><b>2.4.4</b> Model Implementation and Post Production Stage<span></span></a></li>
<li class="chapter" data-level="2.4.5" data-path="data-science-project-cycle.html"><a href="data-science-project-cycle.html#project-cycle-summary"><i class="fa fa-check"></i><b>2.4.5</b> Project Cycle Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="common-mistakes-in-data-science.html"><a href="common-mistakes-in-data-science.html"><i class="fa fa-check"></i><b>2.5</b> Common Mistakes in Data Science<span></span></a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="common-mistakes-in-data-science.html"><a href="common-mistakes-in-data-science.html#problem-formulation-stage"><i class="fa fa-check"></i><b>2.5.1</b> Problem Formulation Stage<span></span></a></li>
<li class="chapter" data-level="2.5.2" data-path="common-mistakes-in-data-science.html"><a href="common-mistakes-in-data-science.html#project-planning-stage"><i class="fa fa-check"></i><b>2.5.2</b> Project Planning Stage<span></span></a></li>
<li class="chapter" data-level="2.5.3" data-path="common-mistakes-in-data-science.html"><a href="common-mistakes-in-data-science.html#project-modeling-stage-1"><i class="fa fa-check"></i><b>2.5.3</b> Project Modeling Stage<span></span></a></li>
<li class="chapter" data-level="2.5.4" data-path="common-mistakes-in-data-science.html"><a href="common-mistakes-in-data-science.html#model-implementation-and-post-production-stage-1"><i class="fa fa-check"></i><b>2.5.4</b> Model Implementation and Post Production Stage<span></span></a></li>
<li class="chapter" data-level="2.5.5" data-path="common-mistakes-in-data-science.html"><a href="common-mistakes-in-data-science.html#summary-of-common-mistakes"><i class="fa fa-check"></i><b>2.5.5</b> Summary of Common Mistakes<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to The Data<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="customer-data-for-a-clothing-company.html"><a href="customer-data-for-a-clothing-company.html"><i class="fa fa-check"></i><b>3.1</b> Customer Data for A Clothing Company<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="swinediseasedata.html"><a href="swinediseasedata.html"><i class="fa fa-check"></i><b>3.2</b> Swine Disease Breakout Data<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="mnist-dataset.html"><a href="mnist-dataset.html"><i class="fa fa-check"></i><b>3.3</b> MNIST Dataset<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="imdb-dataset.html"><a href="imdb-dataset.html"><i class="fa fa-check"></i><b>3.4</b> IMDB Dataset<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bigdatacloudplatform.html"><a href="bigdatacloudplatform.html"><i class="fa fa-check"></i><b>4</b> Big Data Cloud Platform<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="power-of-cluster-of-computers.html"><a href="power-of-cluster-of-computers.html"><i class="fa fa-check"></i><b>4.1</b> Power of Cluster of Computers<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="evolution-of-cluster-computing.html"><a href="evolution-of-cluster-computing.html"><i class="fa fa-check"></i><b>4.2</b> Evolution of Cluster Computing<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="evolution-of-cluster-computing.html"><a href="evolution-of-cluster-computing.html#hadoop"><i class="fa fa-check"></i><b>4.2.1</b> Hadoop<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="evolution-of-cluster-computing.html"><a href="evolution-of-cluster-computing.html#spark"><i class="fa fa-check"></i><b>4.2.2</b> Spark<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="CloudEnvironment.html"><a href="CloudEnvironment.html"><i class="fa fa-check"></i><b>4.3</b> Introduction of Cloud Environment<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="CloudEnvironment.html"><a href="CloudEnvironment.html#open-account-and-create-a-cluster"><i class="fa fa-check"></i><b>4.3.1</b> Open Account and Create a Cluster<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="CloudEnvironment.html"><a href="CloudEnvironment.html#r-notebook"><i class="fa fa-check"></i><b>4.3.2</b> R Notebook<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="CloudEnvironment.html"><a href="CloudEnvironment.html#markdown-cells"><i class="fa fa-check"></i><b>4.3.3</b> Markdown Cells<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="leveragesparkr.html"><a href="leveragesparkr.html"><i class="fa fa-check"></i><b>4.4</b> Leverage Spark Using R Notebook<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="databases-and-sql.html"><a href="databases-and-sql.html"><i class="fa fa-check"></i><b>4.5</b> Databases and SQL<span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="databases-and-sql.html"><a href="databases-and-sql.html#history"><i class="fa fa-check"></i><b>4.5.1</b> History<span></span></a></li>
<li class="chapter" data-level="4.5.2" data-path="databases-and-sql.html"><a href="databases-and-sql.html#database-table-and-view"><i class="fa fa-check"></i><b>4.5.2</b> Database, Table and View<span></span></a></li>
<li class="chapter" data-level="4.5.3" data-path="databases-and-sql.html"><a href="databases-and-sql.html#basic-sql-statement"><i class="fa fa-check"></i><b>4.5.3</b> Basic SQL Statement<span></span></a></li>
<li class="chapter" data-level="4.5.4" data-path="databases-and-sql.html"><a href="databases-and-sql.html#advanced-topics-in-database"><i class="fa fa-check"></i><b>4.5.4</b> Advanced Topics in Database<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="datapreprocessing.html"><a href="datapreprocessing.html"><i class="fa fa-check"></i><b>5</b> Data Pre-processing<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>5.1</b> Data Cleaning<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>5.2</b> Missing Values<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="missing-values.html"><a href="missing-values.html#impute-missing-values-with-medianmode"><i class="fa fa-check"></i><b>5.2.1</b> Impute missing values with median/mode<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="missing-values.html"><a href="missing-values.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>5.2.2</b> K-nearest neighbors<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="missing-values.html"><a href="missing-values.html#bagging-tree"><i class="fa fa-check"></i><b>5.2.3</b> Bagging Tree<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="centering-and-scaling.html"><a href="centering-and-scaling.html"><i class="fa fa-check"></i><b>5.3</b> Centering and Scaling<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="resolve-skewness.html"><a href="resolve-skewness.html"><i class="fa fa-check"></i><b>5.4</b> Resolve Skewness<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="outliers.html"><a href="outliers.html"><i class="fa fa-check"></i><b>5.5</b> Resolve Outliers<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="collinearity.html"><a href="collinearity.html"><i class="fa fa-check"></i><b>5.6</b> Collinearity<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="sparse-variables.html"><a href="sparse-variables.html"><i class="fa fa-check"></i><b>5.7</b> Sparse Variables<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="re-encode-dummy-variables.html"><a href="re-encode-dummy-variables.html"><i class="fa fa-check"></i><b>5.8</b> Re-encode Dummy Variables<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="datawrangline.html"><a href="datawrangline.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="summarize-data.html"><a href="summarize-data.html"><i class="fa fa-check"></i><b>6.1</b> Summarize Data<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="summarize-data.html"><a href="summarize-data.html#dplyr-package"><i class="fa fa-check"></i><b>6.1.1</b> <code>dplyr</code> package<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="summarize-data.html"><a href="summarize-data.html#applyfamilyinbaser"><i class="fa fa-check"></i><b>6.1.2</b> <code>apply()</code>, <code>lapply()</code> and <code>sapply()</code> in base R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tidy-and-reshape-data.html"><a href="tidy-and-reshape-data.html"><i class="fa fa-check"></i><b>6.2</b> Tidy and Reshape Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modeltuningstrategy.html"><a href="modeltuningstrategy.html"><i class="fa fa-check"></i><b>7</b> Model Tuning Strategy<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="vbtradeoff.html"><a href="vbtradeoff.html"><i class="fa fa-check"></i><b>7.1</b> Variance-Bias Trade-Off<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="datasplittingresampling.html"><a href="datasplittingresampling.html"><i class="fa fa-check"></i><b>7.2</b> Data Splitting and Resampling<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="datasplittingresampling.html"><a href="datasplittingresampling.html#datasplitting"><i class="fa fa-check"></i><b>7.2.1</b> Data Splitting<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="datasplittingresampling.html"><a href="datasplittingresampling.html#resampling"><i class="fa fa-check"></i><b>7.2.2</b> Resampling<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="measuring-performance.html"><a href="measuring-performance.html"><i class="fa fa-check"></i><b>8</b> Measuring Performance<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression-model-performance.html"><a href="regression-model-performance.html"><i class="fa fa-check"></i><b>8.1</b> Regression Model Performance<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="classification-model-performance.html"><a href="classification-model-performance.html"><i class="fa fa-check"></i><b>8.2</b> Classification Model Performance<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="classification-model-performance.html"><a href="classification-model-performance.html#confusion-matrix"><i class="fa fa-check"></i><b>8.2.1</b> Confusion Matrix<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="classification-model-performance.html"><a href="classification-model-performance.html#kappa-statistic"><i class="fa fa-check"></i><b>8.2.2</b> Kappa Statistic<span></span></a></li>
<li class="chapter" data-level="8.2.3" data-path="classification-model-performance.html"><a href="classification-model-performance.html#roc"><i class="fa fa-check"></i><b>8.2.3</b> ROC<span></span></a></li>
<li class="chapter" data-level="8.2.4" data-path="classification-model-performance.html"><a href="classification-model-performance.html#gain-and-lift-charts"><i class="fa fa-check"></i><b>8.2.4</b> Gain and Lift Charts<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i><b>9</b> Regression Models<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="ordinary-least-square.html"><a href="ordinary-least-square.html"><i class="fa fa-check"></i><b>9.1</b> Ordinary Least Square<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ordinary-least-square.html"><a href="ordinary-least-square.html#the-magic-p-value"><i class="fa fa-check"></i><b>9.1.1</b> The Magic P-value<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="ordinary-least-square.html"><a href="ordinary-least-square.html#diagnostics-for-linear-regression"><i class="fa fa-check"></i><b>9.1.2</b> Diagnostics for Linear Regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="principal-component-regression-and-partial-least-square.html"><a href="principal-component-regression-and-partial-least-square.html"><i class="fa fa-check"></i><b>9.2</b> Principal Component Regression and Partial Least Square<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regularization-methods.html"><a href="regularization-methods.html"><i class="fa fa-check"></i><b>10</b> Regularization Methods<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="ridge-regression.html"><a href="ridge-regression.html"><i class="fa fa-check"></i><b>10.1</b> Ridge Regression<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i><b>10.2</b> LASSO<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="variable-selection-property-of-the-lasso.html"><a href="variable-selection-property-of-the-lasso.html"><i class="fa fa-check"></i><b>10.3</b> Variable selection property of the lasso<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="elastic-net.html"><a href="elastic-net.html"><i class="fa fa-check"></i><b>10.4</b> Elastic Net<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="penalized-generalized-linear-model.html"><a href="penalized-generalized-linear-model.html"><i class="fa fa-check"></i><b>10.5</b> Penalized Generalized Linear Model<span></span></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="penalized-generalized-linear-model.html"><a href="penalized-generalized-linear-model.html#introduction-to-glmnet-package"><i class="fa fa-check"></i><b>10.5.1</b> Introduction to <code>glmnet</code> package<span></span></a></li>
<li class="chapter" data-level="10.5.2" data-path="penalized-generalized-linear-model.html"><a href="penalized-generalized-linear-model.html#penalized-logistic-regression"><i class="fa fa-check"></i><b>10.5.2</b> Penalized logistic regression<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="treemodel.html"><a href="treemodel.html"><i class="fa fa-check"></i><b>11</b> Tree-Based Methods<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="tree-basics.html"><a href="tree-basics.html"><i class="fa fa-check"></i><b>11.1</b> Tree Basics<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="splitting-criteria.html"><a href="splitting-criteria.html"><i class="fa fa-check"></i><b>11.2</b> Splitting Criteria<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="tree-pruning.html"><a href="tree-pruning.html"><i class="fa fa-check"></i><b>11.3</b> Tree Pruning<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="regression-and-decision-tree-basic.html"><a href="regression-and-decision-tree-basic.html"><i class="fa fa-check"></i><b>11.4</b> Regression and Decision Tree Basic<span></span></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="regression-and-decision-tree-basic.html"><a href="regression-and-decision-tree-basic.html#regression-tree"><i class="fa fa-check"></i><b>11.4.1</b> Regression Tree<span></span></a></li>
<li class="chapter" data-level="11.4.2" data-path="regression-and-decision-tree-basic.html"><a href="regression-and-decision-tree-basic.html#decision-tree"><i class="fa fa-check"></i><b>11.4.2</b> Decision Tree<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="bagging-tree-1.html"><a href="bagging-tree-1.html"><i class="fa fa-check"></i><b>11.5</b> Bagging Tree<span></span></a></li>
<li class="chapter" data-level="11.6" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>11.6</b> Random Forest<span></span></a></li>
<li class="chapter" data-level="11.7" data-path="gradient-boosted-machine.html"><a href="gradient-boosted-machine.html"><i class="fa fa-check"></i><b>11.7</b> Gradient Boosted Machine<span></span></a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="gradient-boosted-machine.html"><a href="gradient-boosted-machine.html#adaptive-boosting"><i class="fa fa-check"></i><b>11.7.1</b> Adaptive Boosting<span></span></a></li>
<li class="chapter" data-level="11.7.2" data-path="gradient-boosted-machine.html"><a href="gradient-boosted-machine.html#stochastic-gradient-boosting"><i class="fa fa-check"></i><b>11.7.2</b> Stochastic Gradient Boosting<span></span></a></li>
<li class="chapter" data-level="11.7.3" data-path="gradient-boosted-machine.html"><a href="gradient-boosted-machine.html#boosting-as-additive-model"><i class="fa fa-check"></i><b>11.7.3</b> Boosting as Additive Model<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="deeplearning.html"><a href="deeplearning.html"><i class="fa fa-check"></i><b>12</b> Deep Learning<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="projection-pursuit-regression.html"><a href="projection-pursuit-regression.html"><i class="fa fa-check"></i><b>12.1</b> Projection Pursuit Regression<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html"><i class="fa fa-check"></i><b>12.2</b> Feedforward Neural Network<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#logisticregasneuralnetwork"><i class="fa fa-check"></i><b>12.2.1</b> Logistic Regression as Neural Network<span></span></a></li>
<li class="chapter" data-level="12.2.2" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#stochastic-gradient-descent"><i class="fa fa-check"></i><b>12.2.2</b> Stochastic Gradient Descent<span></span></a></li>
<li class="chapter" data-level="12.2.3" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#deepneuralnetwork"><i class="fa fa-check"></i><b>12.2.3</b> Deep Neural Network<span></span></a></li>
<li class="chapter" data-level="12.2.4" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#activationfunction"><i class="fa fa-check"></i><b>12.2.4</b> Activation Function<span></span></a></li>
<li class="chapter" data-level="12.2.5" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#optimization"><i class="fa fa-check"></i><b>12.2.5</b> Optimization<span></span></a></li>
<li class="chapter" data-level="12.2.6" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#deal-with-overfitting"><i class="fa fa-check"></i><b>12.2.6</b> Deal with Overfitting<span></span></a></li>
<li class="chapter" data-level="12.2.7" data-path="feedforward-neural-network.html"><a href="feedforward-neural-network.html#ffnnexample"><i class="fa fa-check"></i><b>12.2.7</b> Image Recognition Using FFNN<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="convolutional-neural-network.html"><a href="convolutional-neural-network.html"><i class="fa fa-check"></i><b>12.3</b> Convolutional Neural Network<span></span></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="convolutional-neural-network.html"><a href="convolutional-neural-network.html#convolution-layer"><i class="fa fa-check"></i><b>12.3.1</b> Convolution Layer<span></span></a></li>
<li class="chapter" data-level="12.3.2" data-path="convolutional-neural-network.html"><a href="convolutional-neural-network.html#padding-layer"><i class="fa fa-check"></i><b>12.3.2</b> Padding Layer<span></span></a></li>
<li class="chapter" data-level="12.3.3" data-path="convolutional-neural-network.html"><a href="convolutional-neural-network.html#pooling-layer"><i class="fa fa-check"></i><b>12.3.3</b> Pooling Layer<span></span></a></li>
<li class="chapter" data-level="12.3.4" data-path="convolutional-neural-network.html"><a href="convolutional-neural-network.html#convolution-over-volume"><i class="fa fa-check"></i><b>12.3.4</b> Convolution Over Volume<span></span></a></li>
<li class="chapter" data-level="12.3.5" data-path="convolutional-neural-network.html"><a href="convolutional-neural-network.html#cnnexample"><i class="fa fa-check"></i><b>12.3.5</b> Image Recognition Using CNN<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="recurrent-neural-network.html"><a href="recurrent-neural-network.html"><i class="fa fa-check"></i><b>12.4</b> Recurrent Neural Network<span></span></a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="recurrent-neural-network.html"><a href="recurrent-neural-network.html#rnn-model"><i class="fa fa-check"></i><b>12.4.1</b> RNN Model<span></span></a></li>
<li class="chapter" data-level="12.4.2" data-path="recurrent-neural-network.html"><a href="recurrent-neural-network.html#embedding"><i class="fa fa-check"></i><b>12.4.2</b> Word Embedding<span></span></a></li>
<li class="chapter" data-level="12.4.3" data-path="recurrent-neural-network.html"><a href="recurrent-neural-network.html#lstm"><i class="fa fa-check"></i><b>12.4.3</b> Long Short Term Memory<span></span></a></li>
<li class="chapter" data-level="12.4.4" data-path="recurrent-neural-network.html"><a href="recurrent-neural-network.html#rnnexample"><i class="fa fa-check"></i><b>12.4.4</b> Sentiment Analysis Using RNN<span></span></a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix<span></span></b></span></li>
<li class="chapter" data-level="A" data-path="largelocaldata.html"><a href="largelocaldata.html"><i class="fa fa-check"></i><b>A</b> Handling Large Local Data<span></span></a>
<ul>
<li class="chapter" data-level="A.1" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>A.1</b> <code>readr</code><span></span></a></li>
<li class="chapter" data-level="A.2" data-path="data.table-enhanced-data.html"><a href="data.table-enhanced-data.html"><i class="fa fa-check"></i><b>A.2</b> <code>data.table</code>— enhanced <code>data.frame</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="r-code-for-data-simulation.html"><a href="r-code-for-data-simulation.html"><i class="fa fa-check"></i><b>B</b> R code for data simulation<span></span></a>
<ul>
<li class="chapter" data-level="B.1" data-path="appendixdata1.html"><a href="appendixdata1.html"><i class="fa fa-check"></i><b>B.1</b> Customer Data for Clothing Company<span></span></a></li>
<li class="chapter" data-level="B.2" data-path="appendixdata3.html"><a href="appendixdata3.html"><i class="fa fa-check"></i><b>B.2</b> Swine Disease Breakout Data<span></span></a></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-and-decision-tree-basic" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Regression and Decision Tree Basic<a href="regression-and-decision-tree-basic.html#regression-and-decision-tree-basic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regression-tree" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Regression Tree<a href="regression-and-decision-tree-basic.html#regression-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at the process of building a regression tree <span class="citation">(<a href="#ref-ISLR15" role="doc-biblioref">Gareth James and Tibshirani 2015</a>)</span>. There are two steps:</p>
<ol style="list-style-type: decimal">
<li>Divide predictors space — that is a set of possible values of <span class="math inline">\(X_1,X_2,\dots,X_p\)</span>— into <span class="math inline">\(J\)</span> distinct and non-overlapping regions: <span class="math inline">\(R_1,R_2,\dots,R_J\)</span></li>
<li>For every observation that falls into the region <span class="math inline">\(R_j\)</span>, the prediction is the mean of the response values for the training observations in <span class="math inline">\(R_j\)</span></li>
</ol>
<p>Let’s go back to the previous baby example. If we use the variable “Gender” to divide the observations, we obtain two regions <span class="math inline">\(R_1\)</span> (female) and <span class="math inline">\(R_2\)</span> (male).</p>
<center>
<img src="images/varEN.png" />
</center>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="regression-and-decision-tree-basic.html#cb297-1" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">156</span>, <span class="dv">167</span>, <span class="dv">165</span>, <span class="dv">163</span>, <span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">160</span>)</span>
<span id="cb297-2"><a href="regression-and-decision-tree-basic.html#cb297-2" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">172</span>, <span class="dv">180</span>, <span class="dv">176</span>)</span></code></pre></div>
<p>The sample average for region <span class="math inline">\(R_1\)</span> is 163, for region <span class="math inline">\(R_2\)</span> is 176. For a new observation, if it is female, the model predicts the height to be 163, if it is male, the predicted height is 176. Calculating the mean is easy. Let’s look at the first step in more detail which is to divide the space into <span class="math inline">\(R_1, R_2, \dots, R_J\)</span>.</p>
<p>In theory, the region can be any shape. However, to simplify the problem, we divide the predictor space into high-dimensional rectangles. The goal is to divide the space in a way that minimize RSS. Practically, it is nearly impossible to consider all possible partitions of the feature space. So we use an approach named recursive binary splitting, a top-down , greedy algorithm. The process starts from the top of the tree (root node) and then successively splits the predictor space. Each split produces two branches (hence binary). At each step of the process, it chooses the best split at that particular step, rather than looking ahead and picking a split that leads to a better tree in general (hence greedy).</p>
<p><span class="math display">\[R_{1}(j, s)=\{X|X_j&lt;s\}\ and\ R_{2}(j, s)=\{X|X_j\geq s\}\]</span></p>
<p>Calculate the RSS decrease after the split. For different <span class="math inline">\((j,s)\)</span>, search for the combination that minimizes the RSS, that is to minimize the following:</p>
<p><span class="math display">\[\Sigma_{i:x_i\in R_1(j,s)}(y_i-\hat{y}_{R_{1}})^2+\Sigma_{i:x_i\in R_2(j,s)}(y_i-\hat{y}_{R_{2}})^2\]</span></p>
<p>where <span class="math inline">\(\hat{y}_{R_1}\)</span> is the mean of all samples in <span class="math inline">\(R_1\)</span>, <span class="math inline">\(\hat{y}_{R_2}\)</span> is the mean of samples in <span class="math inline">\(R_2\)</span>. It can be quick to optimize the equation above. Especially when <span class="math inline">\(p\)</span> is not too large.</p>
<p>Next, we continue to search for the split that optimize the RSS. Note that the optimization is limited in the sub-region. The process keeps going until a stopping criterion is reaches. For example, continue until no region contains more than 5 samples or the RSS decreases less than 1%. The process is like a tree growing.</p>
<center>
<img src="images/BinaryTree.png" />
</center>
<p>There are multiple R packages for building regression tree, such as <code>ctree</code>, <code>rpart</code> and <code>tree</code>. <code>rpart</code> is widely used for building a single tree. The split is based on CART algorithm, using <code>rpart()</code> function from the package. There are some parameters that controls the model fitting, such as the minimum number of observations that must exist in a node in order for a split to be attempted, the minimum number of observations in any leaf node etc. You can can set those parameter using <code>rpart.control</code>.</p>
<p>A more convenient way is to use <code>train()</code> function in <code>caret</code> package. The package can call <code>rpart()</code> function and train the model through cross-validation. In this case, the most common parameters are <code>cp</code> (complexity parameter) and <code>maxdepth</code> (the maximum depth of any node of the final tree). To tune the complexity parameter, set <code>method = "rpart"</code>. To tune the maximum tree depth, set <code>method = "rpart2"</code> :</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="regression-and-decision-tree-basic.html#cb298-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;http://bit.ly/2P5gTw4&quot;</span>)</span>
<span id="cb298-2"><a href="regression-and-decision-tree-basic.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data cleaning: delete wrong observations</span></span>
<span id="cb298-3"><a href="regression-and-decision-tree-basic.html#cb298-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(dat, store_exp <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> online_exp <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb298-4"><a href="regression-and-decision-tree-basic.html#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use the 10 survey questions as predictors</span></span>
<span id="cb298-5"><a href="regression-and-decision-tree-basic.html#cb298-5" aria-hidden="true" tabindex="-1"></a>trainx <span class="ot">&lt;-</span> dat[, <span class="fu">grep</span>(<span class="st">&quot;Q&quot;</span>, <span class="fu">names</span>(dat))]</span>
<span id="cb298-6"><a href="regression-and-decision-tree-basic.html#cb298-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the sum of store and online expenditure as response variable</span></span>
<span id="cb298-7"><a href="regression-and-decision-tree-basic.html#cb298-7" aria-hidden="true" tabindex="-1"></a><span class="co"># total expenditure = store expenditure + online expenditure</span></span>
<span id="cb298-8"><a href="regression-and-decision-tree-basic.html#cb298-8" aria-hidden="true" tabindex="-1"></a>trainy <span class="ot">&lt;-</span> dat<span class="sc">$</span>store_exp <span class="sc">+</span> dat<span class="sc">$</span>online_exp</span>
<span id="cb298-9"><a href="regression-and-decision-tree-basic.html#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb298-10"><a href="regression-and-decision-tree-basic.html#cb298-10" aria-hidden="true" tabindex="-1"></a>rpartTune <span class="ot">&lt;-</span> <span class="fu">train</span>(trainx, trainy, </span>
<span id="cb298-11"><a href="regression-and-decision-tree-basic.html#cb298-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart2&quot;</span>, </span>
<span id="cb298-12"><a href="regression-and-decision-tree-basic.html#cb298-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>, </span>
<span id="cb298-13"><a href="regression-and-decision-tree-basic.html#cb298-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>))</span>
<span id="cb298-14"><a href="regression-and-decision-tree-basic.html#cb298-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rpartTune)</span></code></pre></div>
<p><img src="IDS_files/figure-html/unnamed-chunk-137-1.svg" width="672" /></p>
<p>RMSE doesn’t change much when the maximum is larger than 2. So we set the maximum depth to be 2 and refit the model:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="regression-and-decision-tree-basic.html#cb299-1" aria-hidden="true" tabindex="-1"></a>rpartTree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(trainy <span class="sc">~</span> ., <span class="at">data =</span> trainx, <span class="at">maxdepth =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>You can check the result using <code>print()</code>:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="regression-and-decision-tree-basic.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rpartTree)</span></code></pre></div>
<pre><code>## n= 999 
## 
## node), split, n, deviance, yval
##       * denotes terminal node
## 
## 1) root 999 1.581e+10  3479.0  
##   2) Q3&lt; 3.5 799 2.374e+09  1819.0  
##     4) Q5&lt; 1.5 250 3.534e+06   705.2 *
##     5) Q5&gt;=1.5 549 1.919e+09  2326.0 *
##   3) Q3&gt;=3.5 200 2.436e+09 10110.0 *</code></pre>
<p>You can see that the final model picks <code>Q3</code> and <code>Q5</code> to predict total expenditure. To visualize the tree, you can convert <code>rpart</code> object to <code>party</code> object using <code>partykit</code> then use <code>plot()</code> function:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="regression-and-decision-tree-basic.html#cb302-1" aria-hidden="true" tabindex="-1"></a>rpartTree2 <span class="ot">&lt;-</span> <span class="fu">as.party</span>(rpartTree)</span>
<span id="cb302-2"><a href="regression-and-decision-tree-basic.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rpartTree2)</span></code></pre></div>
<p><img src="IDS_files/figure-html/unnamed-chunk-140-1.svg" width="672" /></p>
</div>
<div id="decision-tree" class="section level3 hasAnchor" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> Decision Tree<a href="regression-and-decision-tree-basic.html#decision-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar to a regression tree, the goal of a classification tree is to stratifying the predictor space into a number of sub-regions that are more homogeneous. The difference is that a classification tree is used to predict a categorical response rather than a continuous one. For a classification tree, the prediction is the most commonly occurring class of training observations in the region to which an observation belongs. The splitting criteria for a classification tree are different. The most common criteria are entropy and Gini impurity. CART uses Gini impurity and C4.5 uses entropy.</p>
<p>When the predictor is continuous, the splitting process is straightforward. When the predictor is categorical, the process can take different approaches:</p>
<ol style="list-style-type: decimal">
<li>Keep the variable as categorical and group some categories on either side of the split. In this way, the model can make more dynamic splits but must treat the categorical predictor as an ordered set of bits.</li>
<li>Encode the categorical variable to be a set of dummy variables. In this way, the information in the categorical variable is decomposed to independent bits of information. The model considers these dummy variables separately and evaluates for each of these on one split point (because there are only two possible values: 0/1).</li>
</ol>
<p>When fitting tree models, people need to choose the way to treat categorical predictors. If you know some of the categories have higher predictability, then the first approach may be better. In the rest of this section, we will build tree models using the above two approaches and compare them.</p>
<p>Let’s build a classification model to identify the gender of the customer:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="regression-and-decision-tree-basic.html#cb303-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;http://bit.ly/2P5gTw4&quot;</span>)</span>
<span id="cb303-2"><a href="regression-and-decision-tree-basic.html#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use the 10 survey questions as predictors</span></span>
<span id="cb303-3"><a href="regression-and-decision-tree-basic.html#cb303-3" aria-hidden="true" tabindex="-1"></a>trainx1 <span class="ot">&lt;-</span> dat[, <span class="fu">grep</span>(<span class="st">&quot;Q&quot;</span>, <span class="fu">names</span>(dat))]</span>
<span id="cb303-4"><a href="regression-and-decision-tree-basic.html#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add a categorical predictor</span></span>
<span id="cb303-5"><a href="regression-and-decision-tree-basic.html#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use two ways to treat categorical predictor</span></span>
<span id="cb303-6"><a href="regression-and-decision-tree-basic.html#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="co"># trainx1: use approach 1, without encoding</span></span>
<span id="cb303-7"><a href="regression-and-decision-tree-basic.html#cb303-7" aria-hidden="true" tabindex="-1"></a>trainx1<span class="sc">$</span>segment <span class="ot">&lt;-</span> dat<span class="sc">$</span>segment</span>
<span id="cb303-8"><a href="regression-and-decision-tree-basic.html#cb303-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-9"><a href="regression-and-decision-tree-basic.html#cb303-9" aria-hidden="true" tabindex="-1"></a><span class="co"># trainx2: use approach 2, encode it to a set of dummy variables</span></span>
<span id="cb303-10"><a href="regression-and-decision-tree-basic.html#cb303-10" aria-hidden="true" tabindex="-1"></a>dumMod <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(</span>
<span id="cb303-11"><a href="regression-and-decision-tree-basic.html#cb303-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>.,</span>
<span id="cb303-12"><a href="regression-and-decision-tree-basic.html#cb303-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trainx1,</span>
<span id="cb303-13"><a href="regression-and-decision-tree-basic.html#cb303-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the previous variable and the level name</span></span>
<span id="cb303-14"><a href="regression-and-decision-tree-basic.html#cb303-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as the new dummy variable name</span></span>
<span id="cb303-15"><a href="regression-and-decision-tree-basic.html#cb303-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">levelsOnly =</span> F</span>
<span id="cb303-16"><a href="regression-and-decision-tree-basic.html#cb303-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb303-17"><a href="regression-and-decision-tree-basic.html#cb303-17" aria-hidden="true" tabindex="-1"></a>trainx2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(dumMod, trainx1)</span>
<span id="cb303-18"><a href="regression-and-decision-tree-basic.html#cb303-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the response variable is gender</span></span>
<span id="cb303-19"><a href="regression-and-decision-tree-basic.html#cb303-19" aria-hidden="true" tabindex="-1"></a>trainy <span class="ot">&lt;-</span> dat<span class="sc">$</span>gender</span></code></pre></div>
<p>Here we use <code>train()</code> function in <code>caret</code> package to call <code>rpart</code> to build the model. We can compare the model results from the two approaches:</p>
<pre class="pre"><code>CART 

1000 samples
  11 predictor
   2 classes: &#39;Female&#39;, &#39;Male&#39; 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 901, 899, 900, 900, 901, 900, ... 
Resampling results across tuning parameters:

  cp       ROC     Sens    Spec  
  0.00000  0.6937  0.6517  0.6884
  0.00835  0.7026  0.6119  0.7355
  0.01670  0.6852  0.5324  0.8205
  0.02505  0.6803  0.5107  0.8498
  0.03340  0.6803  0.5107  0.8498
  
  ......

  0.23380  0.6341  0.5936  0.6745
  0.24215  0.5556  0.7873  0.3240

ROC was used to select the optimal model using the largest value.
The final value used for the model was cp = 0.00835.</code></pre>
<p>The above keeps the variable as categorical without encoding. Here <code>cp</code> is the complexity parameter. It is used to decide when to stop growing the tree. <code>cp = 0.01</code> means the algorithm only keeps the split that improves the corresponding metric by more than 0.01. Next, let’s encode the categorical variable to be a set of dummy variables and fit the model again:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="regression-and-decision-tree-basic.html#cb305-1" aria-hidden="true" tabindex="-1"></a>rpartTune2 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb305-2"><a href="regression-and-decision-tree-basic.html#cb305-2" aria-hidden="true" tabindex="-1"></a>  trainx2, trainy, <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>,</span>
<span id="cb305-3"><a href="regression-and-decision-tree-basic.html#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">30</span>,</span>
<span id="cb305-4"><a href="regression-and-decision-tree-basic.html#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">&quot;ROC&quot;</span>, </span>
<span id="cb305-5"><a href="regression-and-decision-tree-basic.html#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb305-6"><a href="regression-and-decision-tree-basic.html#cb305-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">summaryFunction =</span> twoClassSummary,</span>
<span id="cb305-7"><a href="regression-and-decision-tree-basic.html#cb305-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">classProbs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb305-8"><a href="regression-and-decision-tree-basic.html#cb305-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">savePredictions =</span> <span class="cn">TRUE</span>)</span>
<span id="cb305-9"><a href="regression-and-decision-tree-basic.html#cb305-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Compare the results of the two approaches.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="regression-and-decision-tree-basic.html#cb306-1" aria-hidden="true" tabindex="-1"></a>rpartRoc <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(<span class="at">response =</span> rpartTune1<span class="sc">$</span>pred<span class="sc">$</span>obs,</span>
<span id="cb306-2"><a href="regression-and-decision-tree-basic.html#cb306-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">predictor =</span> rpartTune1<span class="sc">$</span>pred<span class="sc">$</span>Female,</span>
<span id="cb306-3"><a href="regression-and-decision-tree-basic.html#cb306-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(rpartTune1<span class="sc">$</span>pred<span class="sc">$</span>obs)))</span>
<span id="cb306-4"><a href="regression-and-decision-tree-basic.html#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="regression-and-decision-tree-basic.html#cb306-5" aria-hidden="true" tabindex="-1"></a>rpartFactorRoc <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(<span class="at">response =</span> rpartTune2<span class="sc">$</span>pred<span class="sc">$</span>obs,</span>
<span id="cb306-6"><a href="regression-and-decision-tree-basic.html#cb306-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">predictor =</span> rpartTune2<span class="sc">$</span>pred<span class="sc">$</span>Female,</span>
<span id="cb306-7"><a href="regression-and-decision-tree-basic.html#cb306-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(rpartTune1<span class="sc">$</span>pred<span class="sc">$</span>obs)))</span>
<span id="cb306-8"><a href="regression-and-decision-tree-basic.html#cb306-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-9"><a href="regression-and-decision-tree-basic.html#cb306-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(rpartRoc, </span>
<span id="cb306-10"><a href="regression-and-decision-tree-basic.html#cb306-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, </span>
<span id="cb306-11"><a href="regression-and-decision-tree-basic.html#cb306-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres =</span> <span class="fu">c</span>(.<span class="dv">5</span>),</span>
<span id="cb306-12"><a href="regression-and-decision-tree-basic.html#cb306-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.pch =</span> <span class="dv">3</span>,</span>
<span id="cb306-13"><a href="regression-and-decision-tree-basic.html#cb306-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.pattern =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb306-14"><a href="regression-and-decision-tree-basic.html#cb306-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb306-15"><a href="regression-and-decision-tree-basic.html#cb306-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb306-16"><a href="regression-and-decision-tree-basic.html#cb306-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb306-17"><a href="regression-and-decision-tree-basic.html#cb306-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-18"><a href="regression-and-decision-tree-basic.html#cb306-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(rpartFactorRoc,</span>
<span id="cb306-19"><a href="regression-and-decision-tree-basic.html#cb306-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;s&quot;</span>,</span>
<span id="cb306-20"><a href="regression-and-decision-tree-basic.html#cb306-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb306-21"><a href="regression-and-decision-tree-basic.html#cb306-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres =</span> <span class="fu">c</span>(.<span class="dv">5</span>),</span>
<span id="cb306-22"><a href="regression-and-decision-tree-basic.html#cb306-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.pch =</span> <span class="dv">16</span>, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb306-23"><a href="regression-and-decision-tree-basic.html#cb306-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.pattern =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb306-24"><a href="regression-and-decision-tree-basic.html#cb306-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres.cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb306-25"><a href="regression-and-decision-tree-basic.html#cb306-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-26"><a href="regression-and-decision-tree-basic.html#cb306-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(.<span class="dv">75</span>, .<span class="dv">2</span>,</span>
<span id="cb306-27"><a href="regression-and-decision-tree-basic.html#cb306-27" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;Grouped Categories&quot;</span>, <span class="st">&quot;Independent Categories&quot;</span>),</span>
<span id="cb306-28"><a href="regression-and-decision-tree-basic.html#cb306-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb306-29"><a href="regression-and-decision-tree-basic.html#cb306-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb306-30"><a href="regression-and-decision-tree-basic.html#cb306-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="IDS_files/figure-html/unnamed-chunk-144-1.svg" width="672" /></p>
<p>In this case, the two approaches lead to similar model performance.</p>
<p>Single tree is straightforward and easy to interpret but it has problems:</p>
<ol style="list-style-type: decimal">
<li>Low accuracy</li>
<li>Unstable: little change in the training data leads to very different trees.</li>
</ol>
<p>One way to overcome those is to use an ensemble of trees. In the rest of this chapter, we will introduce three ensemble methods (combine many models’ predictions): bagging tree, random forest, and gradient boosted machine. Those ensemble approaches have significant higher accuracy and stability. However, it comes with the cost of interpretability.</p>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ISLR15" class="csl-entry">
Gareth James, Trevor Hastie, Daniela Witten, and Robert Tibshirani. 2015. <em>An Introduction to Statistical Learning</em>. 6th ed. Springer.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tree-pruning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bagging-tree-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/happyrabbit/IntroDataScience/11-tree.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IDS.pdf", "IDS.epub", "IDS.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
