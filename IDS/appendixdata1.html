<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14.1 Customer Data for Clothing Company | Practitioner’s Guide to Data Science</title>
  <meta name="description" content="Introduction to Data Science" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="14.1 Customer Data for Clothing Company | Practitioner’s Guide to Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://scientistcafe.com/IDS/" />
  
  <meta property="og:description" content="Introduction to Data Science" />
  <meta name="github-repo" content="happyrabbit/IntroDataScience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14.1 Customer Data for Clothing Company | Practitioner’s Guide to Data Science" />
  
  <meta name="twitter:description" content="Introduction to Data Science" />
  

<meta name="author" content="Hui Lin and Ming Li" />


<meta name="date" content="2023-02-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-code-for-data-simulation.html"/>
<link rel="next" href="appendixdata3.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://scientistcafe.com">Homepage</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="goal-of-the-book.html#goal-of-the-book" id="toc-goal-of-the-book">Goal of the Book</a></li>
<li><a href="what-this-book-covers.html#what-this-book-covers" id="toc-what-this-book-covers">What This Book Covers</a></li>
<li><a href="who-this-book-is-for.html#who-this-book-is-for" id="toc-who-this-book-is-for">Who This Book Is For</a></li>
<li><a href="how-to-use-this-book.html#how-to-use-this-book" id="toc-how-to-use-this-book">How to Use This Book</a>
<ul>
<li><a href="how-to-use-this-book.html#what-the-book-assumes" id="toc-what-the-book-assumes">What the Book Assumes</a></li>
<li><a href="how-to-use-this-book.html#how-to-run-r-and-python-code" id="toc-how-to-run-r-and-python-code">How to Run R and Python Code</a></li>
</ul></li>
<li><a href="complementary-reading.html#complementary-reading" id="toc-complementary-reading">Complementary Reading</a></li>
</ul></li>
<li><a href="about-the-authors.html#about-the-authors" id="toc-about-the-authors">About the Authors</a></li>
<li><a href="introduction.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="a-brief-history-of-data-science.html#a-brief-history-of-data-science" id="toc-a-brief-history-of-data-science"><span class="toc-section-number">1.1</span> A Brief History of Data Science</a></li>
<li><a href="data-science-role-and-skill-tracks.html#data-science-role-and-skill-tracks" id="toc-data-science-role-and-skill-tracks"><span class="toc-section-number">1.2</span> Data Science Role and Skill Tracks</a>
<ul>
<li><a href="data-science-role-and-skill-tracks.html#engineering" id="toc-engineering"><span class="toc-section-number">1.2.1</span> Engineering</a></li>
<li><a href="data-science-role-and-skill-tracks.html#analysis" id="toc-analysis"><span class="toc-section-number">1.2.2</span> Analysis</a></li>
<li><a href="data-science-role-and-skill-tracks.html#modelinginference" id="toc-modelinginference"><span class="toc-section-number">1.2.3</span> Modeling/Inference</a></li>
</ul></li>
<li><a href="what-kind-of-questions-can-data-science-solve.html#what-kind-of-questions-can-data-science-solve" id="toc-what-kind-of-questions-can-data-science-solve"><span class="toc-section-number">1.3</span> What Kind of Questions Can Data Science Solve?</a>
<ul>
<li><a href="what-kind-of-questions-can-data-science-solve.html#prerequisites" id="toc-prerequisites"><span class="toc-section-number">1.3.1</span> Prerequisites</a></li>
<li><a href="what-kind-of-questions-can-data-science-solve.html#problem-type" id="toc-problem-type"><span class="toc-section-number">1.3.2</span> Problem Type</a></li>
</ul></li>
<li><a href="structure-of-data-science-team.html#structure-of-data-science-team" id="toc-structure-of-data-science-team"><span class="toc-section-number">1.4</span> Structure of Data Science Team</a></li>
<li><a href="data-science-roles.html#data-science-roles" id="toc-data-science-roles"><span class="toc-section-number">1.5</span> Data Science Roles</a></li>
</ul></li>
<li><a href="SoftSkillsforDataScientists.html#SoftSkillsforDataScientists" id="toc-SoftSkillsforDataScientists"><span class="toc-section-number">2</span> Soft Skills for Data Scientists</a>
<ul>
<li><a href="comparison-between-statistician-and-data-scientist.html#comparison-between-statistician-and-data-scientist" id="toc-comparison-between-statistician-and-data-scientist"><span class="toc-section-number">2.1</span> Comparison between Statistician and Data Scientist</a></li>
<li><a href="beyond-data-and-analytics.html#beyond-data-and-analytics" id="toc-beyond-data-and-analytics"><span class="toc-section-number">2.2</span> Beyond Data and Analytics</a></li>
<li><a href="three-pillars-of-knowledge.html#three-pillars-of-knowledge" id="toc-three-pillars-of-knowledge"><span class="toc-section-number">2.3</span> Three Pillars of Knowledge</a></li>
<li><a href="data-science-project-cycle.html#data-science-project-cycle" id="toc-data-science-project-cycle"><span class="toc-section-number">2.4</span> Data Science Project Cycle</a>
<ul>
<li><a href="data-science-project-cycle.html#types-of-data-science-projects" id="toc-types-of-data-science-projects"><span class="toc-section-number">2.4.1</span> Types of Data Science Projects</a></li>
<li><a href="data-science-project-cycle.html#ProblemFormulationandProjectPlanningStage" id="toc-ProblemFormulationandProjectPlanningStage"><span class="toc-section-number">2.4.2</span> Problem Formulation and Project Planning Stage</a></li>
<li><a href="data-science-project-cycle.html#project-modeling-stage" id="toc-project-modeling-stage"><span class="toc-section-number">2.4.3</span> Project Modeling Stage</a></li>
<li><a href="data-science-project-cycle.html#ModelImplementationandPostProductionStage" id="toc-ModelImplementationandPostProductionStage"><span class="toc-section-number">2.4.4</span> Model Implementation and Post Production Stage</a></li>
<li><a href="data-science-project-cycle.html#ProjectCycleSummary" id="toc-ProjectCycleSummary"><span class="toc-section-number">2.4.5</span> Project Cycle Summary</a></li>
</ul></li>
<li><a href="common-mistakes-in-data-science.html#common-mistakes-in-data-science" id="toc-common-mistakes-in-data-science"><span class="toc-section-number">2.5</span> Common Mistakes in Data Science</a>
<ul>
<li><a href="common-mistakes-in-data-science.html#problem-formulation-stage" id="toc-problem-formulation-stage"><span class="toc-section-number">2.5.1</span> Problem Formulation Stage</a></li>
<li><a href="common-mistakes-in-data-science.html#project-planning-stage" id="toc-project-planning-stage"><span class="toc-section-number">2.5.2</span> Project Planning Stage</a></li>
<li><a href="common-mistakes-in-data-science.html#project-modeling-stage-1" id="toc-project-modeling-stage-1"><span class="toc-section-number">2.5.3</span> Project Modeling Stage</a></li>
<li><a href="common-mistakes-in-data-science.html#model-implementation-and-post-production-stage" id="toc-model-implementation-and-post-production-stage"><span class="toc-section-number">2.5.4</span> Model Implementation and Post Production Stage</a></li>
<li><a href="common-mistakes-in-data-science.html#summary-of-common-mistakes" id="toc-summary-of-common-mistakes"><span class="toc-section-number">2.5.5</span> Summary of Common Mistakes</a></li>
</ul></li>
</ul></li>
<li><a href="introduction-to-the-data.html#introduction-to-the-data" id="toc-introduction-to-the-data"><span class="toc-section-number">3</span> Introduction to The Data</a>
<ul>
<li><a href="customer-data-for-a-clothing-company.html#customer-data-for-a-clothing-company" id="toc-customer-data-for-a-clothing-company"><span class="toc-section-number">3.1</span> Customer Data for A Clothing Company</a></li>
<li><a href="swinediseasedata.html#swinediseasedata" id="toc-swinediseasedata"><span class="toc-section-number">3.2</span> Swine Disease Breakout Data</a></li>
<li><a href="mnist-dataset.html#mnist-dataset" id="toc-mnist-dataset"><span class="toc-section-number">3.3</span> MNIST Dataset</a></li>
<li><a href="imdb-dataset.html#imdb-dataset" id="toc-imdb-dataset"><span class="toc-section-number">3.4</span> IMDB Dataset</a></li>
</ul></li>
<li><a href="bigdatacloudplatform.html#bigdatacloudplatform" id="toc-bigdatacloudplatform"><span class="toc-section-number">4</span> Big Data Cloud Platform</a>
<ul>
<li><a href="power-of-cluster-of-computers.html#power-of-cluster-of-computers" id="toc-power-of-cluster-of-computers"><span class="toc-section-number">4.1</span> Power of Cluster of Computers</a></li>
<li><a href="evolution-of-cluster-computing.html#evolution-of-cluster-computing" id="toc-evolution-of-cluster-computing"><span class="toc-section-number">4.2</span> Evolution of Cluster Computing</a>
<ul>
<li><a href="evolution-of-cluster-computing.html#hadoop" id="toc-hadoop"><span class="toc-section-number">4.2.1</span> Hadoop</a></li>
<li><a href="evolution-of-cluster-computing.html#spark" id="toc-spark"><span class="toc-section-number">4.2.2</span> Spark</a></li>
</ul></li>
<li><a href="CloudEnvironment.html#CloudEnvironment" id="toc-CloudEnvironment"><span class="toc-section-number">4.3</span> Introduction of Cloud Environment</a>
<ul>
<li><a href="CloudEnvironment.html#open-account-and-create-a-cluster" id="toc-open-account-and-create-a-cluster"><span class="toc-section-number">4.3.1</span> Open Account and Create a Cluster</a></li>
<li><a href="CloudEnvironment.html#r-notebook" id="toc-r-notebook"><span class="toc-section-number">4.3.2</span> R Notebook</a></li>
<li><a href="CloudEnvironment.html#markdown-cells" id="toc-markdown-cells"><span class="toc-section-number">4.3.3</span> Markdown Cells</a></li>
</ul></li>
<li><a href="leveragesparkr.html#leveragesparkr" id="toc-leveragesparkr"><span class="toc-section-number">4.4</span> Leverage Spark Using R Notebook</a></li>
<li><a href="databases-and-sql.html#databases-and-sql" id="toc-databases-and-sql"><span class="toc-section-number">4.5</span> Databases and SQL</a>
<ul>
<li><a href="databases-and-sql.html#history" id="toc-history"><span class="toc-section-number">4.5.1</span> History</a></li>
<li><a href="databases-and-sql.html#database-table-and-view" id="toc-database-table-and-view"><span class="toc-section-number">4.5.2</span> Database, Table and View</a></li>
<li><a href="databases-and-sql.html#basic-sql-statement" id="toc-basic-sql-statement"><span class="toc-section-number">4.5.3</span> Basic SQL Statement</a></li>
<li><a href="databases-and-sql.html#advanced-topics-in-database" id="toc-advanced-topics-in-database"><span class="toc-section-number">4.5.4</span> Advanced Topics in Database</a></li>
</ul></li>
</ul></li>
<li><a href="datapreprocessing.html#datapreprocessing" id="toc-datapreprocessing"><span class="toc-section-number">5</span> Data Pre-processing</a>
<ul>
<li><a href="data-cleaning.html#data-cleaning" id="toc-data-cleaning"><span class="toc-section-number">5.1</span> Data Cleaning</a></li>
<li><a href="missing-values.html#missing-values" id="toc-missing-values"><span class="toc-section-number">5.2</span> Missing Values</a>
<ul>
<li><a href="missing-values.html#impute-missing-values-with-medianmode" id="toc-impute-missing-values-with-medianmode"><span class="toc-section-number">5.2.1</span> Impute missing values with median/mode</a></li>
<li><a href="missing-values.html#k-nearest-neighbors" id="toc-k-nearest-neighbors"><span class="toc-section-number">5.2.2</span> K-nearest neighbors</a></li>
<li><a href="missing-values.html#bagging-tree" id="toc-bagging-tree"><span class="toc-section-number">5.2.3</span> Bagging Tree</a></li>
</ul></li>
<li><a href="centering-and-scaling.html#centering-and-scaling" id="toc-centering-and-scaling"><span class="toc-section-number">5.3</span> Centering and Scaling</a></li>
<li><a href="resolve-skewness.html#resolve-skewness" id="toc-resolve-skewness"><span class="toc-section-number">5.4</span> Resolve Skewness</a></li>
<li><a href="outliers.html#outliers" id="toc-outliers"><span class="toc-section-number">5.5</span> Resolve Outliers</a></li>
<li><a href="collinearity.html#collinearity" id="toc-collinearity"><span class="toc-section-number">5.6</span> Collinearity</a></li>
<li><a href="sparse-variables.html#sparse-variables" id="toc-sparse-variables"><span class="toc-section-number">5.7</span> Sparse Variables</a></li>
<li><a href="re-encode-dummy-variables.html#re-encode-dummy-variables" id="toc-re-encode-dummy-variables"><span class="toc-section-number">5.8</span> Re-encode Dummy Variables</a></li>
</ul></li>
<li><a href="datawrangline.html#datawrangline" id="toc-datawrangline"><span class="toc-section-number">6</span> Data Wrangling</a>
<ul>
<li><a href="summarize-data.html#summarize-data" id="toc-summarize-data"><span class="toc-section-number">6.1</span> Summarize Data</a>
<ul>
<li><a href="summarize-data.html#dplyr-package" id="toc-dplyr-package"><span class="toc-section-number">6.1.1</span> <code>dplyr</code> package</a></li>
<li><a href="summarize-data.html#applyfamilyinbaser" id="toc-applyfamilyinbaser"><span class="toc-section-number">6.1.2</span> <code>apply()</code>, <code>lapply()</code> and <code>sapply()</code> in base R</a></li>
</ul></li>
<li><a href="tidy-and-reshape-data.html#tidy-and-reshape-data" id="toc-tidy-and-reshape-data"><span class="toc-section-number">6.2</span> Tidy and Reshape Data</a></li>
</ul></li>
<li><a href="modeltuningstrategy.html#modeltuningstrategy" id="toc-modeltuningstrategy"><span class="toc-section-number">7</span> Model Tuning Strategy</a>
<ul>
<li><a href="vbtradeoff.html#vbtradeoff" id="toc-vbtradeoff"><span class="toc-section-number">7.1</span> Variance-Bias Trade-Off</a></li>
<li><a href="datasplittingresampling.html#datasplittingresampling" id="toc-datasplittingresampling"><span class="toc-section-number">7.2</span> Data Splitting and Resampling</a>
<ul>
<li><a href="datasplittingresampling.html#datasplitting" id="toc-datasplitting"><span class="toc-section-number">7.2.1</span> Data Splitting</a></li>
<li><a href="datasplittingresampling.html#resampling" id="toc-resampling"><span class="toc-section-number">7.2.2</span> Resampling</a></li>
</ul></li>
</ul></li>
<li><a href="measuring-performance.html#measuring-performance" id="toc-measuring-performance"><span class="toc-section-number">8</span> Measuring Performance</a>
<ul>
<li><a href="regression-model-performance.html#regression-model-performance" id="toc-regression-model-performance"><span class="toc-section-number">8.1</span> Regression Model Performance</a></li>
<li><a href="classification-model-performance.html#classification-model-performance" id="toc-classification-model-performance"><span class="toc-section-number">8.2</span> Classification Model Performance</a>
<ul>
<li><a href="classification-model-performance.html#confusion-matrix" id="toc-confusion-matrix"><span class="toc-section-number">8.2.1</span> Confusion Matrix</a></li>
<li><a href="classification-model-performance.html#kappa-statistic" id="toc-kappa-statistic"><span class="toc-section-number">8.2.2</span> Kappa Statistic</a></li>
<li><a href="classification-model-performance.html#roc" id="toc-roc"><span class="toc-section-number">8.2.3</span> ROC</a></li>
<li><a href="classification-model-performance.html#gain-and-lift-charts" id="toc-gain-and-lift-charts"><span class="toc-section-number">8.2.4</span> Gain and Lift Charts</a></li>
</ul></li>
</ul></li>
<li><a href="regression-models.html#regression-models" id="toc-regression-models"><span class="toc-section-number">9</span> Regression Models</a>
<ul>
<li><a href="ordinary-least-square.html#ordinary-least-square" id="toc-ordinary-least-square"><span class="toc-section-number">9.1</span> Ordinary Least Square</a>
<ul>
<li><a href="ordinary-least-square.html#the-magic-p-value" id="toc-the-magic-p-value"><span class="toc-section-number">9.1.1</span> The Magic P-value</a></li>
<li><a href="ordinary-least-square.html#diagnostics-for-linear-regression" id="toc-diagnostics-for-linear-regression"><span class="toc-section-number">9.1.2</span> Diagnostics for Linear Regression</a></li>
</ul></li>
<li><a href="principal-component-regression-and-partial-least-square.html#principal-component-regression-and-partial-least-square" id="toc-principal-component-regression-and-partial-least-square"><span class="toc-section-number">9.2</span> Principal Component Regression and Partial Least Square</a></li>
</ul></li>
<li><a href="regularization-methods.html#regularization-methods" id="toc-regularization-methods"><span class="toc-section-number">10</span> Regularization Methods</a>
<ul>
<li><a href="ridge-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">10.1</span> Ridge Regression</a></li>
<li><a href="lasso.html#lasso" id="toc-lasso"><span class="toc-section-number">10.2</span> LASSO</a></li>
<li><a href="elastic-net.html#elastic-net" id="toc-elastic-net"><span class="toc-section-number">10.3</span> Elastic Net</a></li>
<li><a href="penalized-generalized-linear-model.html#penalized-generalized-linear-model" id="toc-penalized-generalized-linear-model"><span class="toc-section-number">10.4</span> Penalized Generalized Linear Model</a>
<ul>
<li><a href="penalized-generalized-linear-model.html#introduction-to-glmnet-package" id="toc-introduction-to-glmnet-package"><span class="toc-section-number">10.4.1</span> Introduction to <code>glmnet</code> package</a></li>
<li><a href="penalized-generalized-linear-model.html#penalized-logistic-regression" id="toc-penalized-logistic-regression"><span class="toc-section-number">10.4.2</span> Penalized logistic regression</a></li>
</ul></li>
</ul></li>
<li><a href="treemodel.html#treemodel" id="toc-treemodel"><span class="toc-section-number">11</span> Tree-Based Methods</a>
<ul>
<li><a href="tree-basics.html#tree-basics" id="toc-tree-basics"><span class="toc-section-number">11.1</span> Tree Basics</a></li>
<li><a href="splitting-criteria.html#splitting-criteria" id="toc-splitting-criteria"><span class="toc-section-number">11.2</span> Splitting Criteria</a>
<ul>
<li><a href="splitting-criteria.html#gini-impurity" id="toc-gini-impurity"><span class="toc-section-number">11.2.1</span> Gini impurity</a></li>
<li><a href="splitting-criteria.html#information-gain-ig" id="toc-information-gain-ig"><span class="toc-section-number">11.2.2</span> Information Gain (IG)</a></li>
<li><a href="splitting-criteria.html#information-gain-ratio-igr" id="toc-information-gain-ratio-igr"><span class="toc-section-number">11.2.3</span> Information Gain Ratio (IGR)</a></li>
<li><a href="splitting-criteria.html#sum-of-squared-error-sse" id="toc-sum-of-squared-error-sse"><span class="toc-section-number">11.2.4</span> Sum of Squared Error (SSE)</a></li>
</ul></li>
<li><a href="tree-pruning.html#tree-pruning" id="toc-tree-pruning"><span class="toc-section-number">11.3</span> Tree Pruning</a></li>
<li><a href="regression-and-decision-tree-basic.html#regression-and-decision-tree-basic" id="toc-regression-and-decision-tree-basic"><span class="toc-section-number">11.4</span> Regression and Decision Tree Basic</a>
<ul>
<li><a href="regression-and-decision-tree-basic.html#regression-tree" id="toc-regression-tree"><span class="toc-section-number">11.4.1</span> Regression Tree</a></li>
<li><a href="regression-and-decision-tree-basic.html#decision-tree" id="toc-decision-tree"><span class="toc-section-number">11.4.2</span> Decision Tree</a></li>
</ul></li>
<li><a href="bagging-tree-1.html#bagging-tree-1" id="toc-bagging-tree-1"><span class="toc-section-number">11.5</span> Bagging Tree</a></li>
<li><a href="random-forest.html#random-forest" id="toc-random-forest"><span class="toc-section-number">11.6</span> Random Forest</a></li>
<li><a href="gradient-boosted-machine.html#gradient-boosted-machine" id="toc-gradient-boosted-machine"><span class="toc-section-number">11.7</span> Gradient Boosted Machine</a>
<ul>
<li><a href="gradient-boosted-machine.html#adaptive-boosting" id="toc-adaptive-boosting"><span class="toc-section-number">11.7.1</span> Adaptive Boosting</a></li>
<li><a href="gradient-boosted-machine.html#stochastic-gradient-boosting" id="toc-stochastic-gradient-boosting"><span class="toc-section-number">11.7.2</span> Stochastic Gradient Boosting</a></li>
</ul></li>
</ul></li>
<li><a href="deeplearning.html#deeplearning" id="toc-deeplearning"><span class="toc-section-number">12</span> Deep Learning</a>
<ul>
<li><a href="feedforward-neural-network.html#feedforward-neural-network" id="toc-feedforward-neural-network"><span class="toc-section-number">12.1</span> Feedforward Neural Network</a>
<ul>
<li><a href="feedforward-neural-network.html#logisticregasneuralnetwork" id="toc-logisticregasneuralnetwork"><span class="toc-section-number">12.1.1</span> Logistic Regression as Neural Network</a></li>
<li><a href="feedforward-neural-network.html#stochastic-gradient-descent" id="toc-stochastic-gradient-descent"><span class="toc-section-number">12.1.2</span> Stochastic Gradient Descent</a></li>
<li><a href="feedforward-neural-network.html#deepneuralnetwork" id="toc-deepneuralnetwork"><span class="toc-section-number">12.1.3</span> Deep Neural Network</a></li>
<li><a href="feedforward-neural-network.html#activationfunction" id="toc-activationfunction"><span class="toc-section-number">12.1.4</span> Activation Function</a></li>
<li><a href="feedforward-neural-network.html#optimization" id="toc-optimization"><span class="toc-section-number">12.1.5</span> Optimization</a></li>
<li><a href="feedforward-neural-network.html#deal-with-overfitting" id="toc-deal-with-overfitting"><span class="toc-section-number">12.1.6</span> Deal with Overfitting</a></li>
<li><a href="feedforward-neural-network.html#ffnnexample" id="toc-ffnnexample"><span class="toc-section-number">12.1.7</span> Image Recognition Using FFNN</a></li>
</ul></li>
<li><a href="convolutional-neural-network.html#convolutional-neural-network" id="toc-convolutional-neural-network"><span class="toc-section-number">12.2</span> Convolutional Neural Network</a>
<ul>
<li><a href="convolutional-neural-network.html#convolution-layer" id="toc-convolution-layer"><span class="toc-section-number">12.2.1</span> Convolution Layer</a></li>
<li><a href="convolutional-neural-network.html#padding-layer" id="toc-padding-layer"><span class="toc-section-number">12.2.2</span> Padding Layer</a></li>
<li><a href="convolutional-neural-network.html#pooling-layer" id="toc-pooling-layer"><span class="toc-section-number">12.2.3</span> Pooling Layer</a></li>
<li><a href="convolutional-neural-network.html#convolution-over-volume" id="toc-convolution-over-volume"><span class="toc-section-number">12.2.4</span> Convolution Over Volume</a></li>
<li><a href="convolutional-neural-network.html#cnnexample" id="toc-cnnexample"><span class="toc-section-number">12.2.5</span> Image Recognition Using CNN</a></li>
</ul></li>
<li><a href="recurrent-neural-network.html#recurrent-neural-network" id="toc-recurrent-neural-network"><span class="toc-section-number">12.3</span> Recurrent Neural Network</a>
<ul>
<li><a href="recurrent-neural-network.html#rnn-model" id="toc-rnn-model"><span class="toc-section-number">12.3.1</span> RNN Model</a></li>
<li><a href="recurrent-neural-network.html#lstm" id="toc-lstm"><span class="toc-section-number">12.3.2</span> Long Short Term Memory</a></li>
<li><a href="recurrent-neural-network.html#embedding" id="toc-embedding"><span class="toc-section-number">12.3.3</span> Word Embedding</a></li>
<li><a href="recurrent-neural-network.html#rnnexample" id="toc-rnnexample"><span class="toc-section-number">12.3.4</span> Sentiment Analysis Using RNN</a></li>
</ul></li>
</ul></li>
<li><a href="appendix.html#appendix" id="toc-appendix">Appendix</a></li>
<li><a href="largelocaldata.html#largelocaldata" id="toc-largelocaldata"><span class="toc-section-number">13</span> Handling Large Local Data</a>
<ul>
<li><a href="readr.html#readr" id="toc-readr"><span class="toc-section-number">13.1</span> <code>readr</code></a></li>
<li><a href="data.table-enhanced-data.html#data.table-enhanced-data.frame" id="toc-data.table-enhanced-data.frame"><span class="toc-section-number">13.2</span> <code>data.table</code>— enhanced <code>data.frame</code></a></li>
</ul></li>
<li><a href="r-code-for-data-simulation.html#r-code-for-data-simulation" id="toc-r-code-for-data-simulation"><span class="toc-section-number">14</span> R code for data simulation</a>
<ul>
<li><a href="appendixdata1.html#appendixdata1" id="toc-appendixdata1"><span class="toc-section-number">14.1</span> Customer Data for Clothing Company</a></li>
<li><a href="appendixdata3.html#appendixdata3" id="toc-appendixdata3"><span class="toc-section-number">14.2</span> Swine Disease Breakout Data</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practitioner’s Guide to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendixdata1" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Customer Data for Clothing Company<a href="appendixdata1.html#appendixdata1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simulation is not very straightforward and we will break it into three parts:</p>
<ol style="list-style-type: decimal">
<li>Define data structure: variable names, variable distribution, customer segment names, segment size</li>
<li>Variable distribution parameters: mean and variance</li>
<li>Iterate across segments and variables. Simulate data according to specific parameters assigned</li>
</ol>
<p>By organizing code this way, it makes easy for us to change specific parts of the simulation. For example, if we want to change the distribution of one variable, we can just change the corresponding part of the code.</p>
<p>Here is code to define data structure:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="appendixdata1.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a random number seed to </span></span>
<span id="cb481-2"><a href="appendixdata1.html#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make the process repeatable</span></span>
<span id="cb481-3"><a href="appendixdata1.html#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb481-4"><a href="appendixdata1.html#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of observations</span></span>
<span id="cb481-5"><a href="appendixdata1.html#cb481-5" aria-hidden="true" tabindex="-1"></a>ncust <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb481-6"><a href="appendixdata1.html#cb481-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frmae for simulated data</span></span>
<span id="cb481-7"><a href="appendixdata1.html#cb481-7" aria-hidden="true" tabindex="-1"></a>seg_dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>ncust)))</span>
<span id="cb481-8"><a href="appendixdata1.html#cb481-8" aria-hidden="true" tabindex="-1"></a><span class="co"># assign the variable names</span></span>
<span id="cb481-9"><a href="appendixdata1.html#cb481-9" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;income&quot;</span>, <span class="st">&quot;house&quot;</span>, <span class="st">&quot;store_exp&quot;</span>, </span>
<span id="cb481-10"><a href="appendixdata1.html#cb481-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;online_exp&quot;</span>, <span class="st">&quot;store_trans&quot;</span>, <span class="st">&quot;online_trans&quot;</span>)</span>
<span id="cb481-11"><a href="appendixdata1.html#cb481-11" aria-hidden="true" tabindex="-1"></a><span class="co"># assign distribution for each variable</span></span>
<span id="cb481-12"><a href="appendixdata1.html#cb481-12" aria-hidden="true" tabindex="-1"></a>vartype <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;binom&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;binom&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;norm&quot;</span>, </span>
<span id="cb481-13"><a href="appendixdata1.html#cb481-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;pois&quot;</span>, <span class="st">&quot;pois&quot;</span>)</span>
<span id="cb481-14"><a href="appendixdata1.html#cb481-14" aria-hidden="true" tabindex="-1"></a><span class="co"># names of 4 segments</span></span>
<span id="cb481-15"><a href="appendixdata1.html#cb481-15" aria-hidden="true" tabindex="-1"></a>group_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Price&quot;</span>, <span class="st">&quot;Conspicuous&quot;</span>, <span class="st">&quot;Quality&quot;</span>, <span class="st">&quot;Style&quot;</span>)</span>
<span id="cb481-16"><a href="appendixdata1.html#cb481-16" aria-hidden="true" tabindex="-1"></a><span class="co"># size of each segments</span></span>
<span id="cb481-17"><a href="appendixdata1.html#cb481-17" aria-hidden="true" tabindex="-1"></a>group_size <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">250</span>, <span class="dv">200</span>, <span class="dv">200</span>, <span class="dv">350</span>)</span></code></pre></div>
<p>The next step is to define variable distribution parameters. There are 4 segments of customers and 8 parameters. Different segments correspond to different parameters. Let’s store the parameters in a 4×8 matrix:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="appendixdata1.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix for mean</span></span>
<span id="cb482-2"><a href="appendixdata1.html#cb482-2" aria-hidden="true" tabindex="-1"></a>mus <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(</span>
<span id="cb482-3"><a href="appendixdata1.html#cb482-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Price</span></span>
<span id="cb482-4"><a href="appendixdata1.html#cb482-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">60</span>, <span class="fl">0.5</span>, <span class="dv">120000</span>,<span class="fl">0.9</span>, <span class="dv">500</span>,<span class="dv">200</span>,<span class="dv">5</span>,<span class="dv">2</span>,</span>
<span id="cb482-5"><a href="appendixdata1.html#cb482-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Conspicuous</span></span>
<span id="cb482-6"><a href="appendixdata1.html#cb482-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">40</span>, <span class="fl">0.7</span>, <span class="dv">200000</span>,<span class="fl">0.9</span>, <span class="dv">5000</span>,<span class="dv">5000</span>,<span class="dv">10</span>,<span class="dv">10</span>,</span>
<span id="cb482-7"><a href="appendixdata1.html#cb482-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Quality</span></span>
<span id="cb482-8"><a href="appendixdata1.html#cb482-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">36</span>, <span class="fl">0.5</span>, <span class="dv">70000</span>, <span class="fl">0.4</span>, <span class="dv">300</span>, <span class="dv">2000</span>,<span class="dv">2</span>,<span class="dv">15</span>,</span>
<span id="cb482-9"><a href="appendixdata1.html#cb482-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Style</span></span>
<span id="cb482-10"><a href="appendixdata1.html#cb482-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span>, <span class="fl">0.2</span>, <span class="dv">90000</span>, <span class="fl">0.2</span>, <span class="dv">200</span>, <span class="dv">2000</span>,<span class="dv">2</span>,<span class="dv">20</span>), </span>
<span id="cb482-11"><a href="appendixdata1.html#cb482-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="fu">length</span>(vars), <span class="at">byrow=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="appendixdata1.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix for variance</span></span>
<span id="cb483-2"><a href="appendixdata1.html#cb483-2" aria-hidden="true" tabindex="-1"></a>sds<span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(</span>
<span id="cb483-3"><a href="appendixdata1.html#cb483-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Price</span></span>
<span id="cb483-4"><a href="appendixdata1.html#cb483-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>,<span class="cn">NA</span>,<span class="dv">8000</span>,<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">50</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span>
<span id="cb483-5"><a href="appendixdata1.html#cb483-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Conspicuous</span></span>
<span id="cb483-6"><a href="appendixdata1.html#cb483-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>,<span class="cn">NA</span>,<span class="dv">50000</span>,<span class="cn">NA</span>,<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span>
<span id="cb483-7"><a href="appendixdata1.html#cb483-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Quality</span></span>
<span id="cb483-8"><a href="appendixdata1.html#cb483-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>,<span class="cn">NA</span>,<span class="dv">10000</span>,<span class="cn">NA</span>,<span class="dv">50</span>,<span class="dv">200</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span>
<span id="cb483-9"><a href="appendixdata1.html#cb483-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Style</span></span>
<span id="cb483-10"><a href="appendixdata1.html#cb483-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>,<span class="cn">NA</span>,<span class="dv">5000</span>,<span class="cn">NA</span>,<span class="dv">10</span>,<span class="dv">500</span>,<span class="cn">NA</span>,<span class="cn">NA</span>), </span>
<span id="cb483-11"><a href="appendixdata1.html#cb483-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="fu">length</span>(vars), <span class="at">byrow=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Now we are ready to simulate data using the parameters defined above:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="appendixdata1.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate non-survey data</span></span>
<span id="cb484-2"><a href="appendixdata1.html#cb484-2" aria-hidden="true" tabindex="-1"></a>sim.dat <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb484-3"><a href="appendixdata1.html#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2016</span>)</span>
<span id="cb484-4"><a href="appendixdata1.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop on customer segment (i)</span></span>
<span id="cb484-5"><a href="appendixdata1.html#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(group_name)) {</span>
<span id="cb484-6"><a href="appendixdata1.html#cb484-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb484-7"><a href="appendixdata1.html#cb484-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add this line in order to moniter the process</span></span>
<span id="cb484-8"><a href="appendixdata1.html#cb484-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(i, group_name[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb484-9"><a href="appendixdata1.html#cb484-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb484-10"><a href="appendixdata1.html#cb484-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create an empty matrix to store relevent data</span></span>
<span id="cb484-11"><a href="appendixdata1.html#cb484-11" aria-hidden="true" tabindex="-1"></a>    seg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> group_size[i], </span>
<span id="cb484-12"><a href="appendixdata1.html#cb484-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="fu">length</span>(vars)))</span>
<span id="cb484-13"><a href="appendixdata1.html#cb484-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb484-14"><a href="appendixdata1.html#cb484-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate data within segment i</span></span>
<span id="cb484-15"><a href="appendixdata1.html#cb484-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(vars)) {</span>
<span id="cb484-16"><a href="appendixdata1.html#cb484-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb484-17"><a href="appendixdata1.html#cb484-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># loop on every variable (j)</span></span>
<span id="cb484-18"><a href="appendixdata1.html#cb484-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (vartype[j] <span class="sc">==</span> <span class="st">&quot;norm&quot;</span>) {</span>
<span id="cb484-19"><a href="appendixdata1.html#cb484-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate normal distribution</span></span>
<span id="cb484-20"><a href="appendixdata1.html#cb484-20" aria-hidden="true" tabindex="-1"></a>            seg[, j] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(group_size[i], <span class="at">mean =</span> mus[i, </span>
<span id="cb484-21"><a href="appendixdata1.html#cb484-21" aria-hidden="true" tabindex="-1"></a>                j], <span class="at">sd =</span> sds[i, j])</span>
<span id="cb484-22"><a href="appendixdata1.html#cb484-22" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (vartype[j] <span class="sc">==</span> <span class="st">&quot;pois&quot;</span>) {</span>
<span id="cb484-23"><a href="appendixdata1.html#cb484-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate poisson distribution</span></span>
<span id="cb484-24"><a href="appendixdata1.html#cb484-24" aria-hidden="true" tabindex="-1"></a>            seg[, j] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(group_size[i], <span class="at">lambda =</span> mus[i, </span>
<span id="cb484-25"><a href="appendixdata1.html#cb484-25" aria-hidden="true" tabindex="-1"></a>                j])</span>
<span id="cb484-26"><a href="appendixdata1.html#cb484-26" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (vartype[j] <span class="sc">==</span> <span class="st">&quot;binom&quot;</span>) {</span>
<span id="cb484-27"><a href="appendixdata1.html#cb484-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate binomial distribution</span></span>
<span id="cb484-28"><a href="appendixdata1.html#cb484-28" aria-hidden="true" tabindex="-1"></a>            seg[, j] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(group_size[i], <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb484-29"><a href="appendixdata1.html#cb484-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">prob =</span> mus[i, j])</span>
<span id="cb484-30"><a href="appendixdata1.html#cb484-30" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb484-31"><a href="appendixdata1.html#cb484-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the distribution name is not one of the above, stop</span></span>
<span id="cb484-32"><a href="appendixdata1.html#cb484-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and return a message</span></span>
<span id="cb484-33"><a href="appendixdata1.html#cb484-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Don&#39;t have type:&quot;</span>, vartype[j])</span>
<span id="cb484-34"><a href="appendixdata1.html#cb484-34" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb484-35"><a href="appendixdata1.html#cb484-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb484-36"><a href="appendixdata1.html#cb484-36" aria-hidden="true" tabindex="-1"></a>    sim.dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim.dat, seg)</span>
<span id="cb484-37"><a href="appendixdata1.html#cb484-37" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s edit the data we just simulated a little by adding tags to 0/1 binomial variables:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="appendixdata1.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign variable names</span></span>
<span id="cb485-2"><a href="appendixdata1.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sim.dat) <span class="ot">&lt;-</span> vars</span>
<span id="cb485-3"><a href="appendixdata1.html#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="co"># assign factor levels to segment variable</span></span>
<span id="cb485-4"><a href="appendixdata1.html#cb485-4" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>segment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(group_name, <span class="at">times =</span> group_size))</span>
<span id="cb485-5"><a href="appendixdata1.html#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="co"># recode gender and house variable</span></span>
<span id="cb485-6"><a href="appendixdata1.html#cb485-6" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(sim.dat<span class="sc">$</span>gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, </span>
<span id="cb485-7"><a href="appendixdata1.html#cb485-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Male&quot;</span>))</span>
<span id="cb485-8"><a href="appendixdata1.html#cb485-8" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>house <span class="ot">&lt;-</span> <span class="fu">factor</span>(sim.dat<span class="sc">$</span>house, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, </span>
<span id="cb485-9"><a href="appendixdata1.html#cb485-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb485-10"><a href="appendixdata1.html#cb485-10" aria-hidden="true" tabindex="-1"></a><span class="co"># store_trans and online_trans are at least 1</span></span>
<span id="cb485-11"><a href="appendixdata1.html#cb485-11" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>store_trans <span class="ot">&lt;-</span> sim.dat<span class="sc">$</span>store_trans <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb485-12"><a href="appendixdata1.html#cb485-12" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>online_trans <span class="ot">&lt;-</span> sim.dat<span class="sc">$</span>online_trans <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb485-13"><a href="appendixdata1.html#cb485-13" aria-hidden="true" tabindex="-1"></a><span class="co"># age is integer</span></span>
<span id="cb485-14"><a href="appendixdata1.html#cb485-14" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">floor</span>(sim.dat<span class="sc">$</span>age)</span></code></pre></div>
<p>In the real world, the data always includes some noise such as missing, wrong imputation. So we will add some noise to the data:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="appendixdata1.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add missing values</span></span>
<span id="cb486-2"><a href="appendixdata1.html#cb486-2" aria-hidden="true" tabindex="-1"></a>idxm <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(<span class="fu">rbinom</span>(ncust, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> sim.dat<span class="sc">$</span>age<span class="sc">/</span><span class="dv">200</span>))</span>
<span id="cb486-3"><a href="appendixdata1.html#cb486-3" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>income[idxm] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb486-4"><a href="appendixdata1.html#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add wrong imputations and outliers</span></span>
<span id="cb486-5"><a href="appendixdata1.html#cb486-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb486-6"><a href="appendixdata1.html#cb486-6" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>ncust, <span class="dv">5</span>)</span>
<span id="cb486-7"><a href="appendixdata1.html#cb486-7" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>age[idx[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb486-8"><a href="appendixdata1.html#cb486-8" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>store_exp[idx[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">500</span></span>
<span id="cb486-9"><a href="appendixdata1.html#cb486-9" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>store_exp[idx[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">30000</span>, <span class="dv">30000</span>)</span></code></pre></div>
<p>So far we have created part of the data. You can check it using <code>summary(sim.dat)</code>. Next, we will move on to simulate survey data.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="appendixdata1.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of survey questions</span></span>
<span id="cb487-2"><a href="appendixdata1.html#cb487-2" aria-hidden="true" tabindex="-1"></a>nq <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb487-3"><a href="appendixdata1.html#cb487-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-4"><a href="appendixdata1.html#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mean matrix for different segments </span></span>
<span id="cb487-5"><a href="appendixdata1.html#cb487-5" aria-hidden="true" tabindex="-1"></a>mus2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>( <span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>, <span class="co"># Price</span></span>
<span id="cb487-6"><a href="appendixdata1.html#cb487-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>, <span class="co"># Conspicuous</span></span>
<span id="cb487-7"><a href="appendixdata1.html#cb487-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>, <span class="co"># Quality</span></span>
<span id="cb487-8"><a href="appendixdata1.html#cb487-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>), <span class="co"># Style</span></span>
<span id="cb487-9"><a href="appendixdata1.html#cb487-9" aria-hidden="true" tabindex="-1"></a><span class="at">ncol=</span>nq, <span class="at">byrow=</span><span class="cn">TRUE</span>) </span>
<span id="cb487-10"><a href="appendixdata1.html#cb487-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-11"><a href="appendixdata1.html#cb487-11" aria-hidden="true" tabindex="-1"></a><span class="co"># assume the variance is 0.2 for all</span></span>
<span id="cb487-12"><a href="appendixdata1.html#cb487-12" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb487-13"><a href="appendixdata1.html#cb487-13" aria-hidden="true" tabindex="-1"></a>sim.dat2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb487-14"><a href="appendixdata1.html#cb487-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb487-15"><a href="appendixdata1.html#cb487-15" aria-hidden="true" tabindex="-1"></a><span class="co"># loop for customer segment (i)</span></span>
<span id="cb487-16"><a href="appendixdata1.html#cb487-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(group_name)) {</span>
<span id="cb487-17"><a href="appendixdata1.html#cb487-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the following line is used for checking the</span></span>
<span id="cb487-18"><a href="appendixdata1.html#cb487-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># progress cat (i, group_name[i],&#39;\n&#39;) create an</span></span>
<span id="cb487-19"><a href="appendixdata1.html#cb487-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># empty data frame to store data</span></span>
<span id="cb487-20"><a href="appendixdata1.html#cb487-20" aria-hidden="true" tabindex="-1"></a>    seg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> group_size[i], </span>
<span id="cb487-21"><a href="appendixdata1.html#cb487-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> nq))</span>
<span id="cb487-22"><a href="appendixdata1.html#cb487-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate data within segment</span></span>
<span id="cb487-23"><a href="appendixdata1.html#cb487-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nq) {</span>
<span id="cb487-24"><a href="appendixdata1.html#cb487-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate normal distribution</span></span>
<span id="cb487-25"><a href="appendixdata1.html#cb487-25" aria-hidden="true" tabindex="-1"></a>        res <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(group_size[i], <span class="at">mean =</span> mus2[i, </span>
<span id="cb487-26"><a href="appendixdata1.html#cb487-26" aria-hidden="true" tabindex="-1"></a>            j], <span class="at">sd =</span> sd2)</span>
<span id="cb487-27"><a href="appendixdata1.html#cb487-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># set upper and lower limit</span></span>
<span id="cb487-28"><a href="appendixdata1.html#cb487-28" aria-hidden="true" tabindex="-1"></a>        res[res <span class="sc">&gt;</span> <span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb487-29"><a href="appendixdata1.html#cb487-29" aria-hidden="true" tabindex="-1"></a>        res[res <span class="sc">&lt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb487-30"><a href="appendixdata1.html#cb487-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># convert continuous values to discrete integers</span></span>
<span id="cb487-31"><a href="appendixdata1.html#cb487-31" aria-hidden="true" tabindex="-1"></a>        seg[, j] <span class="ot">&lt;-</span> <span class="fu">floor</span>(res)</span>
<span id="cb487-32"><a href="appendixdata1.html#cb487-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb487-33"><a href="appendixdata1.html#cb487-33" aria-hidden="true" tabindex="-1"></a>    sim.dat2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim.dat2, seg)</span>
<span id="cb487-34"><a href="appendixdata1.html#cb487-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb487-35"><a href="appendixdata1.html#cb487-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-36"><a href="appendixdata1.html#cb487-36" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sim.dat2) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Q&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb487-37"><a href="appendixdata1.html#cb487-37" aria-hidden="true" tabindex="-1"></a>sim.dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sim.dat, sim.dat2)</span>
<span id="cb487-38"><a href="appendixdata1.html#cb487-38" aria-hidden="true" tabindex="-1"></a>sim.dat<span class="sc">$</span>segment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(group_name, <span class="at">times =</span> group_size))</span></code></pre></div>
<!--
## Customer Satisfaction Survey Data from Airline Company {#appendixdata2}

```r
# Create a matrix of factor loadings This pattern
# is called bifactor because it has a general
# factor for separate components.  For example,
# 'Ease of making reservation' has general factor
# loading 0.33, specific factor loading 0.58 The
# outcome variables are formed as combinations of
# these general and specific factors

loadings <- matrix(c ( 
  # Ticketing
  .33, .58, .00, .00,  # Ease of making reservation 
  .35, .55, .00, .00,  # Availability of preferred seats
  .30, .52, .00, .00,  # Variety of flight options
  .40, .50, .00, .00,  # Ticket prices
  # Aircraft
  .50, .00, .55, .00,  # Seat comfort
  .41, .00, .51, .00,  # Roominess of seat area
  .45, .00, .57, .00,  # Availability of Overhead
  .32, .00, .54, .00,  # Cleanliness of aircraft
  # Service
  .35, .00, .00, .50,  # Courtesy of flight attendant
  .38, .00, .00, .57,  # Friendliness
  .60, .00, .00, .50,  # Helpfulness
  .52, .00, .00, .58,  # Food and drinks
  # General   
  .43, .10, .30, .30,  # Overall satisfaction
  .35, .50, .40, .20,  # Purchase again
  .25, .50, .50, .20), # Willingness to recommend
  nrow=15,ncol=4, byrow=TRUE)

# Matrix multiplication produces the correlation
# matrix except for the diagonal
cor_matrix <- loadings %*% t(loadings)
# Diagonal set to ones
diag(cor_matrix) <- 1

# use the mvtnorm package to randomly generate a
# data set with a given correlation pattern

library(mvtnorm)
# mean vectors of the 3 airline companies
mu1 = c(5, 6, 5, 6, 7, 8, 6, 7, 5, 5, 5, 5, 6, 6, 6)
mu2 = c(3, 3, 2, 3, 5, 4, 5, 6, 8, 8, 8, 8, 3, 3, 3)
mu3 = c(2, 2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8)

# set random seed
set.seed(123456)
# respondent ID
resp.id <- 1:1000

library(MASS)
rating1 <- mvrnorm(length(resp.id), mu = mu1, Sigma = cor_matrix)
rating2 <- mvrnorm(length(resp.id), mu = mu2, Sigma = cor_matrix)
rating3 <- mvrnorm(length(resp.id), mu = mu3, Sigma = cor_matrix)


# truncates scale to be between 1 and 9
rating1[rating1 > 9] <- 9
rating1[rating1 < 1] <- 1
rating2[rating2 > 9] <- 9
rating2[rating2 < 1] <- 1
rating3[rating3 > 9] <- 9
rating3[rating3 < 1] <- 1

# Round to single digit
rating1 <- data.frame(round(rating1, 0))
rating2 <- data.frame(round(rating2, 0))
rating3 <- data.frame(round(rating3, 0))
rating1$ID <- resp.id
rating2$ID <- resp.id
rating3$ID <- resp.id
rating1$Airline <- rep("AirlineCo.1", length(resp.id))
rating2$Airline <- rep("AirlineCo.2", length(resp.id))
rating3$Airline <- rep("AirlineCo.3", length(resp.id))
rating <- rbind(rating1, rating2, rating3)

# assign names to the variables in the data frame
names(rating) <- c("Easy_Reservation", "Preferred_Seats", 
    "Flight_Options", "Ticket_Prices", "Seat_Comfort", 
    "Seat_Roominess", "Overhead_Storage", "Clean_Aircraft", 
    "Courtesy", "Friendliness", "Helpfulness", "Service", 
    "Satisfaction", "Fly_Again", "Recommend", "ID", 
    "Airline")
```
-->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-code-for-data-simulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendixdata3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/happyrabbit/IntroDataScience/19-Appendix.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IDS.pdf", "IDS.epub", "IDS.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
