<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Data Science</title>
  <meta name="description" content="This is the handouts for CE course at JSM 2017">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the handouts for CE course at JSM 2017" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Data Science" />
  
  <meta name="twitter:description" content="This is the handouts for CE course at JSM 2017" />
  

<meta name="author" content="Hui Lin and Ming Li">


<meta name="date" content="2017-08-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="soft-skills-for-data-scientists.html">
<link rel="next" href="big-data-cloud-platform.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<link href="libs/leaflet-0.7.3/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.3/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/leaflet-binding-1.0.1/leaflet.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-5.0.6/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-5.0.6/highstock.js"></script>
<script src="libs/highcharts-5.0.6/highcharts-3d.js"></script>
<script src="libs/highcharts-5.0.6/highcharts-more.js"></script>
<script src="libs/highcharts-5.0.6/modules/annotations.js"></script>
<script src="libs/highcharts-5.0.6/modules/broken-axis.js"></script>
<script src="libs/highcharts-5.0.6/modules/data.js"></script>
<script src="libs/highcharts-5.0.6/modules/drilldown.js"></script>
<script src="libs/highcharts-5.0.6/modules/exporting.js"></script>
<script src="libs/highcharts-5.0.6/modules/funnel.js"></script>
<script src="libs/highcharts-5.0.6/modules/heatmap.js"></script>
<script src="libs/highcharts-5.0.6/modules/map.js"></script>
<script src="libs/highcharts-5.0.6/modules/no-data-to-display.js"></script>
<script src="libs/highcharts-5.0.6/modules/offline-exporting.js"></script>
<script src="libs/highcharts-5.0.6/modules/solid-gauge.js"></script>
<script src="libs/highcharts-5.0.6/modules/treemap.js"></script>
<script src="libs/highcharts-5.0.6/plugins/annotations.js"></script>
<script src="libs/highcharts-5.0.6/plugins/draggable-legend.js"></script>
<script src="libs/highcharts-5.0.6/plugins/draggable-points.js"></script>
<script src="libs/highcharts-5.0.6/plugins/export-csv.js"></script>
<script src="libs/highcharts-5.0.6/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-5.0.6/plugins/motion.js"></script>
<script src="libs/highcharts-5.0.6/plugins/pattern-fill-v2.js"></script>
<script src="libs/highcharts-5.0.6/plugins/tooltip-delay.js"></script>
<script src="libs/highcharts-5.0.6/custom/reset.js"></script>
<script src="libs/highcharts-5.0.6/custom/symbols-extra.js"></script>
<script src="libs/highcharts-5.0.6/custom/text-symbols.js"></script>
<link href="libs/fontawesome-4.5.0/font-awesome.min.css" rel="stylesheet" />
<link href="libs/htmlwdgtgrid-1/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highchart-binding-0.5.0/highchart.js"></script>
<link href="libs/bokehjs-0.11.1/bokeh.min.css" rel="stylesheet" />
<script src="libs/bokehjs-0.11.1/bokeh.min.js"></script>
<script src="libs/rbokeh-binding-0.4.2/rbokeh.js"></script>
<script src="libs/d3-3.5.12/d3.min.js"></script>
<link href="libs/metrics-graphics-2.7.0/dist/metricsgraphics.css" rel="stylesheet" />
<link href="libs/metrics-graphics-2.7.0/dist/mg_regions.css" rel="stylesheet" />
<script src="libs/metrics-graphics-2.7.0/dist/metricsgraphics.min.js"></script>
<script src="libs/metrics-graphics-2.7.0/dist/mg_regions.js"></script>
<script src="libs/metricsgraphics-binding-0.9.0/metricsgraphics.js"></script>
<script src="libs/forceNetwork-binding-0.2.11/forceNetwork.js"></script>
<script src="libs/threejs-70/three.min.js"></script>
<script src="libs/threejs-70/Detector.js"></script>
<script src="libs/threejs-70/Projector.js"></script>
<script src="libs/threejs-70/CanvasRenderer.js"></script>
<script src="libs/globe-binding-0.2.2/globe.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Copyright Statement</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="1" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html"><i class="fa fa-check"></i><b>1</b> The art of data science</a><ul>
<li class="chapter" data-level="1.1" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-is-data-science"><i class="fa fa-check"></i><b>1.1</b> What is data science?</a></li>
<li class="chapter" data-level="1.2" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#is-it-science-totally"><i class="fa fa-check"></i><b>1.2</b> Is it science? Totally?</a></li>
<li class="chapter" data-level="1.3" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-kind-of-questions-can-data-science-solve"><i class="fa fa-check"></i><b>1.3</b> What kind of questions can data science solve?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#prerequisites"><i class="fa fa-check"></i><b>1.3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3.2" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#problem-type"><i class="fa fa-check"></i><b>1.3.2</b> Problem type</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-are-the-required-skills-for-data-scientist"><i class="fa fa-check"></i><b>1.4</b> What are the required skills for data scientist?</a></li>
<li class="chapter" data-level="1.5" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#types-of-learning"><i class="fa fa-check"></i><b>1.5</b> Types of Learning</a></li>
<li class="chapter" data-level="1.6" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#types-of-algorithm"><i class="fa fa-check"></i><b>1.6</b> Types of Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html"><i class="fa fa-check"></i><b>2</b> Soft Skills for Data Scientists</a><ul>
<li class="chapter" data-level="2.1" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#comparison-between-statistician-and-data-scientist"><i class="fa fa-check"></i><b>2.1</b> Comparison between Statistician and Data Scientist</a></li>
<li class="chapter" data-level="2.2" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#where-data-science-team-fits"><i class="fa fa-check"></i><b>2.2</b> Where Data Science Team Fits?</a></li>
<li class="chapter" data-level="2.3" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#beyond-data-and-analytics"><i class="fa fa-check"></i><b>2.3</b> Beyond Data and Analytics</a></li>
<li class="chapter" data-level="2.4" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#data-scientist-as-a-leader"><i class="fa fa-check"></i><b>2.4</b> Data Scientist as a Leader</a></li>
<li class="chapter" data-level="2.5" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#three-pillars-of-knowledge"><i class="fa fa-check"></i><b>2.5</b> Three Pillars of Knowledge</a></li>
<li class="chapter" data-level="2.6" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#common-pitfalls-of-data-science-projects"><i class="fa fa-check"></i><b>2.6</b> Common Pitfalls of Data Science Projects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to the data</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html#customer-data-for-clothing-company"><i class="fa fa-check"></i><b>3.1</b> Customer Data for Clothing Company</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html#customer-satisfaction-survey-data-from-airline-company"><i class="fa fa-check"></i><b>3.2</b> Customer Satisfaction Survey Data from Airline Company</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html#swine-disease-breakout-data"><i class="fa fa-check"></i><b>3.3</b> Swine Disease Breakout Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html"><i class="fa fa-check"></i><b>4</b> Big Data Cloud Platform</a><ul>
<li class="chapter" data-level="4.1" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#how-data-becomes-science"><i class="fa fa-check"></i><b>4.1</b> How Data becomes Science?</a></li>
<li class="chapter" data-level="4.2" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#power-of-cluster-of-computers"><i class="fa fa-check"></i><b>4.2</b> Power of Cluster of Computers</a></li>
<li class="chapter" data-level="4.3" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#evolution-of-clustering-computing"><i class="fa fa-check"></i><b>4.3</b> Evolution of Clustering Computing</a><ul>
<li class="chapter" data-level="4.3.1" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#hadoop"><i class="fa fa-check"></i><b>4.3.1</b> Hadoop</a></li>
<li class="chapter" data-level="4.3.2" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#spark"><i class="fa fa-check"></i><b>4.3.2</b> Spark</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#introduction-of-cloud-environment"><i class="fa fa-check"></i><b>4.4</b> Introduction of Cloud Environment</a></li>
<li class="chapter" data-level="4.5" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#open-account-and-create-a-cluster"><i class="fa fa-check"></i><b>4.5</b> Open Account and Create a Cluster</a></li>
<li class="chapter" data-level="4.6" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#r-notebook"><i class="fa fa-check"></i><b>4.6</b> R Notebook</a></li>
<li class="chapter" data-level="4.7" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#markdown-cells"><i class="fa fa-check"></i><b>4.7</b> Markdown Cells</a></li>
<li class="chapter" data-level="4.8" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#leverage-hadoop-and-spark-parallel-using-r-notebook"><i class="fa fa-check"></i><b>4.8</b> Leverage Hadoop and Spark Parallel using R Notebook</a><ul>
<li class="chapter" data-level="4.8.1" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#library-installation"><i class="fa fa-check"></i><b>4.8.1</b> Library Installation</a></li>
<li class="chapter" data-level="4.8.2" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#create-connection"><i class="fa fa-check"></i><b>4.8.2</b> Create Connection</a></li>
<li class="chapter" data-level="4.8.3" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#sample-dataset"><i class="fa fa-check"></i><b>4.8.3</b> Sample Dataset</a></li>
<li class="chapter" data-level="4.8.4" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#important---copy-data-to-spark-environment"><i class="fa fa-check"></i><b>4.8.4</b> IMPORTANT - Copy Data to Spark Environment</a></li>
<li class="chapter" data-level="4.8.5" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#analyzing-the-data"><i class="fa fa-check"></i><b>4.8.5</b> Analyzing the Data</a></li>
<li class="chapter" data-level="4.8.6" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#collect-results-back-to-master-node"><i class="fa fa-check"></i><b>4.8.6</b> Collect Results Back to Master Node</a></li>
<li class="chapter" data-level="4.8.7" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#fit-regression-to-sparkdataframe"><i class="fa fa-check"></i><b>4.8.7</b> Fit Regression to SparkDataFrame</a></li>
<li class="chapter" data-level="4.8.8" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#fit-a-k-means-cluster"><i class="fa fa-check"></i><b>4.8.8</b> Fit a K-means Cluster</a></li>
<li class="chapter" data-level="4.8.9" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#summary"><i class="fa fa-check"></i><b>4.8.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#databases-and-sql"><i class="fa fa-check"></i><b>4.9</b> Databases and SQL</a><ul>
<li class="chapter" data-level="4.9.1" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#database-table-and-view"><i class="fa fa-check"></i><b>4.9.1</b> Database, Table and View</a></li>
<li class="chapter" data-level="4.9.2" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#sample-tables"><i class="fa fa-check"></i><b>4.9.2</b> Sample Tables</a></li>
<li class="chapter" data-level="4.9.3" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#basic-sql-statement"><i class="fa fa-check"></i><b>4.9.3</b> Basic SQL Statement</a></li>
<li class="chapter" data-level="4.9.4" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#simple-select-statement"><i class="fa fa-check"></i><b>4.9.4</b> Simple SELECT Statement</a></li>
<li class="chapter" data-level="4.9.5" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#aggregation-functions-and-group-by"><i class="fa fa-check"></i><b>4.9.5</b> Aggregation Functions and GROUP BY</a></li>
<li class="chapter" data-level="4.9.6" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#join-multiple-tables"><i class="fa fa-check"></i><b>4.9.6</b> Join Multiple Tables</a></li>
<li class="chapter" data-level="4.9.7" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#add-more-content-into-a-table"><i class="fa fa-check"></i><b>4.9.7</b> Add More Content into a Table</a></li>
<li class="chapter" data-level="4.9.8" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#advanced-topics-in-database"><i class="fa fa-check"></i><b>4.9.8</b> Advanced Topics in Database</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#other-useful-topics"><i class="fa fa-check"></i><b>4.10</b> Other Useful Topics</a><ul>
<li class="chapter" data-level="4.10.1" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#linux-operation-system"><i class="fa fa-check"></i><b>4.10.1</b> Linux Operation System</a></li>
<li class="chapter" data-level="4.10.2" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#visualization"><i class="fa fa-check"></i><b>4.10.2</b> Visualization</a></li>
<li class="chapter" data-level="4.10.3" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#gpu"><i class="fa fa-check"></i><b>4.10.3</b> GPU</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-pre-processing.html"><a href="data-pre-processing.html"><i class="fa fa-check"></i><b>5</b> Data Pre-processing</a><ul>
<li class="chapter" data-level="5.1" data-path="data-pre-processing.html"><a href="data-pre-processing.html#data-cleaning"><i class="fa fa-check"></i><b>5.1</b> Data Cleaning</a></li>
<li class="chapter" data-level="5.2" data-path="data-pre-processing.html"><a href="data-pre-processing.html#missing-values"><i class="fa fa-check"></i><b>5.2</b> Missing Values</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-pre-processing.html"><a href="data-pre-processing.html#impute-missing-values-with-medianmode"><i class="fa fa-check"></i><b>5.2.1</b> Impute missing values with median/mode</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-pre-processing.html"><a href="data-pre-processing.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>5.2.2</b> K-nearest neighbors</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-pre-processing.html"><a href="data-pre-processing.html#bagging-tree"><i class="fa fa-check"></i><b>5.2.3</b> Bagging Tree</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-pre-processing.html"><a href="data-pre-processing.html#centering-and-scaling"><i class="fa fa-check"></i><b>5.3</b> Centering and Scaling</a></li>
<li class="chapter" data-level="5.4" data-path="data-pre-processing.html"><a href="data-pre-processing.html#resolve-skewness"><i class="fa fa-check"></i><b>5.4</b> Resolve Skewness</a></li>
<li class="chapter" data-level="5.5" data-path="data-pre-processing.html"><a href="data-pre-processing.html#resolve-outliers"><i class="fa fa-check"></i><b>5.5</b> Resolve Outliers</a></li>
<li class="chapter" data-level="5.6" data-path="data-pre-processing.html"><a href="data-pre-processing.html#collinearity"><i class="fa fa-check"></i><b>5.6</b> Collinearity</a></li>
<li class="chapter" data-level="5.7" data-path="data-pre-processing.html"><a href="data-pre-processing.html#sparse-variables"><i class="fa fa-check"></i><b>5.7</b> Sparse Variables</a></li>
<li class="chapter" data-level="5.8" data-path="data-pre-processing.html"><a href="data-pre-processing.html#re-encode-dummy-variables"><i class="fa fa-check"></i><b>5.8</b> Re-encode Dummy Variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling</a><ul>
<li class="chapter" data-level="6.1" data-path="data-wrangling.html"><a href="data-wrangling.html#read-and-write-data"><i class="fa fa-check"></i><b>6.1</b> Read and write data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#readr"><i class="fa fa-check"></i><b>6.1.1</b> <code>readr</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data.table-enhanced-data.frame"><i class="fa fa-check"></i><b>6.1.2</b> <code>data.table</code>— enhanced <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-wrangling.html"><a href="data-wrangling.html#summarize-data"><i class="fa fa-check"></i><b>6.2</b> Summarize data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-and-sapply-in-base-r"><i class="fa fa-check"></i><b>6.2.1</b> <code>apply()</code>, <code>lapply()</code> and <code>sapply()</code> in base R</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#ddply-in-plyr-package"><i class="fa fa-check"></i><b>6.2.2</b> <code>ddply()</code> in <code>plyr</code> package</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#dplyr-package"><i class="fa fa-check"></i><b>6.2.3</b> <code>dplyr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-and-reshape-data"><i class="fa fa-check"></i><b>6.3</b> Tidy and Reshape Data</a><ul>
<li class="chapter" data-level="6.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reshape2-package"><i class="fa fa-check"></i><b>6.3.1</b> <code>reshape2</code> package</a></li>
<li class="chapter" data-level="6.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#tidyr-package"><i class="fa fa-check"></i><b>6.3.2</b> <code>tidyr</code> package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="measuring-performance.html"><a href="measuring-performance.html"><i class="fa fa-check"></i><b>7</b> Measuring Performance</a><ul>
<li class="chapter" data-level="7.1" data-path="measuring-performance.html"><a href="measuring-performance.html#regression-model-performance"><i class="fa fa-check"></i><b>7.1</b> Regression Model Performance</a></li>
<li class="chapter" data-level="7.2" data-path="measuring-performance.html"><a href="measuring-performance.html#classification-model-performance"><i class="fa fa-check"></i><b>7.2</b> Classification Model Performance</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-tuning-technique.html"><a href="model-tuning-technique.html"><i class="fa fa-check"></i><b>8</b> Model Tuning Technique</a><ul>
<li class="chapter" data-level="8.1" data-path="model-tuning-technique.html"><a href="model-tuning-technique.html#systematic-error-and-random-error"><i class="fa fa-check"></i><b>8.1</b> Systematic Error and Random Error</a><ul>
<li class="chapter" data-level="8.1.1" data-path="model-tuning-technique.html"><a href="model-tuning-technique.html#measurement-error-in-the-response"><i class="fa fa-check"></i><b>8.1.1</b> Measurement Error in the Response</a></li>
<li class="chapter" data-level="8.1.2" data-path="model-tuning-technique.html"><a href="model-tuning-technique.html#measurement-error-in-the-independent-variables"><i class="fa fa-check"></i><b>8.1.2</b> Measurement Error in the Independent Variables</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="model-tuning-technique.html"><a href="model-tuning-technique.html#data-splitting-and-resampling"><i class="fa fa-check"></i><b>8.2</b> Data Splitting and Resampling</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="feature-engineering.html"><a href="feature-engineering.html"><i class="fa fa-check"></i><b>9</b> Feature Engineering</a><ul>
<li class="chapter" data-level="9.1" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-construction"><i class="fa fa-check"></i><b>9.1</b> Feature Construction</a></li>
<li class="chapter" data-level="9.2" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-extraction"><i class="fa fa-check"></i><b>9.2</b> Feature Extraction</a></li>
<li class="chapter" data-level="9.3" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-selection"><i class="fa fa-check"></i><b>9.3</b> Feature Selection</a><ul>
<li class="chapter" data-level="9.3.1" data-path="feature-engineering.html"><a href="feature-engineering.html#filter-method"><i class="fa fa-check"></i><b>9.3.1</b> Filter Method</a></li>
<li class="chapter" data-level="9.3.2" data-path="feature-engineering.html"><a href="feature-engineering.html#wrapper-method"><i class="fa fa-check"></i><b>9.3.2</b> Wrapper Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regression-models.html"><a href="regression-models.html"><i class="fa fa-check"></i><b>10</b> Regression Models</a><ul>
<li class="chapter" data-level="10.1" data-path="regression-models.html"><a href="regression-models.html#ordinary-least-squares"><i class="fa fa-check"></i><b>10.1</b> Ordinary Least Squares</a></li>
<li class="chapter" data-level="10.2" data-path="regression-models.html"><a href="regression-models.html#multivariate-adaptive-regression-splines"><i class="fa fa-check"></i><b>10.2</b> Multivariate Adaptive Regression Splines</a></li>
<li class="chapter" data-level="10.3" data-path="regression-models.html"><a href="regression-models.html#generalized-linear-model"><i class="fa fa-check"></i><b>10.3</b> Generalized Linear Model</a></li>
<li class="chapter" data-level="10.4" data-path="regression-models.html"><a href="regression-models.html#pcr-and-pls"><i class="fa fa-check"></i><b>10.4</b> PCR and PLS</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regularization-methods.html"><a href="regularization-methods.html"><i class="fa fa-check"></i><b>11</b> Regularization Methods</a><ul>
<li class="chapter" data-level="11.1" data-path="regularization-methods.html"><a href="regularization-methods.html#ridge-regression"><i class="fa fa-check"></i><b>11.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="11.2" data-path="regularization-methods.html"><a href="regularization-methods.html#lasso"><i class="fa fa-check"></i><b>11.2</b> LASSO</a></li>
<li class="chapter" data-level="11.3" data-path="regularization-methods.html"><a href="regularization-methods.html#elastic-net"><i class="fa fa-check"></i><b>11.3</b> Elastic Net</a></li>
<li class="chapter" data-level="11.4" data-path="regularization-methods.html"><a href="regularization-methods.html#lasso-generalized-linear-model"><i class="fa fa-check"></i><b>11.4</b> LASSO Generalized Linear Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tree-based-methods.html"><a href="tree-based-methods.html"><i class="fa fa-check"></i><b>12</b> Tree-Based Methods</a><ul>
<li class="chapter" data-level="12.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#splitting-criteria"><i class="fa fa-check"></i><b>12.1</b> Splitting Criteria</a></li>
<li class="chapter" data-level="12.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#tree-pruning"><i class="fa fa-check"></i><b>12.2</b> Tree Pruning</a></li>
<li class="chapter" data-level="12.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#regression-and-decision-tree-basic"><i class="fa fa-check"></i><b>12.3</b> Regression and Decision Tree Basic</a></li>
<li class="chapter" data-level="12.4" data-path="tree-based-methods.html"><a href="tree-based-methods.html#bagging-tree-1"><i class="fa fa-check"></i><b>12.4</b> Bagging Tree</a></li>
<li class="chapter" data-level="12.5" data-path="tree-based-methods.html"><a href="tree-based-methods.html#random-forest"><i class="fa fa-check"></i><b>12.5</b> Random Forest</a></li>
<li class="chapter" data-level="12.6" data-path="tree-based-methods.html"><a href="tree-based-methods.html#gradient-boosted-machine"><i class="fa fa-check"></i><b>12.6</b> Gradient Boosted Machine</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i><b>13</b> Neural Network</a><ul>
<li class="chapter" data-level="13.1" data-path="neural-network.html"><a href="neural-network.html#projection-pursuit-regression"><i class="fa fa-check"></i><b>13.1</b> Projection Pursuit Regression</a></li>
<li class="chapter" data-level="13.2" data-path="neural-network.html"><a href="neural-network.html#neural-networks"><i class="fa fa-check"></i><b>13.2</b> Neural Networks</a></li>
<li class="chapter" data-level="13.3" data-path="neural-network.html"><a href="neural-network.html#fitting-neural-network"><i class="fa fa-check"></i><b>13.3</b> Fitting Neural Network</a></li>
<li class="chapter" data-level="13.4" data-path="neural-network.html"><a href="neural-network.html#model-training"><i class="fa fa-check"></i><b>13.4</b> Model Training</a></li>
<li class="chapter" data-level="13.5" data-path="neural-network.html"><a href="neural-network.html#computation-in-r"><i class="fa fa-check"></i><b>13.5</b> Computation in R</a><ul>
<li class="chapter" data-level="13.5.1" data-path="neural-network.html"><a href="neural-network.html#general-neural-network"><i class="fa fa-check"></i><b>13.5.1</b> General Neural Network</a></li>
<li class="chapter" data-level="13.5.2" data-path="neural-network.html"><a href="neural-network.html#averaged-neural-network"><i class="fa fa-check"></i><b>13.5.2</b> Averaged Neural Network</a></li>
<li class="chapter" data-level="13.5.3" data-path="neural-network.html"><a href="neural-network.html#model-comparison"><i class="fa fa-check"></i><b>13.5.3</b> Model Comparison</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html"><i class="fa fa-check"></i><b>14</b> Dynamic/Reproducible Report</a><ul>
<li class="chapter" data-level="14.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#what-is-r-markdown"><i class="fa fa-check"></i><b>14.1</b> What is R Markdown?</a></li>
<li class="chapter" data-level="14.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#how-to-start"><i class="fa fa-check"></i><b>14.2</b> How to Start?</a><ul>
<li class="chapter" data-level="14.2.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#how-it-works"><i class="fa fa-check"></i><b>14.2.1</b> How It Works?</a></li>
<li class="chapter" data-level="14.2.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#get-started"><i class="fa fa-check"></i><b>14.2.2</b> Get Started</a></li>
<li class="chapter" data-level="14.2.3" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#markdown-basic"><i class="fa fa-check"></i><b>14.2.3</b> Markdown Basic</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#html"><i class="fa fa-check"></i><b>14.3</b> HTML</a><ul>
<li class="chapter" data-level="14.3.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#create-an-html-document"><i class="fa fa-check"></i><b>14.3.1</b> Create an HTML document</a></li>
<li class="chapter" data-level="14.3.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#floating-toc"><i class="fa fa-check"></i><b>14.3.2</b> Floating TOC</a></li>
<li class="chapter" data-level="14.3.3" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#code-chunks"><i class="fa fa-check"></i><b>14.3.3</b> Code Chunks</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#html5-slides"><i class="fa fa-check"></i><b>14.4</b> HTML5 Slides</a><ul>
<li class="chapter" data-level="14.4.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#ioslides-presentation"><i class="fa fa-check"></i><b>14.4.1</b> <code>ioslides</code> presentation</a></li>
<li class="chapter" data-level="14.4.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#slidy-presentation"><i class="fa fa-check"></i><b>14.4.2</b> <code>slidy</code> presentation</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#dashboards"><i class="fa fa-check"></i><b>14.5</b> Dashboards</a><ul>
<li class="chapter" data-level="14.5.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#layouts"><i class="fa fa-check"></i><b>14.5.1</b> Layouts</a></li>
<li class="chapter" data-level="14.5.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#components"><i class="fa fa-check"></i><b>14.5.2</b> Components</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#shiny-dashboard"><i class="fa fa-check"></i><b>14.6</b> Shiny Dashboard</a><ul>
<li class="chapter" data-level="14.6.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#brief-introduction-to-shiny"><i class="fa fa-check"></i><b>14.6.1</b> Brief Introduction to Shiny</a></li>
<li class="chapter" data-level="14.6.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#using-shiny-with-flexdashboard"><i class="fa fa-check"></i><b>14.6.2</b> Using <code>shiny</code> with <code>flexdashboard</code></a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#html-widgets-1"><i class="fa fa-check"></i><b>14.7</b> HTML Widgets</a><ul>
<li class="chapter" data-level="14.7.1" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#dt-a-wrapper-of-the-javascript-library-datatables"><i class="fa fa-check"></i><b>14.7.1</b> <code>DT</code>: A Wrapper of the JavaScript Library DataTables</a></li>
<li class="chapter" data-level="14.7.2" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#leafletinteractive-web-maps-based-on-the-leaflet-javascript-library"><i class="fa fa-check"></i><b>14.7.2</b> <code>leaflet</code>:Interactive Web-Maps Based on the Leaflet JavaScript Library</a></li>
<li class="chapter" data-level="14.7.3" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#dygraphs-interactive-plot-for-time-series-data"><i class="fa fa-check"></i><b>14.7.3</b> <code>dygraphs</code>: interactive plot for time series data</a></li>
<li class="chapter" data-level="14.7.4" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#highcharter"><i class="fa fa-check"></i><b>14.7.4</b> <code>highcharter</code></a></li>
<li class="chapter" data-level="14.7.5" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#rbokeh-is-a-visualization-library-that-provides-a-flexible-and-powerful-declarative-framework-for-creating-web-based-plots"><i class="fa fa-check"></i><b>14.7.5</b> <code>rbokeh</code> is a visualization library that provides a flexible and powerful declarative framework for creating web-based plots</a></li>
<li class="chapter" data-level="14.7.6" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#metricsgraphics-enables-easy-creation-of-d3-scatterplots-line-charts-and-histograms."><i class="fa fa-check"></i><b>14.7.6</b> <code>metricsgraphics</code> enables easy creation of D3 scatterplots, line charts, and histograms.</a></li>
<li class="chapter" data-level="14.7.7" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#networkd3-d3-javascript-network-graphs-from-r"><i class="fa fa-check"></i><b>14.7.7</b> <code>networkD3</code>: D3 JavaScript Network Graphs from R</a></li>
<li class="chapter" data-level="14.7.8" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html#threejs-interactive-3d-scatter-plots-and-globes"><i class="fa fa-check"></i><b>14.7.8</b> <code>threejs</code>: Interactive 3D Scatter Plots and Globes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-the-data" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Introduction to the data</h1>
<p>Before tackling analytics problem, we start by creating data to be analyzed in later chapters. Why do we simulate data instead of using real data set?</p>
<ul>
<li>Going through the simulation code helps you practice R skills.</li>
<li>It makes the book less dependent on downloading online data sets.</li>
<li>It allows you manipulate the synthetic data, run analysis and examine how the results change.</li>
<li>The authors do not need to worry about intellectual property rights.</li>
</ul>
<div id="customer-data-for-clothing-company" class="section level2">
<h2><span class="header-section-number">3.1</span> Customer Data for Clothing Company</h2>
<p>Our first data set represents customers of a clothing company who sells products in stores and online. This data is typical of what one might get from a company’s marketing data base (the data base will have more data than the one we show here). This data includes 1000 customers for whom we have 3 types of data:</p>
<ol style="list-style-type: decimal">
<li>Demography
<ul>
<li><code>age</code>: age of the respondent</li>
<li><code>gender</code>: male/female</li>
<li><code>house</code>: 0/1 variable indicating if the customer owns a house or not</li>
</ul></li>
<li>Sales in the past year
<ul>
<li><code>store_exp</code>: expense in store</li>
<li><code>online_exp</code>: expense online</li>
<li><code>store_trans</code>: times of store purchase</li>
<li><code>online_trans</code>: times of online purchase</li>
</ul></li>
<li>Survey on product preference</li>
</ol>
<p>It is common for companies to survey their customers and draw insights to guide future marketing activities. The survey is as below:</p>
<p>How strongly do you agree or disagree with the following statements:</p>
<ol style="list-style-type: decimal">
<li>Strong disagree</li>
<li>Disagree</li>
<li>Neither agree nor disagree</li>
<li>Agree</li>
<li>Strongly agree</li>
</ol>
<ul>
<li>Q1. I like to buy clothes from different brands</li>
<li>Q2. I buy almost all my clothes from some of my favorite brands</li>
<li>Q3. I like to buy premium brands</li>
<li>Q4. Quality is the most important factor in my purchasing decision</li>
<li>Q5. Style is the most important factor in my purchasing decision</li>
<li>Q6. I prefer to buy clothes in store</li>
<li>Q7. I prefer to buy clothes online</li>
<li>Q8. Price is important</li>
<li>Q9. I like to try different styles</li>
<li>Q10. I like to make a choice by myself and don’t need too much of others’ suggestions</li>
</ul>
<p>There are 4 segments of customers:</p>
<ol style="list-style-type: decimal">
<li>Price</li>
<li>Conspicuous</li>
<li>Quality</li>
<li>Style</li>
</ol>
<p>The simulation is not very straightforward and we will break it into three parts:</p>
<ol style="list-style-type: decimal">
<li>Define data structure: variable names, variable distribution, customer segment names, segment size</li>
<li>Variable distribution parameters: mean and variance</li>
<li>Iterate across segments and variables. Simulate data according to specific parameters assigned</li>
</ol>
<p>By organizing code this way, it makes easy for us to change specific parts of the simulation. For example, if we want to change the distribution of one variable, we can just change the corresponding part of the code.</p>
<p>Here is code to define data structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set a random number seed to make the process repeatable</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
<span class="co"># define the number of observations</span>
ncust&lt;-<span class="dv">1000</span>
<span class="co"># create a data frmae for simulated data</span>
seg_dat&lt;-<span class="kw">data.frame</span>(<span class="dt">id=</span><span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="dv">1</span>:ncust)))
<span class="co"># assign the variable names</span>
vars&lt;-<span class="kw">c</span>(<span class="st">&quot;age&quot;</span>,<span class="st">&quot;gender&quot;</span>,<span class="st">&quot;income&quot;</span>,<span class="st">&quot;house&quot;</span>,<span class="st">&quot;store_exp&quot;</span>,<span class="st">&quot;online_exp&quot;</span>,<span class="st">&quot;store_trans&quot;</span>,<span class="st">&quot;online_trans&quot;</span>)
<span class="co"># assign distribution for each variable</span>
vartype&lt;-<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;binom&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;binom&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;pois&quot;</span>,<span class="st">&quot;pois&quot;</span>)
<span class="co"># names of 4 segments</span>
group_name&lt;-<span class="kw">c</span>(<span class="st">&quot;Price&quot;</span>,<span class="st">&quot;Conspicuous&quot;</span>,<span class="st">&quot;Quality&quot;</span>,<span class="st">&quot;Style&quot;</span>)
<span class="co"># size of each segments</span>
group_size&lt;-<span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">200</span>,<span class="dv">200</span>,<span class="dv">350</span>)</code></pre></div>
<p>The next step is to define variable distribution parameters. There are 4 segments of customers and 8 parameters. Different segments correspond to different parameters. Let’s store the parameters in a 4×8 matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># matrix for mean</span>
mus &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(
  <span class="co"># Price</span>
  <span class="dv">60</span>, <span class="fl">0.5</span>, <span class="dv">120000</span>,<span class="fl">0.9</span>, <span class="dv">500</span>,<span class="dv">200</span>,<span class="dv">5</span>,<span class="dv">2</span>,
  <span class="co"># Conspicuous</span>
  <span class="dv">40</span>, <span class="fl">0.7</span>, <span class="dv">200000</span>,<span class="fl">0.9</span>, <span class="dv">5000</span>,<span class="dv">5000</span>,<span class="dv">10</span>,<span class="dv">10</span>,
  <span class="co"># Quality</span>
  <span class="dv">36</span>, <span class="fl">0.5</span>, <span class="dv">70000</span>, <span class="fl">0.4</span>, <span class="dv">300</span>, <span class="dv">2000</span>,<span class="dv">2</span>,<span class="dv">15</span>,
  <span class="co"># Style</span>
  <span class="dv">25</span>, <span class="fl">0.2</span>, <span class="dv">90000</span>, <span class="fl">0.2</span>, <span class="dv">200</span>, <span class="dv">2000</span>,<span class="dv">2</span>,<span class="dv">20</span>), <span class="dt">ncol=</span><span class="kw">length</span>(vars), <span class="dt">byrow=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># matrix for variance</span>
sds&lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(
  <span class="co"># Price</span>
  <span class="dv">3</span>,<span class="ot">NA</span>,<span class="dv">8000</span>,<span class="ot">NA</span>,<span class="dv">100</span>,<span class="dv">50</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,
  <span class="co"># Conspicuous</span>
  <span class="dv">5</span>,<span class="ot">NA</span>,<span class="dv">50000</span>,<span class="ot">NA</span>,<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,
  <span class="co"># Quality</span>
  <span class="dv">7</span>,<span class="ot">NA</span>,<span class="dv">10000</span>,<span class="ot">NA</span>,<span class="dv">50</span>,<span class="dv">200</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,
  <span class="co"># Style</span>
  <span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">5000</span>,<span class="ot">NA</span>,<span class="dv">10</span>,<span class="dv">500</span>,<span class="ot">NA</span>,<span class="ot">NA</span>), <span class="dt">ncol=</span><span class="kw">length</span>(vars), <span class="dt">byrow=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Now we are ready to simulate data using the parameters defined above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate non-survey data</span>
sim.dat&lt;-<span class="ot">NULL</span>
<span class="kw">set.seed</span>(<span class="dv">2016</span>)
<span class="co"># loop on customer segment (i)</span>
 for (i in <span class="kw">seq_along</span>(group_name)){
 
   <span class="co"># add this line in order to moniter the process</span>
   <span class="kw">cat</span> (i, group_name[i],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
 
  <span class="co"># create an empty matrix to store relevent data</span>
  seg&lt;-<span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span>group_size[i], <span class="dt">ncol=</span><span class="kw">length</span>(vars)))  
 
  <span class="co"># Simulate data within segment i</span>
  for (j in <span class="kw">seq_along</span>(vars)){
 
    <span class="co"># loop on every variable (j)</span>
    if (vartype[j]==<span class="st">&quot;norm&quot;</span>){
      <span class="co"># simulate normal distribution</span>
      seg[,j]&lt;-<span class="kw">rnorm</span>(group_size[i], <span class="dt">mean=</span>mus[i,j], <span class="dt">sd=</span>sds[i,j])
    } else if (vartype[j]==<span class="st">&quot;pois&quot;</span>) {
      <span class="co"># simulate poisson distribution</span>
      seg[,j]&lt;-<span class="kw">rpois</span>(group_size[i], <span class="dt">lambda=</span>mus[i,j])
    } else if (vartype[j]==<span class="st">&quot;binom&quot;</span>){
      <span class="co"># simulate binomial distribution</span>
      seg[,j]&lt;-<span class="kw">rbinom</span>(group_size[i],<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span>mus[i,j])
    } else{
      <span class="co"># if the distribution name is not one of the above, stop and return a message</span>
      <span class="kw">stop</span> (<span class="st">&quot;Don&#39;t have type:&quot;</span>,vartype[j])
    }        
  }
  sim.dat&lt;-<span class="kw">rbind</span>(sim.dat,seg)
 }</code></pre></div>
<p>Now let’s edit the data we just simulated a little by adding tags to 0/1 binomial variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># assign variable names</span>
<span class="kw">names</span>(sim.dat)&lt;-vars
<span class="co"># assign factor levels to segment variable</span>
sim.dat$segment&lt;-<span class="kw">factor</span>(<span class="kw">rep</span>(group_name,<span class="dt">times=</span>group_size))
<span class="co"># recode gender and house variable</span>
sim.dat$gender&lt;-<span class="kw">factor</span>(sim.dat$gender, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>))
sim.dat$house&lt;-<span class="kw">factor</span>(sim.dat$house, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>))
<span class="co"># store_trans and online_trans are at least 1</span>
sim.dat$store_trans&lt;-sim.dat$store_trans<span class="dv">+1</span>
sim.dat$online_trans&lt;-sim.dat$online_trans<span class="dv">+1</span>
<span class="co"># age is integer</span>
sim.dat$age&lt;-<span class="kw">floor</span>(sim.dat$age)</code></pre></div>
<p>In the real world, the data always includes some noise such as missing, wrong imputation. So we will add some noise to the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add missing values</span>
idxm &lt;-<span class="st"> </span><span class="kw">as.logical</span>(<span class="kw">rbinom</span>(ncust, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">prob=</span>sim.dat$age/<span class="dv">200</span>))
sim.dat$income[idxm]&lt;-<span class="ot">NA</span>
<span class="co"># add wrong imputations and outliers</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
idx&lt;-<span class="kw">sample</span>(<span class="dv">1</span>:ncust,<span class="dv">5</span>)
sim.dat$age[idx[<span class="dv">1</span>]]&lt;-<span class="dv">300</span>
sim.dat$store_exp[idx[<span class="dv">2</span>]]&lt;-<span class="st"> </span>-<span class="dv">500</span>
sim.dat$store_exp[idx[<span class="dv">3</span>:<span class="dv">5</span>]]&lt;-<span class="kw">c</span>(<span class="dv">50000</span>,<span class="dv">30000</span>,<span class="dv">30000</span>)</code></pre></div>
<p>So far we have created part of the data. You can check it using `summary(sim.dat).’ Next, we will move on to simulate survey data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of survey questions</span>
nq&lt;-<span class="dv">10</span>
<span class="co"># mean matrix for different segments </span>
mus2 &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(
  <span class="co"># Price</span>
 <span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,
  <span class="co"># Conspicuous</span>
 <span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,
  <span class="co"># Quality</span>
 <span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,
  <span class="co"># Style</span>
 <span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>), <span class="dt">ncol=</span>nq, <span class="dt">byrow=</span><span class="ot">TRUE</span>)

<span class="co"># assume the variance is 0.2 for all</span>
sd2&lt;-<span class="fl">0.2</span>
sim.dat2&lt;-<span class="ot">NULL</span>
<span class="kw">set.seed</span>(<span class="dv">1000</span>)
<span class="co"># loop for customer segment (i)</span>
for (i in <span class="kw">seq_along</span>(group_name)){
  <span class="co"># the following line is used for checking the progress</span>
  <span class="co"># cat (i, group_name[i],&quot;\n&quot;)</span>
  <span class="co"># create an empty data frame to store data</span>
  seg&lt;-<span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span>group_size[i], <span class="dt">ncol=</span>nq))  
  <span class="co"># simulate data within segment</span>
  for (j in <span class="dv">1</span>:nq){
    <span class="co"># simulate normal distribution</span>
    res&lt;-<span class="kw">rnorm</span>(group_size[i], <span class="dt">mean=</span>mus2[i,j], <span class="dt">sd=</span>sd2)
    <span class="co"># set upper and lower limit</span>
    res[res&gt;<span class="dv">5</span>]&lt;-<span class="dv">5</span>
    res[res&lt;<span class="dv">1</span>]&lt;-<span class="dv">1</span>
    <span class="co"># convert continuous values to discrete integers</span>
    seg[,j]&lt;-<span class="kw">floor</span>(res)
  }
  sim.dat2&lt;-<span class="kw">rbind</span>(sim.dat2,seg)
}

<span class="kw">names</span>(sim.dat2)&lt;-<span class="kw">paste</span>(<span class="st">&quot;Q&quot;</span>,<span class="dv">1</span>:<span class="dv">10</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
sim.dat&lt;-<span class="kw">cbind</span>(sim.dat,sim.dat2)
sim.dat$segment&lt;-<span class="kw">factor</span>(<span class="kw">rep</span>(group_name,<span class="dt">times=</span>group_size))</code></pre></div>
<p>So far we have gotten all the data. Let’s check it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sim.dat,<span class="dt">vec.len=</span><span class="dv">3</span>)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  19 variables:
##  $ age         : int  57 63 59 60 51 59 57 57 ...
##  $ gender      : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 1 1 2 2 2 2 2 2 ...
##  $ income      : num  120963 122008 114202 113616 ...
##  $ house       : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 2 2 2 2 2 2 2 ...
##  $ store_exp   : num  529 478 491 348 ...
##  $ online_exp  : num  304 110 279 142 ...
##  $ store_trans : int  2 4 7 10 4 4 5 11 ...
##  $ online_trans: int  2 2 2 2 4 5 3 5 ...
##  $ Q1          : int  4 4 5 5 4 4 4 5 ...
##  $ Q2          : int  2 1 2 2 1 2 1 2 ...
##  $ Q3          : int  1 1 1 1 1 1 1 1 ...
##  $ Q4          : int  2 2 2 3 3 2 2 3 ...
##  $ Q5          : int  1 1 1 1 1 1 1 1 ...
##  $ Q6          : int  4 4 4 4 4 4 4 4 ...
##  $ Q7          : int  1 1 1 1 1 1 1 1 ...
##  $ Q8          : int  4 4 4 4 4 4 4 4 ...
##  $ Q9          : int  2 1 1 2 2 1 1 2 ...
##  $ Q10         : int  4 4 4 4 4 4 4 4 ...
##  $ segment     : Factor w/ 4 levels &quot;Conspicuous&quot;,..: 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
<div id="customer-satisfaction-survey-data-from-airline-company" class="section level2">
<h2><span class="header-section-number">3.2</span> Customer Satisfaction Survey Data from Airline Company</h2>
<p>We will simulate a customer satisfaction survey for three airline companies. There are <code>N=1000</code> respondents and 15 questions. The market researcher asked respondents to recall the experience with different airline companies and assign a score (1-9) to each airline company for all the 15 questions. The higher the score, the more satisfied the customer to the specific item. The 15 questions are of 4 types (the variable names are in the parentheses):</p>
<ul>
<li>How satisfied are you with your______?</li>
</ul>
<ol style="list-style-type: decimal">
<li>Ticketing
<ul>
<li>Ease of making reservation（Easy_Reservation）</li>
<li>Availability of preferred seats（Preferred_Seats）</li>
<li>Variety of flight options（Flight_Options）</li>
<li>Ticket prices（Ticket_Prices）</li>
</ul></li>
<li>Aircraft
<ul>
<li>Seat comfort（Seat_Comfort）</li>
<li>Roominess of seat area（Seat_Roominess）</li>
<li>Availability of Overhead（Overhead_Storage）</li>
<li>Cleanliness of aircraft（Clean_Aircraft）</li>
</ul></li>
<li>Service
<ul>
<li>Courtesy of flight attendant（Courtesy）</li>
<li>Friendliness（Friendliness）</li>
<li>Helpfulness（Helpfulness）</li>
<li>Food and drinks（Service）</li>
</ul></li>
<li>General
<ul>
<li>Overall satisfaction（Satisfaction）</li>
<li>Purchase again（Fly_Again）</li>
<li>Willingness to recommend（Recommend）</li>
</ul></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a matrix of factor loadings</span>
<span class="co"># This pattern is called bifactor because it has a general factor for separate components.</span>
<span class="co"># For example, &quot;Ease of making reservation&quot; has general factor loading 0.33, specific factor loading 0.58</span>
<span class="co"># The outcome variables are formed as combinations of these general and specific factors</span>

loadings &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span> (
  <span class="co"># Ticketing</span>
  .<span class="dv">33</span>, .<span class="dv">58</span>, .<span class="dv">00</span>, .<span class="dv">00</span>,  <span class="co"># Ease of making reservation </span>
  .<span class="dv">35</span>, .<span class="dv">55</span>, .<span class="dv">00</span>, .<span class="dv">00</span>,  <span class="co"># Availability of preferred seats</span>
  .<span class="dv">30</span>, .<span class="dv">52</span>, .<span class="dv">00</span>, .<span class="dv">00</span>,  <span class="co"># Variety of flight options</span>
  .<span class="dv">40</span>, .<span class="dv">50</span>, .<span class="dv">00</span>, .<span class="dv">00</span>,  <span class="co"># Ticket prices</span>
  <span class="co"># Aircraft</span>
  .<span class="dv">50</span>, .<span class="dv">00</span>, .<span class="dv">55</span>, .<span class="dv">00</span>,  <span class="co"># Seat comfort</span>
  .<span class="dv">41</span>, .<span class="dv">00</span>, .<span class="dv">51</span>, .<span class="dv">00</span>,  <span class="co"># Roominess of seat area</span>
  .<span class="dv">45</span>, .<span class="dv">00</span>, .<span class="dv">57</span>, .<span class="dv">00</span>,  <span class="co"># Availability of Overhead</span>
  .<span class="dv">32</span>, .<span class="dv">00</span>, .<span class="dv">54</span>, .<span class="dv">00</span>,  <span class="co"># Cleanliness of aircraft</span>
  <span class="co"># Service</span>
  .<span class="dv">35</span>, .<span class="dv">00</span>, .<span class="dv">00</span>, .<span class="dv">50</span>,  <span class="co"># Courtesy of flight attendant</span>
  .<span class="dv">38</span>, .<span class="dv">00</span>, .<span class="dv">00</span>, .<span class="dv">57</span>,  <span class="co"># Friendliness</span>
  .<span class="dv">60</span>, .<span class="dv">00</span>, .<span class="dv">00</span>, .<span class="dv">50</span>,  <span class="co"># Helpfulness</span>
  .<span class="dv">52</span>, .<span class="dv">00</span>, .<span class="dv">00</span>, .<span class="dv">58</span>,  <span class="co"># Food and drinks</span>
  <span class="co"># General   </span>
  .<span class="dv">43</span>, .<span class="dv">10</span>, .<span class="dv">30</span>, .<span class="dv">30</span>,  <span class="co"># Overall satisfaction</span>
  .<span class="dv">35</span>, .<span class="dv">50</span>, .<span class="dv">40</span>, .<span class="dv">20</span>,  <span class="co"># Purchase again</span>
  .<span class="dv">25</span>, .<span class="dv">50</span>, .<span class="dv">50</span>, .<span class="dv">20</span>), <span class="co"># Willingness to recommend</span>
  <span class="dt">nrow=</span><span class="dv">15</span>,<span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
  
<span class="co"># Matrix multiplication produces the correlation matrix except for the diagonal</span>
cor_matrix&lt;-loadings %*%<span class="st"> </span><span class="kw">t</span>(loadings)
<span class="co"># Diagonal set to ones</span>
<span class="kw">diag</span>(cor_matrix)&lt;-<span class="dv">1</span>

<span class="co"># use the mvtnorm package to randomly generate a data set with a given correlation pattern</span>

<span class="kw">library</span>(mvtnorm)
<span class="co"># mean vectors of the 3 airline companies</span>
mu1=<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">6</span>, <span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>)
mu2=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>, <span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>, <span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)
mu3=<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>, <span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>, <span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>)

<span class="co"># set random seed</span>
<span class="kw">set.seed</span>(<span class="dv">123456</span>) 
<span class="co"># respondent ID</span>
resp.id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">1000</span> 

<span class="kw">library</span>(MASS) 
rating1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="kw">length</span>(resp.id),
                     <span class="dt">mu=</span>mu1,
                     <span class="dt">Sigma=</span>cor_matrix)
rating2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="kw">length</span>(resp.id),
                   <span class="dt">mu=</span>mu2,
                   <span class="dt">Sigma=</span>cor_matrix)
rating3 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="kw">length</span>(resp.id),
                   <span class="dt">mu=</span>mu3,
                   <span class="dt">Sigma=</span>cor_matrix)


<span class="co"># truncates scale to be between 1 and 9</span>
rating1[rating1&gt;<span class="dv">9</span>]&lt;-<span class="dv">9</span>
rating1[rating1&lt;<span class="dv">1</span>]&lt;-<span class="dv">1</span>
rating2[rating2&gt;<span class="dv">9</span>]&lt;-<span class="dv">9</span>
rating2[rating2&lt;<span class="dv">1</span>]&lt;-<span class="dv">1</span>
rating3[rating3&gt;<span class="dv">9</span>]&lt;-<span class="dv">9</span>
rating3[rating3&lt;<span class="dv">1</span>]&lt;-<span class="dv">1</span>

<span class="co"># Round to single digit</span>
rating1&lt;-<span class="kw">data.frame</span>(<span class="kw">round</span>(rating1,<span class="dv">0</span>))
rating2&lt;-<span class="kw">data.frame</span>(<span class="kw">round</span>(rating2,<span class="dv">0</span>))
rating3&lt;-<span class="kw">data.frame</span>(<span class="kw">round</span>(rating3,<span class="dv">0</span>))
rating1$ID&lt;-resp.id
rating2$ID&lt;-resp.id
rating3$ID&lt;-resp.id
rating1$Airline&lt;-<span class="kw">rep</span>(<span class="st">&quot;AirlineCo.1&quot;</span>,<span class="kw">length</span>(resp.id))
rating2$Airline&lt;-<span class="kw">rep</span>(<span class="st">&quot;AirlineCo.2&quot;</span>,<span class="kw">length</span>(resp.id))
rating3$Airline&lt;-<span class="kw">rep</span>(<span class="st">&quot;AirlineCo.3&quot;</span>,<span class="kw">length</span>(resp.id))
rating&lt;-<span class="kw">rbind</span>(rating1,rating2,rating3)

<span class="co"># assign names to the variables in the data frame</span>
<span class="kw">names</span>(rating)&lt;-<span class="kw">c</span>(
  <span class="st">&quot;Easy_Reservation&quot;</span>,
  <span class="st">&quot;Preferred_Seats&quot;</span>,
  <span class="st">&quot;Flight_Options&quot;</span>,
  <span class="st">&quot;Ticket_Prices&quot;</span>,
  <span class="st">&quot;Seat_Comfort&quot;</span>,
  <span class="st">&quot;Seat_Roominess&quot;</span>,
  <span class="st">&quot;Overhead_Storage&quot;</span>,
  <span class="st">&quot;Clean_Aircraft&quot;</span>,
  <span class="st">&quot;Courtesy&quot;</span>,
  <span class="st">&quot;Friendliness&quot;</span>,
  <span class="st">&quot;Helpfulness&quot;</span>,
  <span class="st">&quot;Service&quot;</span>,
  <span class="st">&quot;Satisfaction&quot;</span>,
  <span class="st">&quot;Fly_Again&quot;</span>,
  <span class="st">&quot;Recommend&quot;</span>,
  <span class="st">&quot;ID&quot;</span>,
  <span class="st">&quot;Airline&quot;</span>)</code></pre></div>
<p>Now check the data frame we have:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(rating,<span class="dt">vec.len=</span><span class="dv">3</span>)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    3000 obs. of  17 variables:
##  $ Easy_Reservation: int  6 5 6 5 4 5 6 4 ...
##  $ Preferred_Seats : int  5 7 6 6 5 6 6 6 ...
##  $ Flight_Options  : int  4 7 5 5 3 4 6 3 ...
##  $ Ticket_Prices   : int  5 6 6 5 6 5 5 5 ...
##  $ Seat_Comfort    : int  5 6 7 7 6 6 6 4 ...
##  $ Seat_Roominess  : int  7 8 6 8 7 8 6 5 ...
##  $ Overhead_Storage: int  5 5 7 6 5 4 4 4 ...
##  $ Clean_Aircraft  : int  7 6 7 7 7 7 6 4 ...
##  $ Courtesy        : int  5 6 6 4 2 5 5 4 ...
##  $ Friendliness    : int  4 6 6 6 3 4 5 5 ...
##  $ Helpfulness     : int  6 5 6 4 4 5 5 4 ...
##  $ Service         : int  6 5 6 5 3 5 5 5 ...
##  $ Satisfaction    : int  6 7 7 5 4 6 5 5 ...
##  $ Fly_Again       : int  6 6 6 7 4 5 3 4 ...
##  $ Recommend       : int  3 6 5 5 4 5 6 5 ...
##  $ ID              : int  1 2 3 4 5 6 7 8 ...
##  $ Airline         : chr  &quot;AirlineCo.1&quot; &quot;AirlineCo.1&quot; &quot;AirlineCo.1&quot; ...</code></pre>
</div>
<div id="swine-disease-breakout-data" class="section level2">
<h2><span class="header-section-number">3.3</span> Swine Disease Breakout Data</h2>
<p>In this section, we are going to simulate a data set about swine disease. We simulate 800 farms (i.e. n=800) and 120 survey questions (i.e. G=120) in each data set. There are three possible answers for each question. The outbreak status for the <span class="math inline">\(i^{th}\)</span> farm is generated from a <span class="math inline">\(Bernoulli(1, p_i)\)</span> distribution with <span class="math inline">\(p_i\)</span> being a function of the question answers:</p>
<p><span class="math display">\[ln(\frac{p_i}{1-p_i})=\beta_0 + \Sigma_{g=1}^G\mathbf{x_{i,g}^T\beta_{g}}\]</span></p>
<p>where <span class="math inline">\(\beta_0\)</span> is the intercept, <span class="math inline">\(\mathbf{x_{i,g}}\)</span> is a three-dimensional indication vector for question answer and <span class="math inline">\(\mathbf(\beta_g)\)</span> is the parameter vector corresponding to the <span class="math inline">\(g^{th}\)</span> predictor. Three types of questions are considered regarding their effects on the outcome. The first forty survey questions are important questions such that the coefficients of the three answers to these questions are all different:</p>
<p><span class="math display">\[\mathbf{\beta_g}=(1,0,-1)\times \gamma,\ g=1,\dots,40\]</span> The second forty survey questions are also important questions but only one answer has a coefficient that is different from the other two answers:</p>
<p><span class="math display">\[\mathbf{\beta_g}=(1,0,0)\times \gamma,\ g=41,\dots,80\]</span></p>
<p>The last forty survey questions are also unimportant questions such that all three answers have the same coefficients:</p>
<p><span class="math display">\[\mathbf{\beta_g}=(0,0,0)\times \gamma,\ g=81,\dots,120\]</span></p>
<p>The baseline coefficient <span class="math inline">\(\beta_0\)</span> is set to be <span class="math inline">\(-\frac{40}{3}\gamma\)</span> so that on average a farm have <span class="math inline">\(50%\)</span> of chance to have an outbreak. The parameter <span class="math inline">\(\gamma\)</span> in the above simulation is set to control the strength of the questions’ effect on the outcome. In this simulation study, we consider the situations where <span class="math inline">\(\gamma = 0.1, 0.25, 0.5, 1, 2\)</span>. So the parameter settings are:</p>
<p><span class="math display">\[\mathbf{\beta^{T}}=\left(\underset{question\ 1}{\frac{40}{3},\underbrace{1,0,-1}},...,\underset{question\ 40}{\underbrace{1,0,-1}},\underset{question\ 41}{\underbrace{1,0,0}},...,\underset{question\ 80}{\underbrace{1,0,0}},\underset{question\ 81}{\underbrace{0,0,0}},...,\underset{question\ 120}{\underbrace{0,0,0}}\right)*\gamma\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sim1_da1.csv  the 1st simulated data</span>
<span class="co"># similar sim1_da2 and sim1_da3</span>
<span class="co"># sim1.csv  simulated data, the first simulation</span>
<span class="co"># dummy.sim1.csv dummy variables for the first simulated data with all the baseline in</span>
<span class="co">#code for simulation</span>

<span class="co"># setwd(dirname(file.choose()))</span>
<span class="co"># library(grplasso)</span>

nf&lt;-<span class="dv">800</span>
for (j in <span class="dv">1</span>:<span class="dv">20</span>){
<span class="kw">set.seed</span>(<span class="dv">19870</span>+j)
x&lt;-<span class="kw">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>)
sim.da1&lt;-<span class="ot">NULL</span>
for (i in <span class="dv">1</span>:nf){
<span class="co"># sample(x, 120, replace=TRUE)-&gt;sam</span>
sim.da1&lt;-<span class="kw">rbind</span>(sim.da1,<span class="kw">sample</span>(x, <span class="dv">120</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>))
}

<span class="kw">data.frame</span>(sim.da1)-&gt;sim.da1
<span class="kw">paste</span>(<span class="st">&quot;Q&quot;</span>, <span class="dv">1</span>:<span class="dv">120</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)-&gt;col
<span class="kw">paste</span>(<span class="st">&quot;Farm&quot;</span>, <span class="dv">1</span>:nf, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)-&gt;row
<span class="kw">colnames</span>(sim.da1)&lt;-col
<span class="kw">rownames</span>(sim.da1)&lt;-row

<span class="co"># use class.ind() function in nnet package to encode dummy variables</span>
<span class="kw">library</span>(nnet)
dummy.sim1&lt;-<span class="ot">NULL</span>
for (k in <span class="dv">1</span>:<span class="kw">ncol</span>(sim.da1)) {
tmp=<span class="kw">class.ind</span>(sim.da1[,k])
<span class="kw">colnames</span>(tmp)=<span class="kw">paste</span>(col[k],<span class="kw">colnames</span>(tmp))
dummy.sim1=<span class="kw">cbind</span>(dummy.sim1,tmp)
}
<span class="kw">data.frame</span>(dummy.sim1)-&gt;dummy.sim1

<span class="co"># set &quot;C&quot; as the baseline</span>
<span class="co"># delete baseline dummy variable</span>

base.idx&lt;-<span class="dv">3</span>*<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">120</span>)
dummy1&lt;-dummy.sim1[,-base.idx]

<span class="co"># simulate independent variable for different values of r</span>
<span class="co"># simulate based on one value of r each time</span>
<span class="co"># r=0.1, get the link function</span>
<span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">10</span>,<span class="dv">0</span>,-<span class="dv">1</span>/<span class="dv">10</span>),<span class="dv">40</span>),<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">40</span>),<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">40</span>))-&gt;s1
<span class="kw">as.matrix</span>(dummy.sim1)%*%s1<span class="dv">-40</span>/<span class="dv">3</span>/<span class="dv">10</span>-&gt;link1

<span class="co"># r=0.25 </span>
<span class="co"># c(rep(c(1/4,0,-1/4),40),rep(c(1/4,0,0),40),rep(c(0,0,0),40))-&gt;s1</span>
<span class="co"># as.matrix(dummy.sim1)%*%s1-40/3/4-&gt;link1</span>

<span class="co"># r=0.5 </span>
<span class="co"># c(rep(c(1/2,0,-1/2),40),rep(c(1/2,0,0),40),rep(c(0,0,0),40))-&gt;s1</span>
<span class="co"># as.matrix(dummy.sim1)%*%s1-40/3/2-&gt;link1</span>

<span class="co"># r=1</span>
<span class="co"># c(rep(c(1,0,-1),40),rep(c(1,0,0),40),rep(c(0,0,0),40))-&gt;s1</span>
<span class="co"># as.matrix(dummy.sim1)%*%s1-40/3-&gt;link1</span>

<span class="co"># r=2</span>
<span class="co"># c(rep(c(2,0,-2),40),rep(c(2,0,0),40),rep(c(0,0,0),40))-&gt;s1</span>
<span class="co"># as.matrix(dummy.sim1)%*%s1-40/3/0.5-&gt;link1</span>


<span class="co"># calculate the outbreak probability</span>
<span class="kw">exp</span>(link1)/(<span class="kw">exp</span>(link1)+<span class="dv">1</span>)-&gt;hp1

<span class="co"># based on the probability hp1, simulate response variable: res</span>
res&lt;-<span class="kw">rep</span>(<span class="dv">9</span>,nf)
for (i in <span class="dv">1</span>:nf){
<span class="kw">sample</span>( <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="dt">prob=</span><span class="kw">c</span>(hp1[i],<span class="dv">1</span>-hp1[i]))-&gt;res[i]
}

<span class="co"># da1 with response variable, without group indicator</span>
<span class="co"># da2 without response variable, with group indicator</span>
<span class="co"># da3 without response variable, without group indicator</span>

dummy1$y&lt;-res
da1&lt;-dummy1
y&lt;-da1$y
ind&lt;-<span class="ot">NULL</span>
for (i in <span class="dv">1</span>:<span class="dv">120</span>){
<span class="kw">c</span>(ind,<span class="kw">rep</span>(i,<span class="dv">2</span>))-&gt;ind
}

da2&lt;-<span class="kw">rbind</span>(da1[,<span class="dv">1</span>:<span class="dv">240</span>],ind)
da3&lt;-da1[,<span class="dv">1</span>:<span class="dv">240</span>]

<span class="co"># save simulated data</span>
<span class="kw">write.csv</span>(da1,<span class="kw">paste</span>(<span class="st">&#39;sim&#39;</span>,j,<span class="st">&#39;_da&#39;</span>,<span class="dv">1</span>,<span class="st">&#39;.csv&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>),<span class="dt">row.names=</span>F)
<span class="kw">write.csv</span>(da2,<span class="kw">paste</span>(<span class="st">&#39;sim&#39;</span>,j,<span class="st">&#39;_da&#39;</span>,<span class="dv">2</span>,<span class="st">&#39;.csv&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>),<span class="dt">row.names=</span>F)
<span class="kw">write.csv</span>(da3,<span class="kw">paste</span>(<span class="st">&#39;sim&#39;</span>,j,<span class="st">&#39;_da&#39;</span>,<span class="dv">3</span>,<span class="st">&#39;.csv&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>),<span class="dt">row.names=</span>F)
<span class="kw">write.csv</span>(sim.da1,<span class="kw">paste</span>(<span class="st">&#39;sim&#39;</span>,j,<span class="st">&#39;.csv&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>),<span class="dt">row.names=</span>F)
<span class="kw">write.csv</span>(dummy.sim1,<span class="kw">paste</span>(<span class="st">&#39;dummy.sim&#39;</span>,j,<span class="st">&#39;.csv&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>),<span class="dt">row.names=</span>F)
}</code></pre></div>
<p>For each value of <span class="math inline">\(\gamma\)</span>, 20 data sets are simulated. The bigger <span class="math inline">\(\gamma\)</span> is, the larger the corresponding parameter. We provided the data sets with <span class="math inline">\(\gamma = 2\)</span>. Let’s check the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">disease_dat&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/happyrabbit/DataScientistR/master/Data/sim1_da1.csv&quot;</span>)
<span class="co"># only show the last 7 columns here</span>
<span class="kw">head</span>(<span class="kw">subset</span>(disease_dat,<span class="dt">select=</span><span class="kw">c</span>( <span class="st">&quot;Q118.A&quot;</span>,<span class="st">&quot;Q118.B&quot;</span>,<span class="st">&quot;Q119.A&quot;</span>,<span class="st">&quot;Q119.B&quot;</span>,<span class="st">&quot;Q120.A&quot;</span>,<span class="st">&quot;Q120.B&quot;</span>,<span class="st">&quot;y&quot;</span>))) </code></pre></div>
<pre><code>##   Q118.A Q118.B Q119.A Q119.B Q120.A Q120.B y
## 1      1      0      0      0      0      1 1
## 2      0      1      0      1      0      0 1
## 3      1      0      0      0      1      0 1
## 4      1      0      0      0      0      1 1
## 5      1      0      0      0      1      0 0
## 6      1      0      0      1      1      0 1</code></pre>
<p>Here <code>y</code> indicates the outbreak situation of the farms. <code>y=1</code> means there is an outbreak in 5 years after the survey. The rest columns indicate survey responses. For example <code>Q120.A = 1</code> means the respondent chose <code>A</code> in Q120. We consider <code>C</code> as the baseline.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="soft-skills-for-data-scientists.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="big-data-cloud-platform.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
