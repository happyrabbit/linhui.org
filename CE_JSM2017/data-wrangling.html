<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Science and Art of Data</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is the handouts for CE course at JSM 2017">
  <meta name="generator" content="bookdown 0.1 and GitBook 2.6.7">

  <meta property="og:title" content="The Science and Art of Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the handouts for CE course at JSM 2017" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Science and Art of Data" />
  
  <meta name="twitter:description" content="This is the handouts for CE course at JSM 2017" />
  

<meta name="author" content="Hui Lin and Ming Li">

<meta name="date" content="2017-04-26">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-the-data.html">
<link rel="next" href="data-pre-processing.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://scientistcafe.com">Homepage</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> </a></li>
<li class="chapter" data-level="2" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html"><i class="fa fa-check"></i><b>2</b> The art of data science</a><ul>
<li class="chapter" data-level="2.1" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-is-data-science"><i class="fa fa-check"></i><b>2.1</b> What is data science?</a></li>
<li class="chapter" data-level="2.2" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#is-it-science-totally"><i class="fa fa-check"></i><b>2.2</b> Is it science? Totally?</a></li>
<li class="chapter" data-level="2.3" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-kind-of-questions-can-data-science-solve"><i class="fa fa-check"></i><b>2.3</b> What kind of questions can data science solve?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-is-a-good-question"><i class="fa fa-check"></i><b>2.3.1</b> What is a good question?</a></li>
<li class="chapter" data-level="2.3.2" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#types-of-questions"><i class="fa fa-check"></i><b>2.3.2</b> Types of questions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#what-are-the-required-skills-for-data-scientist"><i class="fa fa-check"></i><b>2.4</b> What are the required skills for data scientist?</a><ul>
<li class="chapter" data-level="2.4.1" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#types-of-learning"><i class="fa fa-check"></i><b>2.4.1</b> Types of Learning</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#types-of-algorithm"><i class="fa fa-check"></i><b>2.4.2</b> Types of Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#general-process-of-data-science"><i class="fa fa-check"></i><b>2.5</b> General Process of Data Science</a></li>
<li class="chapter" data-level="2.6" data-path="the-art-of-data-science.html"><a href="the-art-of-data-science.html#cloud-based-computation-environment"><i class="fa fa-check"></i><b>2.6</b> Cloud-based computation environment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html"><i class="fa fa-check"></i><b>3</b> Big Data Cloud Platform</a><ul>
<li class="chapter" data-level="3.1" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#introduction-of-databricks-cloud-based-distributed-system"><i class="fa fa-check"></i><b>3.1</b> Introduction of Databricks cloud-based distributed system</a></li>
<li class="chapter" data-level="3.2" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#linux-system-and-hadoop-environment"><i class="fa fa-check"></i><b>3.2</b> Linux system and Hadoop environment</a></li>
<li class="chapter" data-level="3.3" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#database-basic-through-hive"><i class="fa fa-check"></i><b>3.3</b> Database basic through Hive</a></li>
<li class="chapter" data-level="3.4" data-path="big-data-cloud-platform.html"><a href="big-data-cloud-platform.html#spark-and-h2o"><i class="fa fa-check"></i><b>3.4</b> Spark and H2O</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html"><i class="fa fa-check"></i><b>4</b> Introduction to the data</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html#customer-data-for-clothing-company"><i class="fa fa-check"></i><b>4.1</b> Customer data for clothing company</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html#customer-satisfaction-survey-data-from-airline-company"><i class="fa fa-check"></i><b>4.2</b> Customer Satisfaction Survey Data from Airline Company</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-the-data.html"><a href="introduction-to-the-data.html#swine-disease-breakout-data"><i class="fa fa-check"></i><b>4.3</b> Swine Disease Breakout Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#read-and-write-data"><i class="fa fa-check"></i><b>5.1</b> Read and write data</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#summarize-data"><i class="fa fa-check"></i><b>5.2</b> Summarize data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#functions-in-base-r"><i class="fa fa-check"></i><b>5.2.1</b> Functions in base R</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>5.3</b> Tidy data</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#reshape-data"><i class="fa fa-check"></i><b>5.4</b> Reshape data</a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling.html"><a href="data-wrangling.html#subset-data"><i class="fa fa-check"></i><b>5.5</b> Subset data</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling.html"><a href="data-wrangling.html#combine-data"><i class="fa fa-check"></i><b>5.6</b> Combine data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-pre-processing.html"><a href="data-pre-processing.html"><i class="fa fa-check"></i><b>6</b> Data Pre-processing</a><ul>
<li class="chapter" data-level="6.1" data-path="data-pre-processing.html"><a href="data-pre-processing.html#start"><i class="fa fa-check"></i><b>6.1</b> Start</a></li>
<li class="chapter" data-level="6.2" data-path="data-pre-processing.html"><a href="data-pre-processing.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.2</b> <strong>Centering and Scaling</strong></a></li>
<li class="chapter" data-level="6.3" data-path="data-pre-processing.html"><a href="data-pre-processing.html#resolve-skewness"><i class="fa fa-check"></i><b>6.3</b> <strong>Resolve Skewness</strong></a></li>
<li class="chapter" data-level="6.4" data-path="data-pre-processing.html"><a href="data-pre-processing.html#resolve-outliers"><i class="fa fa-check"></i><b>6.4</b> <strong>Resolve Outliers</strong></a></li>
<li class="chapter" data-level="6.5" data-path="data-pre-processing.html"><a href="data-pre-processing.html#missing-values"><i class="fa fa-check"></i><b>6.5</b> <strong>Missing Values</strong></a><ul>
<li class="chapter" data-level="6.5.1" data-path="data-pre-processing.html"><a href="data-pre-processing.html#impute-missing-values-with-medianmode"><i class="fa fa-check"></i><b>6.5.1</b> Impute missing values with median/mode</a></li>
<li class="chapter" data-level="6.5.2" data-path="data-pre-processing.html"><a href="data-pre-processing.html#impute-missing-values-based-on-k-nearest-neighbors"><i class="fa fa-check"></i><b>6.5.2</b> Impute missing values based on K-nearest neighbors</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-pre-processing.html"><a href="data-pre-processing.html#collinearity"><i class="fa fa-check"></i><b>6.6</b> <strong>Collinearity</strong></a></li>
<li class="chapter" data-level="6.7" data-path="data-pre-processing.html"><a href="data-pre-processing.html#sparse-variables"><i class="fa fa-check"></i><b>6.7</b> <strong>Sparse Variables</strong></a></li>
<li class="chapter" data-level="6.8" data-path="data-pre-processing.html"><a href="data-pre-processing.html#re-encode-dummy-variables"><i class="fa fa-check"></i><b>6.8</b> <strong>Re-encode Dummy Variables</strong></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html"><i class="fa fa-check"></i><b>7</b> Basic Model Techniques</a><ul>
<li class="chapter" data-level="7.1" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#supervised-v.s.-unsupervised-model"><i class="fa fa-check"></i><b>7.1</b> Supervised v.s. unsupervised model</a></li>
<li class="chapter" data-level="7.2" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#model-error"><i class="fa fa-check"></i><b>7.2</b> Model Error</a><ul>
<li class="chapter" data-level="7.2.1" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#systematic-error-and-random-error"><i class="fa fa-check"></i><b>7.2.1</b> Systematic Error and Random Error</a></li>
<li class="chapter" data-level="7.2.2" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#error-in-response"><i class="fa fa-check"></i><b>7.2.2</b> Error in Response</a></li>
<li class="chapter" data-level="7.2.3" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#error-in-independent-variable"><i class="fa fa-check"></i><b>7.2.3</b> Error in Independent Variable</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#data-dividing-and-resampling"><i class="fa fa-check"></i><b>7.3</b> Data Dividing and Resampling</a><ul>
<li class="chapter" data-level="7.3.1" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#training-and-testing-set"><i class="fa fa-check"></i><b>7.3.1</b> Training and Testing Set</a></li>
<li class="chapter" data-level="7.3.2" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#resampling"><i class="fa fa-check"></i><b>7.3.2</b> Resampling</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="basic-model-techniques.html"><a href="basic-model-techniques.html#summary"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="shiny-intro.html"><a href="shiny-intro.html"><i class="fa fa-check"></i><b>8</b> R-Shiny Introduction</a><ul>
<li class="chapter" data-level="8.1" data-path="shiny-intro.html"><a href="shiny-intro.html#softwares"><i class="fa fa-check"></i><b>8.1</b> Softwares</a></li>
<li class="chapter" data-level="8.2" data-path="shiny-intro.html"><a href="shiny-intro.html#web-development"><i class="fa fa-check"></i><b>8.2</b> Web development</a></li>
<li class="chapter" data-level="8.3" data-path="shiny-intro.html"><a href="shiny-intro.html#shiny"><i class="fa fa-check"></i><b>8.3</b> Shiny</a></li>
<li class="chapter" data-level="8.4" data-path="shiny-intro.html"><a href="shiny-intro.html#resources"><i class="fa fa-check"></i><b>8.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dynamicreproducible-report.html"><a href="dynamicreproducible-report.html"><i class="fa fa-check"></i><b>9</b> Dynamic/Reproducible report</a></li>
<li class="chapter" data-level="10" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html"><i class="fa fa-check"></i><b>10</b> Soft Skills for Data Scientists</a><ul>
<li class="chapter" data-level="10.1" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#introduction-to-agile"><i class="fa fa-check"></i><b>10.1</b> Introduction to agile</a></li>
<li class="chapter" data-level="10.2" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#effective-communication-with-business-partners"><i class="fa fa-check"></i><b>10.2</b> Effective communication with business partners</a></li>
<li class="chapter" data-level="10.3" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#leadership-skills"><i class="fa fa-check"></i><b>10.3</b> Leadership skills</a></li>
<li class="chapter" data-level="10.4" data-path="soft-skills-for-data-scientists.html"><a href="soft-skills-for-data-scientists.html#decision-making-with-uncertainty"><i class="fa fa-check"></i><b>10.4</b> Decision making with uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Science and Art of Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Data Wrangling</h1>
<p>This chapter focuses on some of the most frequently used data manipulations and shows how to implement them in R. It is important to explore the data set with descriptive statistics (mean, standard deviation, etc.) and data visualization prior to analysis. Transform data so that the data structure is in line with the requirements of the model. You also need to summarize the results after analysis.</p>
<p>Here we assume the readers are already familiar with some of the traditional R data operations, such as subsetting data frame, deleting variables, read and write functions (<code>read.csv ()</code>, <code>write.csv ()</code>, etc.) in base R. We will also skip some basic descriptive functions in R. For example, for discrete variables, we often use the frequency table to look at the frequency (<code>table ()</code>) of the variable at various levels as needed, or a crosstab of two variables. You can also draw a bar chart for discrete variables (<code>bar()</code>). For continuous variables, we need to look at the mean (<code>mean ()</code>), standard deviation (<code>sd()</code>), quantile (<code>quantile()</code>) of a variable from time to time. There are also functions like <code>summary()</code>, <code>str()</code> and <code>describe()</code> (a functions in the ‘psych’ package) that give a summary of a data frame.</p>
<!--
These are some of the most basic methods of exploring data at all stages (including model results). But only these are not enough, the flexibility of these methods is not high, the output of the information is fixed. We may not want the `summary ()` function to output all of the information, and some of the information we want is not. For example, if we want to know the mean of customer revenue, online spend, and so on for each category, or if we want to find the highest-earning people in each category, then extract them together, or we want a The new variable indicates whether the channel was purchased (online or in-store) and used this for modeling, where the data needs to be reshaped, the records for online purchases and the records for physical store purchases are row by row rather than now Of the column. These operations can be cumbersome and inefficient when used only with primitive functions. There are some other packages in R that can be very efficient and succinct to accomplish these seemingly complex tasks. The first contact with these functions of the small partners will feel that they are not very studious, it is natural, more flexible tools need to learn to master the natural longer, but this is a ** practice makes perfect process.
-->
<p>The focus here is to introduce some of the more efficient data wrangling methods in R.</p>
<div id="read-and-write-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Read and write data</h2>
<p>You must be familar with <code>read.csv()</code>, <code>read.table()</code> and <code>write.csv()</code> in base R. Here we will introduce a more efficient package from RStudio in 2015 for reading and writing data: <code>readr</code> package. The corresponding functions are <code>read_csv()</code>, <code>read_table()</code> and <code>write_csv()</code>. The commands look quite similar, but <code>readr</code> is different in the following respects:</p>
<ol style="list-style-type: decimal">
<li><p>It is 10x faster. The trick is that <code>readr</code> uses C++ to process the data quickly.</p></li>
<li><p>It doesn’t change the column names. The names can start with number and “<code>.</code>” will not be substitued to “<code>_</code>”. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">read_csv</span>(<span class="st">&quot;2015,2016,2017</span>
<span class="st">1,2,3</span>
<span class="st">4,5,6&quot;</span>)</code></pre></div></li>
<li><p><code>readr</code> functions do not convert strings to factors by default, are able to parse dates and times and can automatically determine the data types in each column.</p></li>
<li><p>The killing character in my opinion is that <code>readr</code> provides <strong>progress bar</strong>. What makes you feel worse than waiting is not knowing how long you have to wait. Without “progress bar” might be the No.1 reason that people break up with the one they have been dating.</p></li>
</ol>
<p>(add progress bar)</p>
<p>The major functions of readr is to turn flat files into data frames:</p>
<ul>
<li><code>read_csv()</code>: reads comma delimited files</li>
<li><code>read_csv2()</code>: reads semicolon separated files (common in countries where <code>,</code> is used as the decimal place)</li>
<li><code>read_tsv()</code>: reads tab delimited files</li>
<li><code>read_delim()</code>: reads in files with any delimiter</li>
<li><code>read_fwf()</code>: reads fixed width files. You can specify fields either by their widths with <code>fwf_widths()</code> or their position with <code>fwf_positions()</code><br />
</li>
<li><code>read_table()</code>: reads a common variation of fixed width files where columns are separated by white space</li>
<li><code>read_log()</code>: reads Apache style log files</li>
</ul>
<p>The good thing is that those functions have similar syntax. Once you learn one, the others become easy. Here we will focus on <code>read_csv()</code>.</p>
<p>The most important information for <code>read_csv()</code> is the path to your data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
sim.dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/happyrabbit/DataScientistR/master/Data/SegData.csv &quot;</span>)
<span class="kw">head</span>(sim.dat)</code></pre></div>
<p>The function reads the file to R as a <code>tibble</code>. When you run <code>read_csv()</code> it prints out a column specification that gives the name and type of each column. In order to better understanding how <code>readr</code> works, it is helpful to type in some baby data set and check the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_csv</span>(<span class="st">&quot;2015,2016,2017</span>
<span class="st">100,200,300</span>
<span class="st">canola,soybean,corn&quot;</span>)
<span class="kw">print</span>(dat)</code></pre></div>
<p>You can also add comments on the top and tell R to skip those lines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_csv</span>(<span class="st">&quot;# I will never let you know that</span>
<span class="st">          # my favorite food is carrot</span>
<span class="st">          Date,Food,Mood</span>
<span class="st">          Monday,carrot,happy</span>
<span class="st">          Tuesday,carrot,happy</span>
<span class="st">          Wednesday,carrot,happy</span>
<span class="st">          Thursday,carrot,happy</span>
<span class="st">          Friday,carrot,happy</span>
<span class="st">          Saturday,carrot,extremely happy</span>
<span class="st">          Sunday,carrot,extremely happy&quot;</span>, <span class="dt">skip =</span> <span class="dv">2</span>)
<span class="kw">print</span>(dat)</code></pre></div>
<p>If you don’t have column names, set <code>col_names = FALSE</code> then R will assign names “<code>X1</code>”,“<code>X2</code>”… to the columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_csv</span>(<span class="st">&quot;</span>
<span class="st">          Saturday,carrot,extremely happy</span>
<span class="st">          Sunday,carrot,extremely happy&quot;</span>, <span class="dt">col_names=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Warning: 2 parsing failures.
## row col  expected    actual
##   2  -- 1 columns 3 columns
##   3  -- 1 columns 3 columns</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(dat)</code></pre></div>
<p>You can also pass <code>col_names</code> a character vector which will be used as the column names. Try to replace <code>col_names=FALSE</code> with <code>col_names=c(&quot;Date&quot;,&quot;Food&quot;,&quot;Mood&quot;)</code> and see what happen.</p>
<p>As mentioned before, you can use <code>read_csv2()</code> to read semicolon separated files:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_csv2</span>(<span class="st">&quot;</span>
<span class="st">          Saturday; carrot; extremely happy </span><span class="ch">\n</span>
<span class="st">          Sunday; carrot; extremely happy&quot;</span>, <span class="dt">col_names=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Warning: 2 parsing failures.
## row col  expected    actual
##   2  -- 1 columns 3 columns
##   4  -- 1 columns 3 columns</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(dat)</code></pre></div>
<p>Here “<code>\n</code>” is a convenient shortcut for adding a new line.</p>
<p>You can use <code>read_tsv()</code> to read tab delimited files：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_tsv</span>(<span class="st">&quot;every</span><span class="ch">\t</span><span class="st">man</span><span class="ch">\t</span><span class="st">is</span><span class="ch">\t</span><span class="st">a</span><span class="ch">\t</span><span class="st">poet</span><span class="ch">\t</span><span class="st">when</span><span class="ch">\t</span><span class="st">he</span><span class="ch">\t</span><span class="st">is</span><span class="ch">\t</span><span class="st">in</span><span class="ch">\t</span><span class="st">love</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>)
<span class="kw">print</span>(dat)</code></pre></div>
<p>Or more generally, you can use <code>read_delim()</code> and assign separating character：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_delim</span>(<span class="st">&quot;THE|UNBEARABLE|RANDOMNESS|OF|LIFE</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot;|&quot;</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>)
<span class="kw">print</span>(dat)</code></pre></div>
<p>Another situation you will often run into is missing value. In marketing survey, people like to use “99” to represent missing. You can tell R to set all observation with value “99” as missing when you read the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat=<span class="kw">read_csv</span>(<span class="st">&quot;Q1,Q2,Q3</span>
<span class="st">               5, 4,99&quot;</span>,<span class="dt">na=</span><span class="st">&quot;99&quot;</span>)
<span class="kw">print</span>(dat)</code></pre></div>
<p>For writing data back to disk, you can use <code>write_csv()</code> and <code>write_tsv()</code>. The following two characters of the two functions increase the chances of the output file being read back in correctly:</p>
<ul>
<li>Encode strings in UTF-8</li>
<li>Save dates and date-times in ISO8601 format so they are easily parsed elsewhere</li>
</ul>
<p>For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(sim.dat, <span class="st">&quot;sim_dat.csv&quot;</span>)</code></pre></div>
<p>For other data types, you can use the following packages:</p>
<ul>
<li><code>Haven</code>: SPSS, Stata and SAS data</li>
<li><code>Readxl</code> and <code>xlsx</code>: excel data(.xls and .xlsx)</li>
<li><code>DBI</code>: given data base, such as RMySQL, RSQLite and RPostgreSQL, read data directly from the database using SQL</li>
</ul>
<p>Some other useful materials:</p>
<ul>
<li>For getting data from internet, you can refere to the book “XML and Web Technologies for Data Sciences with R”.</li>
<li><a href="https://cran.r-project.org/doc/manuals/r-release/R-data.html#Acknowledgements">R data import/export manual</a></li>
<li><code>rio</code> package：<a href="https://github.com/leeper/rio" class="uri">https://github.com/leeper/rio</a></li>
</ul>
</div>
<div id="summarize-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Summarize data</h2>
<div id="functions-in-base-r" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Functions in base R</h3>
<p>There are some powerful functions to summarize data in base R, such as <code>apply()</code>, <code>lapply()</code> and <code>sapply()</code>. They do the same basic things and are all from “apply” family: apply functions over parts of data. They differ in two important respects:</p>
<ol style="list-style-type: decimal">
<li>the type of object they apply to</li>
<li>the type of result they will return</li>
</ol>
<p>When do we use <code>apply()</code>? When we want to apply a function to margins of an array or matrix. That means our data need to be structured. The operations can be very flexible. It returns a vector or array or list of values obtained by applying a function to margins of an array or matrix.</p>
<p>For example you can compute row and column sums for a matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## simulate a matrix
x &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">x1 =</span><span class="dv">1</span>:<span class="dv">8</span>, <span class="dt">x2 =</span> <span class="kw">c</span>(<span class="dv">4</span>:<span class="dv">1</span>, <span class="dv">2</span>:<span class="dv">5</span>))
<span class="kw">dimnames</span>(x)[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>letters[<span class="dv">1</span>:<span class="dv">8</span>]
<span class="kw">apply</span>(x, <span class="dv">2</span>, mean)</code></pre></div>
<pre><code>##  x1  x2 
## 4.5 3.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col.sums &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">2</span>, sum)
row.sums &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">1</span>, sum)

## Apply to matrix
ma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">6</span>:<span class="dv">8</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)
ma</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    3    1    7
## [2,]    2    4    6    8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(ma, <span class="dv">1</span>, table)  <span class="co">#--&gt; a list of length 2</span></code></pre></div>
<pre><code>## [[1]]
## 
## 1 3 7 
## 2 1 1 
## 
## [[2]]
## 
## 2 4 6 8 
## 1 1 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(ma, <span class="dv">1</span>, stats::quantile) <span class="co"># 5 x n matrix with rownames</span></code></pre></div>
<pre><code>##      [,1] [,2]
## 0%      1  2.0
## 25%     1  3.5
## 50%     2  5.0
## 75%     4  6.5
## 100%    7  8.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Example with different lengths for each call
z &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>:<span class="dv">24</span>, <span class="dt">dim =</span> <span class="dv">2</span>:<span class="dv">4</span>)
zseq &lt;-<span class="st"> </span><span class="kw">apply</span>(z, <span class="dv">1</span>:<span class="dv">2</span>, function(x) <span class="kw">seq_len</span>(<span class="kw">max</span>(x)))
zseq         ## a 2 x 3 matrix</code></pre></div>
<pre><code>##      [,1]       [,2]       [,3]      
## [1,] Integer,19 Integer,21 Integer,23
## [2,] Integer,20 Integer,22 Integer,24</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(zseq) ## list</code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(zseq) ## 2 3</code></pre></div>
<pre><code>## [1] 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zseq[<span class="dv">1</span>,]</code></pre></div>
<pre><code>## [[1]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19
## 
## [[2]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21
## 
## [[3]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(z, <span class="dv">3</span>, function(x) <span class="kw">seq_len</span>(<span class="kw">max</span>(x)))</code></pre></div>
<pre><code>## [[1]]
## [1] 1 2 3 4 5 6
## 
## [[2]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12
## 
## [[3]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
## 
## [[4]]
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24</code></pre>
</div>
</div>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">5.3</span> Tidy data</h2>
</div>
<div id="reshape-data" class="section level2">
<h2><span class="header-section-number">5.4</span> Reshape data</h2>
</div>
<div id="subset-data" class="section level2">
<h2><span class="header-section-number">5.5</span> Subset data</h2>
</div>
<div id="combine-data" class="section level2">
<h2><span class="header-section-number">5.6</span> Combine data</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-the-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-pre-processing.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-DataWrangling.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
